<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tgstation-server: Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tgstation-server<span id="projectnumber">&#160;6.19.1</span>
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_tgstation.html">Tgstation</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server.html">Server</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host.html">Host</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_components.html">Components</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat.html">Chat</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers.html">Providers</a></li><li class="navelem"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html">DiscordProvider</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider Class Reference<span class="mlabels"><span class="mlabel">sealed</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>IProvider for the Discord app.  
 <a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider__inherit__graph.png" border="0" usemap="#a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_inherit__map" alt="Inheritance graph"/></div>
<map name="a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_inherit__map" id="a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_inherit__map">
<area shape="rect" title="IProvider for the Discord app." alt="" coords="36,226,263,267"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html" title=" " alt="" coords="51,153,120,178"/>
<area shape="poly" title=" " alt="" coords="107,189,136,224,131,228,103,192"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service." alt="" coords="31,79,105,105"/>
<area shape="poly" title=" " alt="" coords="77,119,85,152,80,153,72,120"/>
<area shape="rect" href="class_i_async_disposable.html" title=" " alt="" coords="5,5,131,31"/>
<area shape="poly" title=" " alt="" coords="71,46,71,79,65,79,65,46"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_discord_responders.html" title="Combined interface for the IResponder types used by TGS." alt="" coords="162,153,300,178"/>
<area shape="poly" title=" " alt="" coords="209,191,171,228,168,224,206,187"/>
<area shape="rect" href="class_i_responder.html" title=" " alt="" coords="129,79,333,105"/>
<area shape="poly" title=" " alt="" coords="233,120,233,152,228,152,228,120"/>
<area shape="rect" href="class_i_responder.html" title=" " alt="" coords="357,79,507,105"/>
<area shape="poly" title=" " alt="" coords="384,113,266,155,264,150,383,108"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider__coll__graph.png" border="0" usemap="#a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_coll__map" alt="Collaboration graph"/></div>
<map name="a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_coll__map" id="a_tgstation_8_server_8_host_8_components_8_chat_8_providers_8_discord_provider_coll__map">
<area shape="rect" title="IProvider for the Discord app." alt="" coords="1025,582,1251,623"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html" title=" " alt="" coords="669,203,739,228"/>
<area shape="poly" title=" " alt="" coords="755,215,810,222,876,237,943,263,974,280,1002,302,1033,334,1060,370,1081,410,1099,450,1123,525,1136,581,1131,582,1118,527,1094,452,1076,412,1055,373,1029,337,999,305,971,285,940,267,874,242,810,228,754,221"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service." alt="" coords="272,191,345,216"/>
<area shape="poly" title=" " alt="" coords="361,202,669,212,669,217,361,208"/>
<area shape="rect" href="class_i_async_disposable.html" title=" " alt="" coords="5,191,131,216"/>
<area shape="poly" title=" " alt="" coords="146,201,272,201,272,206,146,206"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_i_job_manager.html" title="Manages the runtime of Jobs." alt="" coords="218,241,399,281"/>
<area shape="poly" title=" " alt="" coords="415,249,581,231,668,218,669,223,582,236,415,254"/>
<area shape="rect" title=" " alt="" coords="180,61,437,117"/>
<area shape="poly" title=" " alt="" coords="453,114,518,131,582,152,636,176,681,200,679,204,634,180,580,157,517,136,452,119"/>
<area shape="rect" title=" " alt="" coords="231,5,387,31"/>
<area shape="poly" title=" " alt="" coords="403,10,490,14,537,19,582,29,713,64,767,80,816,99,861,123,906,153,953,194,1003,246,1035,287,1061,334,1083,382,1101,430,1125,518,1136,581,1131,582,1120,519,1096,432,1079,384,1057,336,1030,290,999,249,949,198,903,158,859,127,813,104,765,85,712,69,581,34,536,25,490,19,403,16"/>
<area shape="poly" title=" " alt="" coords="395,33,438,46,462,59,496,70,523,75,550,82,583,97,618,122,650,151,694,201,690,204,646,154,615,126,580,102,549,87,522,81,494,75,460,64,436,51,393,38"/>
<area shape="rect" title=" " alt="" coords="255,307,362,332"/>
<area shape="poly" title=" " alt="" coords="378,308,504,300,583,301,668,308,755,321,842,343,926,376,965,397,1002,421,1045,459,1081,503,1128,580,1124,583,1076,506,1041,463,999,426,962,402,923,381,841,348,754,326,667,313,583,307,504,306,378,313"/>
<area shape="poly" title=" " alt="" coords="377,308,474,291,581,265,631,246,675,226,677,231,633,251,582,270,475,297,378,313"/>
<area shape="rect" title=" " alt="" coords="284,141,334,167"/>
<area shape="poly" title=" " alt="" coords="350,156,582,189,669,206,668,211,581,194,349,161"/>
<area shape="rect" title=" " alt="" coords="221,364,397,390"/>
<area shape="poly" title=" " alt="" coords="412,368,537,368,688,381,768,393,849,412,927,437,1002,469,1040,494,1074,524,1124,580,1120,583,1070,527,1037,498,999,474,925,442,847,417,767,399,687,386,537,374,412,373"/>
<area shape="poly" title=" " alt="" coords="412,364,496,346,539,332,580,315,632,276,687,227,690,231,636,280,583,319,541,337,497,351,413,369"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_discord_responders.html" title="Combined interface for the IResponder types used by TGS." alt="" coords="635,449,773,475"/>
<area shape="poly" title=" " alt="" coords="789,463,892,476,948,489,1002,506,1034,522,1065,541,1115,579,1112,584,1062,546,1032,527,1000,511,947,494,891,481,788,468"/>
<area shape="rect" href="class_i_responder.html" title=" " alt="" coords="207,435,411,460"/>
<area shape="poly" title=" " alt="" coords="426,449,635,457,635,462,426,455"/>
<area shape="rect" href="class_i_responder.html" title=" " alt="" coords="234,484,383,510"/>
<area shape="poly" title=" " alt="" coords="399,486,634,466,635,471,399,492"/>
<area shape="rect" title=" " alt="" coords="609,499,799,524"/>
<area shape="poly" title=" " alt="" coords="815,523,906,537,1001,557,1077,579,1075,584,1000,562,905,543,814,528"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html" title="For retrieving the Assembly&#39;s location." alt="" coords="605,549,803,589"/>
<area shape="poly" title=" " alt="" coords="818,575,1024,591,1024,596,818,580"/>
<area shape="rect" title=" " alt="" coords="622,614,786,655"/>
<area shape="poly" title=" " alt="" coords="802,625,1000,611,1024,609,1024,614,1001,616,802,630"/>
<area shape="rect" title=" " alt="" coords="622,679,786,704"/>
<area shape="poly" title=" " alt="" coords="801,678,898,664,1000,644,1079,620,1080,626,1001,649,899,669,802,684"/>
<area shape="rect" title=" " alt="" coords="630,728,778,754"/>
<area shape="poly" title=" " alt="" coords="793,736,894,724,948,712,1000,695,1032,679,1063,660,1112,621,1116,625,1066,664,1035,684,1002,700,949,717,895,729,794,741"/>
<area shape="rect" title=" " alt="" coords="681,777,727,803"/>
<area shape="poly" title=" " alt="" coords="742,794,796,800,862,801,933,792,967,782,999,769,1043,737,1079,697,1106,656,1125,622,1129,624,1111,658,1083,700,1046,741,1002,773,969,787,934,797,862,806,795,805,742,799"/>
<area shape="rect" title=" " alt="" coords="616,827,792,868"/>
<area shape="poly" title=" " alt="" coords="807,859,854,860,904,855,954,844,999,823,1026,803,1050,778,1087,722,1113,666,1128,622,1133,624,1118,668,1092,725,1054,782,1030,807,1002,827,956,849,905,861,855,865,807,865"/>
<area shape="rect" title=" " alt="" coords="649,892,759,918"/>
<area shape="poly" title=" " alt="" coords="774,916,827,920,886,919,945,907,973,896,999,882,1031,855,1057,823,1079,787,1096,749,1120,677,1131,622,1136,624,1125,678,1101,751,1083,789,1061,826,1034,859,1002,886,976,901,947,912,887,924,827,925,774,921"/>
<area shape="rect" title=" " alt="" coords="663,941,745,967"/>
<area shape="poly" title=" " alt="" coords="760,966,815,974,878,977,941,967,971,956,999,940,1036,907,1065,867,1088,822,1105,776,1126,687,1133,623,1138,623,1131,688,1110,777,1093,825,1070,870,1040,911,1002,945,974,961,943,972,878,982,814,980,759,971"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4076d0667f118cef056a4d3d5ab6b4a" id="r_ab4076d0667f118cef056a4d3d5ab6b4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab4076d0667f118cef056a4d3d5ab6b4a">DiscordProvider</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_i_job_manager.html">IJobManager</a> <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#aa36ffb34c69e4a990830e49f97b7c142">jobManager</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_utils_1_1_i_async_delayer.html">IAsyncDelayer</a> asyncDelayer, ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html">DiscordProvider</a> &gt; logger, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html">IAssemblyInformationProvider</a> <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">assemblyInformationProvider</a>, IOptionsMonitor&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac93400b45eefb577306a70a7a530147f">generalConfigurationOptions</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_bot.html">ChatBot</a> chatBot)</td></tr>
<tr class="memdesc:ab4076d0667f118cef056a4d3d5ab6b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a new instance of the DiscordProvider class.  <br /></td></tr>
<tr class="separator:ab4076d0667f118cef056a4d3d5ab6b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab650903107863653f1b637562f4813b4" id="r_ab650903107863653f1b637562f4813b4"><td class="memItemLeft" align="right" valign="top">override async ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab650903107863653f1b637562f4813b4">DisposeAsync</a> ()</td></tr>
<tr class="separator:ab650903107863653f1b637562f4813b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1494b2b91cc869199100c9338f91d864" id="r_a1494b2b91cc869199100c9338f91d864"><td class="memItemLeft" align="right" valign="top">override async ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1494b2b91cc869199100c9338f91d864">SendMessage</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html">Message</a>? replyTo, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html">MessageContent</a> message, ulong channelId, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a1494b2b91cc869199100c9338f91d864"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a message to the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a>.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">replyTo</td><td>The optional <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html" title="Represents a message received by a IProvider.">Message</a> to reply to.</td></tr>
    <tr><td class="paramname">message</td><td>The MessageContent.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ValueTask representing the running operation.</dd></dl>
  <br /></td></tr>
<tr class="separator:a1494b2b91cc869199100c9338f91d864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b14b94a01f2a1478f1ade14ef9a7471" id="r_a6b14b94a01f2a1478f1ade14ef9a7471"><td class="memItemLeft" align="right" valign="top">override async ValueTask&lt; Func&lt; string?, string, ValueTask&lt; Func&lt; bool, ValueTask &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a6b14b94a01f2a1478f1ade14ef9a7471">SendUpdateMessage</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models.RevisionInformation</a> revisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models.RevisionInformation</a>? previousRevisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html">EngineVersion</a> engineVersion, DateTimeOffset? estimatedCompletionTime, string? gitHubOwner, string? gitHubRepo, ulong channelId, bool localCommitPushed, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a6b14b94a01f2a1478f1ade14ef9a7471"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the message for a deployment.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">revisionInformation</td><td>The RevisionInformation of the deployment.</td></tr>
    <tr><td class="paramname">previousRevisionInformation</td><td>The RevisionInformation of the previous deployment if any.</td></tr>
    <tr><td class="paramname">engineVersion</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html" title="Information about an engine installation.">Api.Models.EngineVersion</a> of the deployment.</td></tr>
    <tr><td class="paramname">estimatedCompletionTime</td><td>The optional DateTimeOffset the deployment is expected to be completed at.</td></tr>
    <tr><td class="paramname">gitHubOwner</td><td>The repository GitHub owner, if any.</td></tr>
    <tr><td class="paramname">gitHubRepo</td><td>The repository GitHub name, if any.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">localCommitPushed</td><td><code>true</code> if the local deployment commit was pushed to the remote repository.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ValueTask&lt;TResult&gt; resulting in a Func&lt;T1, T2, TResult&gt; to call to update the message at the deployment's conclusion. Parameters: Error message if any, DreamMaker output if any. Returns another callback which should be called to mark the deployment as active.</dd></dl>
  <br /></td></tr>
<tr class="separator:a6b14b94a01f2a1478f1ade14ef9a7471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7bbc5ddb64df2800554c354ff1974a" id="r_a8d7bbc5ddb64df2800554c354ff1974a"><td class="memItemLeft" align="right" valign="top">async Task&lt; Result &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a8d7bbc5ddb64df2800554c354ff1974a">RespondAsync</a> (IMessageCreate messageCreateEvent, CancellationToken cancellationToken)</td></tr>
<tr class="separator:a8d7bbc5ddb64df2800554c354ff1974a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addfb0baffffb90712e76e9bfc1800a15" id="r_addfb0baffffb90712e76e9bfc1800a15"><td class="memItemLeft" align="right" valign="top">Task&lt; Result &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#addfb0baffffb90712e76e9bfc1800a15">RespondAsync</a> (IReady readyEvent, CancellationToken cancellationToken)</td></tr>
<tr class="separator:addfb0baffffb90712e76e9bfc1800a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Tgstation.Server.Host.Components.Chat.Providers.Provider</a></td></tr>
<tr class="memitem:a33fc70620fa04585ab037bf6a9c1f9ab inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a33fc70620fa04585ab037bf6a9c1f9ab"><td class="memItemLeft" align="right" valign="top">async ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a33fc70620fa04585ab037bf6a9c1f9ab">Disconnect</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a33fc70620fa04585ab037bf6a9c1f9ab inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gracefully disconnects the provider. Permanently stops the reconnection timer.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">CancellationToken</a> for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">ValueTask</a> representing the running operation.</dd></dl>
  <br /></td></tr>
<tr class="separator:a33fc70620fa04585ab037bf6a9c1f9ab inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7083d8a83ac2d1718385e1df65dc450 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_af7083d8a83ac2d1718385e1df65dc450"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#af7083d8a83ac2d1718385e1df65dc450">InitialMappingComplete</a> ()</td></tr>
<tr class="memdesc:af7083d8a83ac2d1718385e1df65dc450 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to the provider that at least one <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#ad0f931684185665abfafc06e4792729f" title="Get the ChannelRepresentations for given channels .">MapChannels(IEnumerable&lt;ChatChannel&gt;, CancellationToken)</a> call has successfully completed.  <br /></td></tr>
<tr class="separator:af7083d8a83ac2d1718385e1df65dc450 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1585a0ea055e91cbd8704930cef464e inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_ab1585a0ea055e91cbd8704930cef464e"><td class="memItemLeft" align="right" valign="top">async ValueTask&lt; Dictionary&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">ChatChannel</a>, IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html">ChannelRepresentation</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab1585a0ea055e91cbd8704930cef464e">MapChannels</a> (IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">ChatChannel</a> &gt; channels, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:ab1585a0ea055e91cbd8704930cef464e inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html" title="Represents a Providers.IProvider channel.">ChannelRepresentation</a>s for given <em>channels</em> .<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channels</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_chat_channel.html" title="Indicates a chat channel.">Api.Models.ChatChannel</a>s to map.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">CancellationToken</a> for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">ValueTask&lt;TResult&gt;</a> resulting in a <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">Dictionary&lt;TKey, TValue&gt;</a> of the ChatChannel's <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html" title="Represents a Providers.IProvider channel.">ChannelRepresentation</a>s representing <em>channels</em> .</dd></dl>
  <br /></td></tr>
<tr class="separator:ab1585a0ea055e91cbd8704930cef464e inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59858b87fe92f6d07b77a1d94c7f613a inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a59858b87fe92f6d07b77a1d94c7f613a"><td class="memItemLeft" align="right" valign="top">async Task&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html">Message</a>?&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a59858b87fe92f6d07b77a1d94c7f613a">NextMessage</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a59858b87fe92f6d07b77a1d94c7f613a inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">Task&lt;TResult&gt;</a> resulting in the next <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html" title="Represents a message received by a IProvider.">Message</a> the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> receives or <code><a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">null</a></code> on a disconnect.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">CancellationToken</a> for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">Task&lt;TResult&gt;</a> resulting in the next available <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html" title="Represents a message received by a IProvider.">Message</a> or <code><a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">null</a></code> if the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> needed to reconnect.</dd></dl>
Note that private messages will come in the form of <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html" title="Represents a Providers.IProvider channel.">ChannelRepresentation</a>s not returned in <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#ad0f931684185665abfafc06e4792729f" title="Get the ChannelRepresentations for given channels .">MapChannels(IEnumerable&lt;ChatChannel&gt;, CancellationToken)</a>.  <br /></td></tr>
<tr class="separator:a59858b87fe92f6d07b77a1d94c7f613a inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4642b423570a979ed7d0ae2b3b73ea3 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_ac4642b423570a979ed7d0ae2b3b73ea3"><td class="memItemLeft" align="right" valign="top">Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ac4642b423570a979ed7d0ae2b3b73ea3">SetReconnectInterval</a> (uint reconnectInterval, bool connectNow)</td></tr>
<tr class="memdesc:ac4642b423570a979ed7d0ae2b3b73ea3 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the interval at which the provider starts jobs to try to reconnect.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reconnectInterval</td><td>The reconnection interval in minutes.</td></tr>
    <tr><td class="paramname">connectNow</td><td>If a connection attempt should be made now.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>
  <br /></td></tr>
<tr class="separator:ac4642b423570a979ed7d0ae2b3b73ea3 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4587386a66e83ac397b0f847204300 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_afa4587386a66e83ac397b0f847204300"><td class="memItemLeft" align="right" valign="top">ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#afa4587386a66e83ac397b0f847204300">SendMessage</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html">Message</a>? replyTo, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html">MessageContent</a> message, ulong channelId, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:afa4587386a66e83ac397b0f847204300 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a message to the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a>.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">replyTo</td><td>The optional <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html" title="Represents a message received by a IProvider.">Message</a> to reply to.</td></tr>
    <tr><td class="paramname">message</td><td>The MessageContent.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">CancellationToken</a> for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">ValueTask</a> representing the running operation.</dd></dl>
  <br /></td></tr>
<tr class="separator:afa4587386a66e83ac397b0f847204300 inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae237c1790c63a95df1e2660912afcefe inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_ae237c1790c63a95df1e2660912afcefe"><td class="memItemLeft" align="right" valign="top">ValueTask&lt; Func&lt; string?, string, ValueTask&lt; Func&lt; bool, ValueTask &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ae237c1790c63a95df1e2660912afcefe">SendUpdateMessage</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">RevisionInformation</a> revisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">RevisionInformation</a>? previousRevisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html">Api.Models.EngineVersion</a> engineVersion, DateTimeOffset? estimatedCompletionTime, string? gitHubOwner, string? gitHubRepo, ulong channelId, bool localCommitPushed, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:ae237c1790c63a95df1e2660912afcefe inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the message for a deployment.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">revisionInformation</td><td>The RevisionInformation of the deployment.</td></tr>
    <tr><td class="paramname">previousRevisionInformation</td><td>The RevisionInformation of the previous deployment if any.</td></tr>
    <tr><td class="paramname">engineVersion</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html" title="Information about an engine installation.">Api.Models.EngineVersion</a> of the deployment.</td></tr>
    <tr><td class="paramname">estimatedCompletionTime</td><td>The optional DateTimeOffset the deployment is expected to be completed at.</td></tr>
    <tr><td class="paramname">gitHubOwner</td><td>The repository GitHub owner, if any.</td></tr>
    <tr><td class="paramname">gitHubRepo</td><td>The repository GitHub name, if any.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">localCommitPushed</td><td><code><a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">true</a></code> if the local deployment commit was pushed to the remote repository.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">CancellationToken</a> for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">ValueTask&lt;TResult&gt;</a> resulting in a <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">Func&lt;T1, T2, TResult&gt;</a> to call to update the message at the deployment's conclusion. Parameters: Error message if any, DreamMaker output if any. Returns another callback which should be called to mark the deployment as active.</dd></dl>
  <br /></td></tr>
<tr class="separator:ae237c1790c63a95df1e2660912afcefe inherit pub_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3fd130f635e4577bedefa9926a4e2c73" id="r_a3fd130f635e4577bedefa9926a4e2c73"><td class="memItemLeft" align="right" valign="top">override async ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3fd130f635e4577bedefa9926a4e2c73">Connect</a> (CancellationToken cancellationToken)</td></tr>
<tr class="separator:a3fd130f635e4577bedefa9926a4e2c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9998d613750e44e779ae89931f7cfd98" id="r_a9998d613750e44e779ae89931f7cfd98"><td class="memItemLeft" align="right" valign="top">override async ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a9998d613750e44e779ae89931f7cfd98">DisconnectImpl</a> (CancellationToken cancellationToken)</td></tr>
<tr class="separator:a9998d613750e44e779ae89931f7cfd98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48adcd32348dbab4150bd2c8087623e0" id="r_a48adcd32348dbab4150bd2c8087623e0"><td class="memItemLeft" align="right" valign="top">override async ValueTask&lt; Dictionary&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">Models.ChatChannel</a>, IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html">ChannelRepresentation</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a48adcd32348dbab4150bd2c8087623e0">MapChannelsImpl</a> (IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">Models.ChatChannel</a> &gt; channels, CancellationToken cancellationToken)</td></tr>
<tr class="separator:a48adcd32348dbab4150bd2c8087623e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Tgstation.Server.Host.Components.Chat.Providers.Provider</a></td></tr>
<tr class="memitem:a3f00cc28b7cb048a224aa76a126befae inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a3f00cc28b7cb048a224aa76a126befae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a3f00cc28b7cb048a224aa76a126befae">Provider</a> (<a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_i_job_manager.html">IJobManager</a> <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#aa36ffb34c69e4a990830e49f97b7c142">jobManager</a>, <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_utils_1_1_i_async_delayer.html">IAsyncDelayer</a> asyncDelayer, ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Provider</a> &gt; logger, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_bot.html">ChatBot</a> chatBot)</td></tr>
<tr class="memdesc:a3f00cc28b7cb048a224aa76a126befae inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a new instance of the Provider class.  <br /></td></tr>
<tr class="separator:a3f00cc28b7cb048a224aa76a126befae inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05bb704d8700546c8a4d48b3fddd8474 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a05bb704d8700546c8a4d48b3fddd8474"><td class="memItemLeft" align="right" valign="top">ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a05bb704d8700546c8a4d48b3fddd8474">Connect</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a05bb704d8700546c8a4d48b3fddd8474 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to connect the Provider.  <br /></td></tr>
<tr class="separator:a05bb704d8700546c8a4d48b3fddd8474 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b359aa78d4328a994a8cb351dff7725 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a3b359aa78d4328a994a8cb351dff7725"><td class="memItemLeft" align="right" valign="top">ValueTask&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a3b359aa78d4328a994a8cb351dff7725">DisconnectImpl</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a3b359aa78d4328a994a8cb351dff7725 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gracefully disconnects the provider.  <br /></td></tr>
<tr class="separator:a3b359aa78d4328a994a8cb351dff7725 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5118efdb00738d3727d6209a88ae89b2 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a5118efdb00738d3727d6209a88ae89b2"><td class="memItemLeft" align="right" valign="top">ValueTask&lt; Dictionary&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">ChatChannel</a>, IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html">ChannelRepresentation</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a5118efdb00738d3727d6209a88ae89b2">MapChannelsImpl</a> (IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">ChatChannel</a> &gt; channels, CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:a5118efdb00738d3727d6209a88ae89b2 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of MapChannels(IEnumerable&lt;ChatChannel&gt;, CancellationToken).  <br /></td></tr>
<tr class="separator:a5118efdb00738d3727d6209a88ae89b2 inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6dd225ccb27e30c2cc06562b035ebe inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a6a6dd225ccb27e30c2cc06562b035ebe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe">EnqueueMessage</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html">Message</a>? message)</td></tr>
<tr class="memdesc:a6a6dd225ccb27e30c2cc06562b035ebe inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queues a <em>message</em>  for NextMessage(CancellationToken).  <br /></td></tr>
<tr class="separator:a6a6dd225ccb27e30c2cc06562b035ebe inherit pro_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="properties" name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:ac2744da20824177724b971eb20a6d5a0" id="r_ac2744da20824177724b971eb20a6d5a0"><td class="memItemLeft" align="right" valign="top">override bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac2744da20824177724b971eb20a6d5a0">Connected</a><code> [get]</code></td></tr>
<tr class="memdesc:ac2744da20824177724b971eb20a6d5a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> is currently connected.  <br /></td></tr>
<tr class="separator:ac2744da20824177724b971eb20a6d5a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af40c0ea392de9986a4705d403674f61c" id="r_af40c0ea392de9986a4705d403674f61c"><td class="memItemLeft" align="right" valign="top">override string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#af40c0ea392de9986a4705d403674f61c">BotMention</a><code> [get]</code></td></tr>
<tr class="memdesc:af40c0ea392de9986a4705d403674f61c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The string that indicates the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> was mentioned.  <br /></td></tr>
<tr class="separator:af40c0ea392de9986a4705d403674f61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td colspan="2" onclick="javascript:toggleInherit('properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider')"><img src="closed.png" alt="-"/>&#160;Properties inherited from <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Tgstation.Server.Host.Components.Chat.Providers.Provider</a></td></tr>
<tr class="memitem:a8f4348efc454ce044b78b979c84bd926 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a8f4348efc454ce044b78b979c84bd926"><td class="memItemLeft" align="right" valign="top">Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a8f4348efc454ce044b78b979c84bd926">InitialConnectionJob</a><code> [get]</code></td></tr>
<tr class="memdesc:a8f4348efc454ce044b78b979c84bd926 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Task that completes once the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> finishes it's first connection attempt regardless of success.  <br /></td></tr>
<tr class="separator:a8f4348efc454ce044b78b979c84bd926 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c3c897c6aadc96dfbb08ff893dc602 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_af4c3c897c6aadc96dfbb08ff893dc602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_bot.html">ChatBot</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#af4c3c897c6aadc96dfbb08ff893dc602">ChatBot</a><code> [get]</code></td></tr>
<tr class="memdesc:af4c3c897c6aadc96dfbb08ff893dc602 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ChatBot the Provider is for.  <br /></td></tr>
<tr class="separator:af4c3c897c6aadc96dfbb08ff893dc602 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe2033000d49e39a653b362ca84709a9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_afe2033000d49e39a653b362ca84709a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_utils_1_1_i_async_delayer.html">IAsyncDelayer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#afe2033000d49e39a653b362ca84709a9">AsyncDelayer</a><code> [get]</code></td></tr>
<tr class="memdesc:afe2033000d49e39a653b362ca84709a9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IAsyncDelayer for the Provider.  <br /></td></tr>
<tr class="separator:afe2033000d49e39a653b362ca84709a9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24337ff80dfef1a9657f7106758a8c3 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_ab24337ff80dfef1a9657f7106758a8c3"><td class="memItemLeft" align="right" valign="top">ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Provider</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a><code> [get]</code></td></tr>
<tr class="memdesc:ab24337ff80dfef1a9657f7106758a8c3 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">ILogger</a> for the Provider.  <br /></td></tr>
<tr class="separator:ab24337ff80dfef1a9657f7106758a8c3 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dde4ca79096c66ea97177886fa9ee5e inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a6dde4ca79096c66ea97177886fa9ee5e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6dde4ca79096c66ea97177886fa9ee5e">Connected</a><code> [get]</code></td></tr>
<tr class="memdesc:a6dde4ca79096c66ea97177886fa9ee5e inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> is currently connected.  <br /></td></tr>
<tr class="separator:a6dde4ca79096c66ea97177886fa9ee5e inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad62420e154aa53138bc79855474727ad inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_ad62420e154aa53138bc79855474727ad"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ad62420e154aa53138bc79855474727ad">BotMention</a><code> [get]</code></td></tr>
<tr class="memdesc:ad62420e154aa53138bc79855474727ad inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135" title="User may list files if the Models.Instance allows it.">string</a> that indicates the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> was mentioned.  <br /></td></tr>
<tr class="separator:ad62420e154aa53138bc79855474727ad inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ea0f5bc6f3379005d924a42bd905d9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a12ea0f5bc6f3379005d924a42bd905d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a12ea0f5bc6f3379005d924a42bd905d9">Disposed</a><code> [get, private set]</code></td></tr>
<tr class="memdesc:a12ea0f5bc6f3379005d924a42bd905d9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> was disposed.  <br /></td></tr>
<tr class="separator:a12ea0f5bc6f3379005d924a42bd905d9 inherit properties_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header properties_interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider"><td colspan="2" onclick="javascript:toggleInherit('properties_interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider')"><img src="closed.png" alt="-"/>&#160;Properties inherited from <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html">Tgstation.Server.Host.Components.Chat.Providers.IProvider</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab92d4920074cec3e48fa204af595a498" id="r_ab92d4920074cec3e48fa204af595a498"><td class="memItemLeft" align="right" valign="top">async ValueTask&lt; IEnumerable&lt; IChannel &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498">GetAllAccessibleTextChannels</a> (CancellationToken cancellationToken)</td></tr>
<tr class="memdesc:ab92d4920074cec3e48fa204af595a498"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all text IChannels accessible to and supported by the bot.  <br /></td></tr>
<tr class="separator:ab92d4920074cec3e48fa204af595a498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b4853705d24be3e16314bf050f9e7c" id="r_aa0b4853705d24be3e16314bf050f9e7c"><td class="memItemLeft" align="right" valign="top">List&lt; IEmbedField &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aa0b4853705d24be3e16314bf050f9e7c">BuildUpdateEmbedFields</a> (<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models.RevisionInformation</a> revisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models.RevisionInformation</a>? previousRevisionInformation, <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html">EngineVersion</a> engineVersion, string? gitHubOwner, string? gitHubRepo, bool localCommitPushed)</td></tr>
<tr class="memdesc:aa0b4853705d24be3e16314bf050f9e7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a List&lt;T&gt; of IEmbedFields for a discord update embed.  <br /></td></tr>
<tr class="separator:aa0b4853705d24be3e16314bf050f9e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a029782485a4021dec502e3e798eea6f0" id="r_a029782485a4021dec502e3e798eea6f0"><td class="memItemLeft" align="right" valign="top">fields.&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a029782485a4021dec502e3e798eea6f0">AddRange</a> (updatedTestMerges .Select(x=&gt; new EmbedField($&quot;#{x.Number} (Updated)&quot;, $&quot;[{x.TitleAtMerge}]({x.Url}) by _[@{x.Author}](https://github.com/{x.Author})_{Environment.NewLine}Commit: [{x.TargetCommitSha![..7]}](https://github.com/{gitHubOwner}/{gitHubRepo}/commit/{x.TargetCommitSha}){(String.IsNullOrWhiteSpace(x.Comment) ? String.Empty : $&quot;{Environment.NewLine}_ **{x.Comment} **_&quot;)}&quot;, false)))</td></tr>
<tr class="separator:a029782485a4021dec502e3e798eea6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a3cf5b9ba9079d6c9f582f61b5894f7c1" id="r_a3cf5b9ba9079d6c9f582f61b5894f7c1"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">NormalizeMentions</a> (string fromDiscord)</td></tr>
<tr class="memdesc:a3cf5b9ba9079d6c9f582f61b5894f7c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalize a discord mention string.  <br /></td></tr>
<tr class="separator:a3cf5b9ba9079d6c9f582f61b5894f7c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a73f7fae07fc8d7efc90b6464dc2eca79" id="r_a73f7fae07fc8d7efc90b6464dc2eca79"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html">IAssemblyInformationProvider</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">assemblyInformationProvider</a></td></tr>
<tr class="memdesc:a73f7fae07fc8d7efc90b6464dc2eca79"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IAssemblyInformationProvider for the DiscordProvider.  <br /></td></tr>
<tr class="separator:a73f7fae07fc8d7efc90b6464dc2eca79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac93400b45eefb577306a70a7a530147f" id="r_ac93400b45eefb577306a70a7a530147f"><td class="memItemLeft" align="right" valign="top">readonly IOptionsMonitor&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac93400b45eefb577306a70a7a530147f">generalConfigurationOptions</a></td></tr>
<tr class="memdesc:ac93400b45eefb577306a70a7a530147f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GeneralConfiguration IOptionsMonitor&lt;TOptions&gt; for the DiscordProvider.  <br /></td></tr>
<tr class="separator:ac93400b45eefb577306a70a7a530147f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7dd055bf64dcff2228ae66fdcff7e92" id="r_ae7dd055bf64dcff2228ae66fdcff7e92"><td class="memItemLeft" align="right" valign="top">readonly ServiceProvider&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a></td></tr>
<tr class="memdesc:ae7dd055bf64dcff2228ae66fdcff7e92"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ServiceProvider containing Discord services.  <br /></td></tr>
<tr class="separator:ae7dd055bf64dcff2228ae66fdcff7e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044ae95d278a4ed4a6a02449e24e8146" id="r_a044ae95d278a4ed4a6a02449e24e8146"><td class="memItemLeft" align="right" valign="top">readonly List&lt; ulong &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a></td></tr>
<tr class="memdesc:a044ae95d278a4ed4a6a02449e24e8146"><td class="mdescLeft">&#160;</td><td class="mdescRight">List&lt;T&gt; of mapped channel Snowflakes.  <br /></td></tr>
<tr class="separator:a044ae95d278a4ed4a6a02449e24e8146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01881ab9506db0431f75db21224bf7e6" id="r_a01881ab9506db0431f75db21224bf7e6"><td class="memItemLeft" align="right" valign="top">readonly object&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a01881ab9506db0431f75db21224bf7e6">connectDisconnectLock</a></td></tr>
<tr class="memdesc:a01881ab9506db0431f75db21224bf7e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock object used to sychronize connect/disconnect operations.  <br /></td></tr>
<tr class="separator:a01881ab9506db0431f75db21224bf7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182447c000f64abfb2e30336a6b9718f" id="r_a182447c000f64abfb2e30336a6b9718f"><td class="memItemLeft" align="right" valign="top">readonly bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a182447c000f64abfb2e30336a6b9718f">deploymentBranding</a></td></tr>
<tr class="memdesc:a182447c000f64abfb2e30336a6b9718f"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the tgstation-server logo is shown in deployment embeds.  <br /></td></tr>
<tr class="separator:a182447c000f64abfb2e30336a6b9718f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96681c4d5a393d80bd2ff022eed95ee5" id="r_a96681c4d5a393d80bd2ff022eed95ee5"><td class="memItemLeft" align="right" valign="top">readonly <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#af16952d12561118ecebc3d8ccf510221">DiscordDMOutputDisplayType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a96681c4d5a393d80bd2ff022eed95ee5">outputDisplayType</a></td></tr>
<tr class="memdesc:a96681c4d5a393d80bd2ff022eed95ee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#af16952d12561118ecebc3d8ccf510221" title="When the DM output section of Discord deployment embeds should be shown.">DiscordDMOutputDisplayType</a>.  <br /></td></tr>
<tr class="separator:a96681c4d5a393d80bd2ff022eed95ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdf08d03a7a5fad8b9ff607fbec8bb6" id="r_aecdf08d03a7a5fad8b9ff607fbec8bb6"><td class="memItemLeft" align="right" valign="top">CancellationTokenSource?&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a></td></tr>
<tr class="memdesc:aecdf08d03a7a5fad8b9ff607fbec8bb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The CancellationTokenSource for the gatewayTask.  <br /></td></tr>
<tr class="separator:aecdf08d03a7a5fad8b9ff607fbec8bb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f81033139026af1ea3160ef0063e737" id="r_a3f81033139026af1ea3160ef0063e737"><td class="memItemLeft" align="right" valign="top">TaskCompletionSource?&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">gatewayReadyTcs</a></td></tr>
<tr class="memdesc:a3f81033139026af1ea3160ef0063e737"><td class="mdescLeft">&#160;</td><td class="mdescRight">The TaskCompletionSource for the initial gateway connection event.  <br /></td></tr>
<tr class="separator:a3f81033139026af1ea3160ef0063e737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968f8dd1140ebe40a77c774fe7f9019b" id="r_a968f8dd1140ebe40a77c774fe7f9019b"><td class="memItemLeft" align="right" valign="top">Task&lt; Result &gt;?&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a968f8dd1140ebe40a77c774fe7f9019b">gatewayTask</a></td></tr>
<tr class="memdesc:a968f8dd1140ebe40a77c774fe7f9019b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Task representing the lifetime of the client.  <br /></td></tr>
<tr class="separator:a968f8dd1140ebe40a77c774fe7f9019b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38455db633742e90572b9a83aa681831" id="r_a38455db633742e90572b9a83aa681831"><td class="memItemLeft" align="right" valign="top">Snowflake&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a38455db633742e90572b9a83aa681831">currentUserId</a></td></tr>
<tr class="memdesc:a38455db633742e90572b9a83aa681831"><td class="mdescLeft">&#160;</td><td class="mdescRight">The bot's Snowflake.  <br /></td></tr>
<tr class="separator:a38455db633742e90572b9a83aa681831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317ac4b2144b7b5d2764063b158c7f54" id="r_a317ac4b2144b7b5d2764063b158c7f54"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a317ac4b2144b7b5d2764063b158c7f54">disposing</a></td></tr>
<tr class="memdesc:a317ac4b2144b7b5d2764063b158c7f54"><td class="mdescLeft">&#160;</td><td class="mdescRight">If serviceProvider is being disposed.  <br /></td></tr>
<tr class="separator:a317ac4b2144b7b5d2764063b158c7f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6551c929800df136bef095841ea8fd09" id="r_a6551c929800df136bef095841ea8fd09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a6551c929800df136bef095841ea8fd09">false</a></td></tr>
<tr class="separator:a6551c929800df136bef095841ea8fd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-attribs" name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a1896b3a7ddd7b500c2624d3676b64eaf" id="r_a1896b3a7ddd7b500c2624d3676b64eaf"><td class="memItemLeft" align="right" valign="top">static readonly ChannelType[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1896b3a7ddd7b500c2624d3676b64eaf">SupportedGuildChannelTypes</a></td></tr>
<tr class="memdesc:a1896b3a7ddd7b500c2624d3676b64eaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ChannelTypes supported by the DiscordProvider for mapping.  <br /></td></tr>
<tr class="separator:a1896b3a7ddd7b500c2624d3676b64eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_static_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html">Tgstation.Server.Host.Components.Chat.Providers.Provider</a></td></tr>
<tr class="memitem:a838ad29e96221a58a71b29358c086c0c inherit pro_static_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider" id="r_a838ad29e96221a58a71b29358c086c0c"><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a838ad29e96221a58a71b29358c086c0c">GetEngineCompilerPrefix</a> (<a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#ad8fb60934662752c4bbed899440208ea">Api.Models.EngineType</a> engineType)</td></tr>
<tr class="memdesc:a838ad29e96221a58a71b29358c086c0c inherit pro_static_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the prefix for messages about deployments.  <br /></td></tr>
<tr class="separator:a838ad29e96221a58a71b29358c086c0c inherit pro_static_methods_class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>IProvider for the Discord app. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00043">43</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab4076d0667f118cef056a4d3d5ab6b4a" name="ab4076d0667f118cef056a4d3d5ab6b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4076d0667f118cef056a4d3d5ab6b4a">&#9670;&#160;</a></span>DiscordProvider()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_i_job_manager.html">IJobManager</a>&#160;</td>
          <td class="paramname"><em>jobManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_utils_1_1_i_async_delayer.html">IAsyncDelayer</a>&#160;</td>
          <td class="paramname"><em>asyncDelayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ILogger&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html">DiscordProvider</a> &gt;&#160;</td>
          <td class="paramname"><em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html">IAssemblyInformationProvider</a>&#160;</td>
          <td class="paramname"><em>assemblyInformationProvider</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IOptionsMonitor&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a> &gt;&#160;</td>
          <td class="paramname"><em>generalConfigurationOptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_bot.html">ChatBot</a>&#160;</td>
          <td class="paramname"><em>chatBot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a new instance of the DiscordProvider class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jobManager</td><td>The IJobManager for the Provider.</td></tr>
    <tr><td class="paramname">asyncDelayer</td><td>The IAsyncDelayer for the Provider.</td></tr>
    <tr><td class="paramname">logger</td><td>The ILogger for the Provider.</td></tr>
    <tr><td class="paramname">assemblyInformationProvider</td><td>The value of assemblyInformationProvider.</td></tr>
    <tr><td class="paramname">chatBot</td><td>The ChatBot for the Provider.</td></tr>
    <tr><td class="paramname">generalConfigurationOptions</td><td>The value of generalConfigurationOptions.</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00146">146</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>            : base(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#aa36ffb34c69e4a990830e49f97b7c142">jobManager</a>, asyncDelayer, logger, chatBot)</div>
<div class="line"><span class="lineno">  154</span>        {</div>
<div class="line"><span class="lineno">  155</span>            this.assemblyInformationProvider = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">assemblyInformationProvider</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">assemblyInformationProvider</a>));</div>
<div class="line"><span class="lineno">  156</span>            this.generalConfigurationOptions = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac93400b45eefb577306a70a7a530147f">generalConfigurationOptions</a> ?? <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentNullException(nameof(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac93400b45eefb577306a70a7a530147f">generalConfigurationOptions</a>));</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a> = <span class="keyword">new</span> List&lt;ulong&gt;();</div>
<div class="line"><span class="lineno">  159</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a01881ab9506db0431f75db21224bf7e6">connectDisconnectLock</a> = <span class="keyword">new</span> object();</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>            var csb = <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_discord_connection_string_builder.html">DiscordConnectionStringBuilder</a>(chatBot.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_chat_bot_settings.html#acdc14bc7df5569305c8a5af42e61f1da">ConnectionString</a>!);</div>
<div class="line"><span class="lineno">  162</span>            var botToken = csb.BotToken!;</div>
<div class="line"><span class="lineno">  163</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a96681c4d5a393d80bd2ff022eed95ee5">outputDisplayType</a> = csb.DMOutputDisplay;</div>
<div class="line"><span class="lineno">  164</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a182447c000f64abfb2e30336a6b9718f">deploymentBranding</a> = csb.DeploymentBranding;</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a> = <span class="keyword">new</span> ServiceCollection()</div>
<div class="line"><span class="lineno">  167</span>                .AddDiscordGateway(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a> =&gt; botToken)</div>
<div class="line"><span class="lineno">  168</span>                .Configure&lt;DiscordGatewayClientOptions&gt;(options =&gt; options.Intents |= GatewayIntents.MessageContents)</div>
<div class="line"><span class="lineno">  169</span>                .AddSingleton(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a> =&gt; (IDiscordResponders)<span class="keyword">this</span>)</div>
<div class="line"><span class="lineno">  170</span>                .AddResponder&lt;DiscordForwardingResponder&gt;()</div>
<div class="line"><span class="lineno">  171</span>                .BuildServiceProvider();</div>
<div class="line"><span class="lineno">  172</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_discord_connection_string_builder_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_discord_connection_string_builder.html">Tgstation.Server.Api.Models.DiscordConnectionStringBuilder</a></div><div class="ttdoc">ChatConnectionStringBuilder for ChatProvider.Discord.</div><div class="ttdef"><b>Definition</b> <a href="_discord_connection_string_builder_8cs_source.html#l00011">DiscordConnectionStringBuilder.cs:12</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_chat_bot_settings_html_acdc14bc7df5569305c8a5af42e61f1da"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_internal_1_1_chat_bot_settings.html#acdc14bc7df5569305c8a5af42e61f1da">Tgstation.Server.Api.Models.Internal.ChatBotSettings.ConnectionString</a></div><div class="ttdeci">string? ConnectionString</div><div class="ttdoc">The information used to connect to the Provider.</div><div class="ttdef"><b>Definition</b> <a href="_chat_bot_settings_8cs_source.html#l00046">ChatBotSettings.cs:46</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a01881ab9506db0431f75db21224bf7e6"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a01881ab9506db0431f75db21224bf7e6">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.connectDisconnectLock</a></div><div class="ttdeci">readonly object connectDisconnectLock</div><div class="ttdoc">Lock object used to sychronize connect/disconnect operations.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00093">DiscordProvider.cs:93</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a044ae95d278a4ed4a6a02449e24e8146"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</a></div><div class="ttdeci">readonly List&lt; ulong &gt; mappedChannels</div><div class="ttdoc">List&lt;T&gt; of mapped channel Snowflakes.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00088">DiscordProvider.cs:88</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a182447c000f64abfb2e30336a6b9718f"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a182447c000f64abfb2e30336a6b9718f">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.deploymentBranding</a></div><div class="ttdeci">readonly bool deploymentBranding</div><div class="ttdoc">If the tgstation-server logo is shown in deployment embeds.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00098">DiscordProvider.cs:98</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a73f7fae07fc8d7efc90b6464dc2eca79"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.assemblyInformationProvider</a></div><div class="ttdeci">readonly IAssemblyInformationProvider assemblyInformationProvider</div><div class="ttdoc">The IAssemblyInformationProvider for the DiscordProvider.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00073">DiscordProvider.cs:73</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a96681c4d5a393d80bd2ff022eed95ee5"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a96681c4d5a393d80bd2ff022eed95ee5">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.outputDisplayType</a></div><div class="ttdeci">readonly DiscordDMOutputDisplayType outputDisplayType</div><div class="ttdoc">The DiscordDMOutputDisplayType.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00103">DiscordProvider.cs:103</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_ac93400b45eefb577306a70a7a530147f"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac93400b45eefb577306a70a7a530147f">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.generalConfigurationOptions</a></div><div class="ttdeci">readonly IOptionsMonitor&lt; GeneralConfiguration &gt; generalConfigurationOptions</div><div class="ttdoc">The GeneralConfiguration IOptionsMonitor&lt;TOptions&gt; for the DiscordProvider.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00078">DiscordProvider.cs:78</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_ae7dd055bf64dcff2228ae66fdcff7e92"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a></div><div class="ttdeci">readonly ServiceProvider serviceProvider</div><div class="ttdoc">The ServiceProvider containing Discord services.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00083">DiscordProvider.cs:83</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider_html_aa36ffb34c69e4a990830e49f97b7c142"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#aa36ffb34c69e4a990830e49f97b7c142">Tgstation.Server.Host.Components.Chat.Providers.Provider.jobManager</a></div><div class="ttdeci">readonly IJobManager jobManager</div><div class="ttdoc">The IJobManager for the Provider.</div><div class="ttdef"><b>Definition</b> <a href="_provider_8cs_source.html#l00040">Provider.cs:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00073">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.assemblyInformationProvider</a>, <a class="el" href="_discord_provider_8cs_source.html#l00093">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.connectDisconnectLock</a>, <a class="el" href="_chat_bot_settings_8cs_source.html#l00046">Tgstation.Server.Api.Models.Internal.ChatBotSettings.ConnectionString</a>, <a class="el" href="_discord_provider_8cs_source.html#l00098">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.deploymentBranding</a>, <a class="el" href="_discord_provider_8cs_source.html#l00078">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.generalConfigurationOptions</a>, <a class="el" href="_discord_provider_8cs_source.html#l00088">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</a>, <a class="el" href="_discord_provider_8cs_source.html#l00103">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.outputDisplayType</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a029782485a4021dec502e3e798eea6f0" name="a029782485a4021dec502e3e798eea6f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a029782485a4021dec502e3e798eea6f0">&#9670;&#160;</a></span>AddRange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">fields. Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.AddRange </td>
          <td>(</td>
          <td class="paramtype">updatedTestMerges .&#160;</td>
          <td class="paramname"><em>Select</em>x=&gt; new EmbedField($&quot;#{x.Number} (Updated)&quot;, $&quot;[{x.TitleAtMerge}]({x.Url}) by _[@{x.Author}](https://github.com/{x.Author})_{Environment.NewLine}Commit: [{x.TargetCommitSha![..7]}](https://github.com/{gitHubOwner}/{gitHubRepo}/commit/{x.TargetCommitSha}){(String.IsNullOrWhiteSpace(x.Comment) ? String.Empty : $&quot;{Environment.NewLine}_ **{x.Comment} **_&quot;)}&quot;, false)</td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa0b4853705d24be3e16314bf050f9e7c" name="aa0b4853705d24be3e16314bf050f9e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0b4853705d24be3e16314bf050f9e7c">&#9670;&#160;</a></span>BuildUpdateEmbedFields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">List&lt; IEmbedField &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.BuildUpdateEmbedFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models::RevisionInformation</a>&#160;</td>
          <td class="paramname"><em>revisionInformation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models::RevisionInformation</a>?&#160;</td>
          <td class="paramname"><em>previousRevisionInformation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html">EngineVersion</a>&#160;</td>
          <td class="paramname"><em>engineVersion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string?&#160;</td>
          <td class="paramname"><em>gitHubOwner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string?&#160;</td>
          <td class="paramname"><em>gitHubRepo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>localCommitPushed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a List&lt;T&gt; of IEmbedFields for a discord update embed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">revisionInformation</td><td>The RevisionInformation of the deployment.</td></tr>
    <tr><td class="paramname">previousRevisionInformation</td><td>The optional RevisionInformation of the previous deployment.</td></tr>
    <tr><td class="paramname">engineVersion</td><td>The EngineVersion of the deployment.</td></tr>
    <tr><td class="paramname">gitHubOwner</td><td>The repository GitHub owner, if any.</td></tr>
    <tr><td class="paramname">gitHubRepo</td><td>The repository GitHub name, if any.</td></tr>
    <tr><td class="paramname">localCommitPushed</td><td><code>true</code> if the local deployment commit was pushed to the remote repository.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new List&lt;T&gt; of IEmbedFields to use.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00911">911</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  918</span>        {</div>
<div class="line"><span class="lineno">  919</span>            <span class="keywordtype">bool</span> gitHub = gitHubOwner != <span class="keyword">null</span> &amp;&amp; gitHubRepo != <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  920</span>            var engineField = engineVersion.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html#ae13db4c5dbd6b06c79d37ad9afd25af2">Engine</a>!.Value <span class="keywordflow">switch</span></div>
<div class="line"><span class="lineno">  921</span>            {</div>
<div class="line"><span class="lineno">  922</span>                EngineType.Byond =&gt; <span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  923</span>                    <span class="stringliteral">&quot;BYOND Version&quot;</span>,</div>
<div class="line"><span class="lineno">  924</span>                    $<span class="stringliteral">&quot;{engineVersion.Version!.Major}.{engineVersion.Version.Minor}{(engineVersion.CustomIteration.HasValue ? $&quot;</span>.{engineVersion.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html#af9d95aff0fd29f0d587bdc78b4969a77">CustomIteration</a>.Value}<span class="stringliteral">&quot; : String.Empty)}&quot;</span>,</div>
<div class="line"><span class="lineno">  925</span>                    <span class="keyword">true</span>),</div>
<div class="line"><span class="lineno">  926</span>                <a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#ad8fb60934662752c4bbed899440208ea">EngineType</a>.OpenDream =&gt; <span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  927</span>                    <span class="stringliteral">&quot;OpenDream Version&quot;</span>,</div>
<div class="line"><span class="lineno">  928</span>                    $<span class="stringliteral">&quot;[{engineVersion.SourceSHA![..7]}]({generalConfigurationOptions.CurrentValue.OpenDreamGitUrl}/commit/{engineVersion.SourceSHA})&quot;</span>,</div>
<div class="line"><span class="lineno">  929</span>                    <span class="keyword">true</span>),</div>
<div class="line"><span class="lineno">  930</span>                _ =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;Invaild EngineType: {engineVersion.Engine.Value}&quot;</span>),</div>
<div class="line"><span class="lineno">  931</span>            };</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>            var revisionSha = revisionInformation.CommitSha!;</div>
<div class="line"><span class="lineno">  934</span>            var revisionOriginSha = revisionInformation.OriginCommitSha!;</div>
<div class="line"><span class="lineno">  935</span>            var fields = <span class="keyword">new</span> List&lt;IEmbedField&gt;</div>
<div class="line"><span class="lineno">  936</span>            {</div>
<div class="line"><span class="lineno">  937</span>                engineField,</div>
<div class="line"><span class="lineno">  938</span>            };</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>            <span class="keywordflow">if</span> (gitHubOwner == <span class="keyword">null</span> || gitHubRepo == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  941</span>                <span class="keywordflow">return</span> fields;</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>            var previousTestMerges = (IEnumerable&lt;RevInfoTestMerge&gt;?)previousRevisionInformation?.ActiveTestMerges ?? Enumerable.Empty&lt;<a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_rev_info_test_merge.html">RevInfoTestMerge</a>&gt;();</div>
<div class="line"><span class="lineno">  944</span>            var currentTestMerges = (IEnumerable&lt;RevInfoTestMerge&gt;?)revisionInformation.ActiveTestMerges ?? Enumerable.Empty&lt;<a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_rev_info_test_merge.html">RevInfoTestMerge</a>&gt;();</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>            <span class="comment">// determine what TMs were changed and how</span></div>
<div class="line"><span class="lineno">  947</span>            var addedTestMerges = currentTestMerges</div>
<div class="line"><span class="lineno">  948</span>                .Select(x =&gt; x.TestMerge)</div>
<div class="line"><span class="lineno">  949</span>                .Where(x =&gt; !previousTestMerges</div>
<div class="line"><span class="lineno">  950</span>                    .Any(y =&gt; y.TestMerge.Number == x.Number))</div>
<div class="line"><span class="lineno">  951</span>                .ToList();</div>
<div class="line"><span class="lineno">  952</span>            var removedTestMerges = previousTestMerges</div>
<div class="line"><span class="lineno">  953</span>                .Select(x =&gt; x.TestMerge)</div>
<div class="line"><span class="lineno">  954</span>                .Where(x =&gt; !currentTestMerges</div>
<div class="line"><span class="lineno">  955</span>                    .Any(y =&gt; y.TestMerge.Number == x.Number))</div>
<div class="line"><span class="lineno">  956</span>                .ToList();</div>
<div class="line"><span class="lineno">  957</span>            var updatedTestMerges = currentTestMerges</div>
<div class="line"><span class="lineno">  958</span>                .Select(x =&gt; x.TestMerge)</div>
<div class="line"><span class="lineno">  959</span>                .Where(x =&gt; previousTestMerges</div>
<div class="line"><span class="lineno">  960</span>                    .Any(y =&gt; y.TestMerge.Number == x.Number &amp;&amp; y.TestMerge.TargetCommitSha != x.TargetCommitSha))</div>
<div class="line"><span class="lineno">  961</span>                .ToList();</div>
<div class="line"><span class="lineno">  962</span>            var unchangedTestMerges = currentTestMerges</div>
<div class="line"><span class="lineno">  963</span>                .Select(x =&gt; x.TestMerge)</div>
<div class="line"><span class="lineno">  964</span>                .Where(x =&gt; previousTestMerges</div>
<div class="line"><span class="lineno">  965</span>                    .Any(y =&gt; y.TestMerge.Number == x.Number &amp;&amp; y.TestMerge.TargetCommitSha == x.TargetCommitSha))</div>
<div class="line"><span class="lineno">  966</span>                .ToList();</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>            fields.Add(</div>
<div class="line"><span class="lineno">  969</span>                <span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  970</span>                    <span class="stringliteral">&quot;Local Commit&quot;</span>,</div>
<div class="line"><span class="lineno">  971</span>                    localCommitPushed &amp;&amp; gitHub</div>
<div class="line"><span class="lineno">  972</span>                        ? $<span class="stringliteral">&quot;[{revisionSha[..7]}](https://github.com/{gitHubOwner}/{gitHubRepo}/commit/{revisionSha})&quot;</span></div>
<div class="line"><span class="lineno">  973</span>                        : revisionSha[..7],</div>
<div class="line"><span class="lineno">  974</span>                    true));</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>            fields.Add(</div>
<div class="line"><span class="lineno">  977</span>                <span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  978</span>                    <span class="stringliteral">&quot;Branch Commit&quot;</span>,</div>
<div class="line"><span class="lineno">  979</span>                    gitHub</div>
<div class="line"><span class="lineno">  980</span>                        ? $<span class="stringliteral">&quot;[{revisionOriginSha[..7]}](https://github.com/{gitHubOwner}/{gitHubRepo}/commit/{revisionOriginSha})&quot;</span></div>
<div class="line"><span class="lineno">  981</span>                        : revisionOriginSha[..7],</div>
<div class="line"><span class="lineno">  982</span>                    true));</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span>            fields.AddRange(addedTestMerges</div>
<div class="line"><span class="lineno">  985</span>                .Select(x =&gt; <span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  986</span>                    $<span class="stringliteral">&quot;#{x.Number} (Added)&quot;</span>,</div>
<div class="line"><span class="lineno">  987</span>                    $<span class="stringliteral">&quot;[{x.TitleAtMerge}]({x.Url}) by _[@{x.Author}](https://github.com/{x.Author})_{Environment.NewLine}Commit: [{x.TargetCommitSha![..7]}](https://github.com/{gitHubOwner}/{gitHubRepo}/commit/{x.TargetCommitSha}){(String.IsNullOrWhiteSpace(x.Comment) ? String.Empty : $&quot;</span>{Environment.NewLine}_**{x.Comment}**_<span class="stringliteral">&quot;)}&quot;</span>,</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version_html_ae13db4c5dbd6b06c79d37ad9afd25af2"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html#ae13db4c5dbd6b06c79d37ad9afd25af2">Tgstation.Server.Api.Models.EngineVersion.Engine</a></div><div class="ttdeci">EngineType? Engine</div><div class="ttdoc">The EngineType.</div><div class="ttdef"><b>Definition</b> <a href="_engine_version_8cs_source.html#l00024">EngineVersion.cs:24</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version_html_af9d95aff0fd29f0d587bdc78b4969a77"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html#af9d95aff0fd29f0d587bdc78b4969a77">Tgstation.Server.Api.Models.EngineVersion.CustomIteration</a></div><div class="ttdeci">int? CustomIteration</div><div class="ttdoc">The revision of the custom build.</div><div class="ttdef"><b>Definition</b> <a href="_engine_version_8cs_source.html#l00045">EngineVersion.cs:45</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_models_1_1_rev_info_test_merge_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_rev_info_test_merge.html">Tgstation.Server.Host.Models.RevInfoTestMerge</a></div><div class="ttdoc">Many to many relationship for Models.RevisionInformation and Models.TestMerge.</div><div class="ttdef"><b>Definition</b> <a href="_rev_info_test_merge_8cs_source.html#l00009">RevInfoTestMerge.cs:10</a></div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_api_1_1_models_html_ad8fb60934662752c4bbed899440208ea"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#ad8fb60934662752c4bbed899440208ea">Tgstation.Server.Api.Models.EngineType</a></div><div class="ttdeci">EngineType</div><div class="ttdoc">The type of engine the codebase is using.</div><div class="ttdef"><b>Definition</b> <a href="_engine_type_8cs_source.html#l00006">EngineType.cs:7</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_engine_version_8cs_source.html#l00045">Tgstation.Server.Api.Models.EngineVersion.CustomIteration</a>, and <a class="el" href="_engine_version_8cs_source.html#l00024">Tgstation.Server.Api.Models.EngineVersion.Engine</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00305">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_aa0b4853705d24be3e16314bf050f9e7c_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_aa0b4853705d24be3e16314bf050f9e7c_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_aa0b4853705d24be3e16314bf050f9e7c_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_aa0b4853705d24be3e16314bf050f9e7c_icgraph">
<area shape="rect" title="Create a List&lt;T&gt; of IEmbedFields for a discord update embed." alt="" coords="288,5,521,61"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a6b14b94a01f2a1478f1ade14ef9a7471" title="Send the message for a deployment.A ValueTask&lt;TResult&gt; resulting in a Func&lt;T1, T2,..." alt="" coords="5,5,240,61"/>
<area shape="poly" title=" " alt="" coords="272,36,240,36,240,31,272,31"/>
</map>
</div>

</div>
</div>
<a id="a3fd130f635e4577bedefa9926a4e2c73" name="a3fd130f635e4577bedefa9926a4e2c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd130f635e4577bedefa9926a4e2c73">&#9670;&#160;</a></span>Connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00584">584</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  585</span>        {</div>
<div class="line"><span class="lineno">  586</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  587</span>            {</div>
<div class="line"><span class="lineno">  588</span>                lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a01881ab9506db0431f75db21224bf7e6">connectDisconnectLock</a>)</div>
<div class="line"><span class="lineno">  589</span>                {</div>
<div class="line"><span class="lineno">  590</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a> != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  591</span>                        <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Discord gateway still active!&quot;</span>);</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>                    <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a> = <span class="keyword">new</span> CancellationTokenSource();</div>
<div class="line"><span class="lineno">  594</span>                }</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>                var gatewayCancellationToken = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a>.Token;</div>
<div class="line"><span class="lineno">  597</span>                var gatewayClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;DiscordGatewayClient&gt;();</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>                Task&lt;Result&gt; localGatewayTask;</div>
<div class="line"><span class="lineno">  600</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">gatewayReadyTcs</a> = <span class="keyword">new</span> TaskCompletionSource();</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>                <span class="keyword">using </span>var gatewayConnectionAbortRegistration = cancellationToken.Register(() =&gt; <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">gatewayReadyTcs</a>.TrySetCanceled(cancellationToken));</div>
<div class="line"><span class="lineno">  603</span>                gatewayCancellationToken.Register(() =&gt; <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;Stopping gateway client...&quot;</span>));</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>                <span class="comment">// reconnects keep happening until we stop or it faults, our auto-reconnector will handle the latter</span></div>
<div class="line"><span class="lineno">  606</span>                localGatewayTask = gatewayClient.RunAsync(gatewayCancellationToken);</div>
<div class="line"><span class="lineno">  607</span>                <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  608</span>                {</div>
<div class="line"><span class="lineno">  609</span>                    await Task.WhenAny(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">gatewayReadyTcs</a>.Task, localGatewayTask);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>                    cancellationToken.ThrowIfCancellationRequested();</div>
<div class="line"><span class="lineno">  612</span>                    <span class="keywordflow">if</span> (localGatewayTask.IsCompleted)</div>
<div class="line"><span class="lineno">  613</span>                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_job_exception.html">JobException</a>(<a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#a1a6adb59dd51244efabf4e548e7075c8">ErrorCode</a>.ChatCannotConnectProvider);</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>                    var userClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestUserAPI&gt;();</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>                    <span class="keyword">using </span>var localCombinedCts = CancellationTokenSource.CreateLinkedTokenSource(cancellationToken, gatewayCancellationToken);</div>
<div class="line"><span class="lineno">  618</span>                    var localCombinedCancellationToken = localCombinedCts.Token;</div>
<div class="line"><span class="lineno">  619</span>                    var currentUserResult = await userClient.GetCurrentUserAsync(localCombinedCancellationToken);</div>
<div class="line"><span class="lineno">  620</span>                    <span class="keywordflow">if</span> (!currentUserResult.IsSuccess)</div>
<div class="line"><span class="lineno">  621</span>                    {</div>
<div class="line"><span class="lineno">  622</span>                        localCombinedCancellationToken.ThrowIfCancellationRequested();</div>
<div class="line"><span class="lineno">  623</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(<span class="stringliteral">&quot;Unable to retrieve current user: {result}&quot;</span>, currentUserResult.LogFormat());</div>
<div class="line"><span class="lineno">  624</span>                        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_job_exception.html">JobException</a>(<a class="code hl_enumeration" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#a1a6adb59dd51244efabf4e548e7075c8">ErrorCode</a>.ChatCannotConnectProvider);</div>
<div class="line"><span class="lineno">  625</span>                    }</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>                    <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a38455db633742e90572b9a83aa681831">currentUserId</a> = currentUserResult.Entity.ID;</div>
<div class="line"><span class="lineno">  628</span>                }</div>
<div class="line"><span class="lineno">  629</span>                <span class="keywordflow">finally</span></div>
<div class="line"><span class="lineno">  630</span>                {</div>
<div class="line"><span class="lineno">  631</span>                    <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a968f8dd1140ebe40a77c774fe7f9019b">gatewayTask</a> = localGatewayTask;</div>
<div class="line"><span class="lineno">  632</span>                }</div>
<div class="line"><span class="lineno">  633</span>            }</div>
<div class="line"><span class="lineno">  634</span>            <span class="keywordflow">catch</span></div>
<div class="line"><span class="lineno">  635</span>            {</div>
<div class="line"><span class="lineno">  636</span>                <span class="comment">// will handle cleanup</span></div>
<div class="line"><span class="lineno">  637</span>                <span class="comment">// DCT: Musn&#39;t abort</span></div>
<div class="line"><span class="lineno">  638</span>                await <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a9998d613750e44e779ae89931f7cfd98">DisconnectImpl</a>(CancellationToken.None);</div>
<div class="line"><span class="lineno">  639</span>                <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  640</span>            }</div>
<div class="line"><span class="lineno">  641</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a38455db633742e90572b9a83aa681831"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a38455db633742e90572b9a83aa681831">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.currentUserId</a></div><div class="ttdeci">Snowflake currentUserId</div><div class="ttdoc">The bot's Snowflake.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00123">DiscordProvider.cs:123</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a3f81033139026af1ea3160ef0063e737"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayReadyTcs</a></div><div class="ttdeci">TaskCompletionSource? gatewayReadyTcs</div><div class="ttdoc">The TaskCompletionSource for the initial gateway connection event.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00113">DiscordProvider.cs:113</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a968f8dd1140ebe40a77c774fe7f9019b"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a968f8dd1140ebe40a77c774fe7f9019b">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayTask</a></div><div class="ttdeci">Task&lt; Result &gt;? gatewayTask</div><div class="ttdoc">The Task representing the lifetime of the client.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00118">DiscordProvider.cs:118</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a9998d613750e44e779ae89931f7cfd98"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a9998d613750e44e779ae89931f7cfd98">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl</a></div><div class="ttdeci">override async ValueTask DisconnectImpl(CancellationToken cancellationToken)</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00644">DiscordProvider.cs:644</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_aecdf08d03a7a5fad8b9ff607fbec8bb6"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayCts</a></div><div class="ttdeci">CancellationTokenSource? gatewayCts</div><div class="ttdoc">The CancellationTokenSource for the gatewayTask.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00108">DiscordProvider.cs:108</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider_html_ab24337ff80dfef1a9657f7106758a8c3"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a></div><div class="ttdeci">ILogger&lt; Provider &gt; Logger</div><div class="ttdoc">The ILogger for the Provider.</div><div class="ttdef"><b>Definition</b> <a href="_provider_8cs_source.html#l00035">Provider.cs:35</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_job_exception_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_jobs_1_1_job_exception.html">Tgstation.Server.Host.Jobs.JobException</a></div><div class="ttdoc">Operation exceptions thrown from the context of a Models.Job.</div><div class="ttdef"><b>Definition</b> <a href="_job_exception_8cs_source.html#l00010">JobException.cs:11</a></div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_api_1_1_models_html_a1a6adb59dd51244efabf4e548e7075c8"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#a1a6adb59dd51244efabf4e548e7075c8">Tgstation.Server.Api.Models.ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Types of Response.ErrorMessageResponses that the API may return.</div><div class="ttdef"><b>Definition</b> <a href="_error_code_8cs_source.html#l00011">ErrorCode.cs:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00093">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.connectDisconnectLock</a>, <a class="el" href="_discord_provider_8cs_source.html#l00123">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.currentUserId</a>, <a class="el" href="_discord_provider_8cs_source.html#l00644">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00108">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayCts</a>, <a class="el" href="_discord_provider_8cs_source.html#l00113">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayReadyTcs</a>, <a class="el" href="_discord_provider_8cs_source.html#l00118">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayTask</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3fd130f635e4577bedefa9926a4e2c73_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3fd130f635e4577bedefa9926a4e2c73_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3fd130f635e4577bedefa9926a4e2c73_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3fd130f635e4577bedefa9926a4e2c73_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,258,46"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a9998d613750e44e779ae89931f7cfd98" title=" " alt="" coords="306,5,600,46"/>
<area shape="poly" title=" " alt="" coords="258,23,290,23,290,28,258,28"/>
</map>
</div>

</div>
</div>
<a id="a9998d613750e44e779ae89931f7cfd98" name="a9998d613750e44e779ae89931f7cfd98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9998d613750e44e779ae89931f7cfd98">&#9670;&#160;</a></span>DisconnectImpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00644">644</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>        {</div>
<div class="line"><span class="lineno">  646</span>            Task&lt;Result&gt; localGatewayTask;</div>
<div class="line"><span class="lineno">  647</span>            CancellationTokenSource localGatewayCts;</div>
<div class="line"><span class="lineno">  648</span>            lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a01881ab9506db0431f75db21224bf7e6">connectDisconnectLock</a>)</div>
<div class="line"><span class="lineno">  649</span>            {</div>
<div class="line"><span class="lineno">  650</span>                localGatewayTask = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a968f8dd1140ebe40a77c774fe7f9019b">gatewayTask</a>!;</div>
<div class="line"><span class="lineno">  651</span>                localGatewayCts = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a>!;</div>
<div class="line"><span class="lineno">  652</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a968f8dd1140ebe40a77c774fe7f9019b">gatewayTask</a> = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  653</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a> = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  654</span>                <span class="keywordflow">if</span> (localGatewayTask == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  655</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  656</span>            }</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>            localGatewayCts.Cancel();</div>
<div class="line"><span class="lineno">  659</span>            var gatewayResult = await localGatewayTask;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>            <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;Gateway task complete&quot;</span>);</div>
<div class="line"><span class="lineno">  662</span>            <span class="keywordflow">if</span> (!gatewayResult.IsSuccess)</div>
<div class="line"><span class="lineno">  663</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(<span class="stringliteral">&quot;Gateway issue: {result}&quot;</span>, gatewayResult.LogFormat());</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>            localGatewayCts.Dispose();</div>
<div class="line"><span class="lineno">  666</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00093">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.connectDisconnectLock</a>, <a class="el" href="_discord_provider_8cs_source.html#l00108">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayCts</a>, <a class="el" href="_discord_provider_8cs_source.html#l00118">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayTask</a>, and <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a9998d613750e44e779ae89931f7cfd98_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a9998d613750e44e779ae89931f7cfd98_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a9998d613750e44e779ae89931f7cfd98_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a9998d613750e44e779ae89931f7cfd98_icgraph">
<area shape="rect" title=" " alt="" coords="306,5,600,46"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3fd130f635e4577bedefa9926a4e2c73" title=" " alt="" coords="5,5,258,46"/>
<area shape="poly" title=" " alt="" coords="290,28,258,28,258,23,290,23"/>
</map>
</div>

</div>
</div>
<a id="ab650903107863653f1b637562f4813b4" name="ab650903107863653f1b637562f4813b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab650903107863653f1b637562f4813b4">&#9670;&#160;</a></span>DisposeAsync()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisposeAsync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>

<p>Reimplemented from <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#afe2edd40c945bc526ccd5dfea7a062b1">Tgstation.Server.Host.Components.Chat.Providers.Provider</a>.</p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00175">175</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>        {</div>
<div class="line"><span class="lineno">  177</span>            lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>)</div>
<div class="line"><span class="lineno">  178</span>            {</div>
<div class="line"><span class="lineno">  179</span>                <span class="comment">// serviceProvider can recursively dispose us</span></div>
<div class="line"><span class="lineno">  180</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a317ac4b2144b7b5d2764063b158c7f54">disposing</a>)</div>
<div class="line"><span class="lineno">  181</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  182</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a317ac4b2144b7b5d2764063b158c7f54">disposing</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  183</span>            }</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>            await base.DisposeAsync();</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>            await <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.DisposeAsync();</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;ServiceProvider disposed&quot;</span>);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>            <span class="comment">// this line is purely here to shutup CA2213. It should always be null</span></div>
<div class="line"><span class="lineno">  192</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aecdf08d03a7a5fad8b9ff607fbec8bb6">gatewayCts</a>?.Dispose();</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a317ac4b2144b7b5d2764063b158c7f54">disposing</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  195</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a317ac4b2144b7b5d2764063b158c7f54"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a317ac4b2144b7b5d2764063b158c7f54">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.disposing</a></div><div class="ttdeci">bool disposing</div><div class="ttdoc">If serviceProvider is being disposed.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00128">DiscordProvider.cs:128</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00128">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.disposing</a>, <a class="el" href="_discord_provider_8cs_source.html#l00108">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayCts</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>.</p>

</div>
</div>
<a id="ab92d4920074cec3e48fa204af595a498" name="ab92d4920074cec3e48fa204af595a498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab92d4920074cec3e48fa204af595a498">&#9670;&#160;</a></span>GetAllAccessibleTextChannels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">async ValueTask&lt; IEnumerable&lt; IChannel &gt; &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels </td>
          <td>(</td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all text IChannels accessible to and supported by the bot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task&lt;TResult&gt; resulting in an IEnumerable&lt;T&gt; of accessible and compatible IChannels.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00847">847</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  848</span>        {</div>
<div class="line"><span class="lineno">  849</span>            var usersClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestUserAPI&gt;();</div>
<div class="line"><span class="lineno">  850</span>            var currentGuildsResponse = await usersClient.GetCurrentUserGuildsAsync(ct: cancellationToken);</div>
<div class="line"><span class="lineno">  851</span>            <span class="keywordflow">if</span> (!currentGuildsResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  852</span>            {</div>
<div class="line"><span class="lineno">  853</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  854</span>                    <span class="stringliteral">&quot;Error retrieving current discord guilds: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  855</span>                    currentGuildsResponse.LogFormat());</div>
<div class="line"><span class="lineno">  856</span>                <span class="keywordflow">return</span> Enumerable.Empty&lt;IChannel&gt;();</div>
<div class="line"><span class="lineno">  857</span>            }</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>            var guildsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestGuildAPI&gt;();</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>            async ValueTask&lt;IEnumerable&lt;IChannel&gt;&gt; GetGuildChannels(IPartialGuild guild)</div>
<div class="line"><span class="lineno">  862</span>            {</div>
<div class="line"><span class="lineno">  863</span>                var channelsTask = guildsClient.GetGuildChannelsAsync(guild.ID.Value, cancellationToken);</div>
<div class="line"><span class="lineno">  864</span>                var threads = await guildsClient.ListActiveGuildThreadsAsync(guild.ID.Value, cancellationToken);</div>
<div class="line"><span class="lineno">  865</span>                <span class="keywordflow">if</span> (!threads.IsSuccess)</div>
<div class="line"><span class="lineno">  866</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  867</span>                        <span class="stringliteral">&quot;Error retrieving discord guild threads {guildId} ({guildName}): {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  868</span>                        guild.ID,</div>
<div class="line"><span class="lineno">  869</span>                        guild.Name,</div>
<div class="line"><span class="lineno">  870</span>                        threads.LogFormat());</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>                var channels = await channelsTask;</div>
<div class="line"><span class="lineno">  873</span>                <span class="keywordflow">if</span> (!channels.IsSuccess)</div>
<div class="line"><span class="lineno">  874</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  875</span>                        <span class="stringliteral">&quot;Error retrieving discord guild channels {guildId} ({guildName}): {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  876</span>                        guild.ID,</div>
<div class="line"><span class="lineno">  877</span>                        guild.Name,</div>
<div class="line"><span class="lineno">  878</span>                        channels.LogFormat());</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>                <span class="keywordflow">if</span> (!channels.IsSuccess &amp;&amp; !threads.IsSuccess)</div>
<div class="line"><span class="lineno">  881</span>                    <span class="keywordflow">return</span> Enumerable.Empty&lt;IChannel&gt;();</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>                <span class="keywordflow">if</span> (channels.IsSuccess &amp;&amp; threads.IsSuccess)</div>
<div class="line"><span class="lineno">  884</span>                    <span class="keywordflow">return</span> channels.Entity.Concat(threads.Entity.Threads ?? Enumerable.Empty&lt;IChannel&gt;());</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>                <span class="keywordflow">return</span> channels.Entity ?? threads.Entity?.Threads ?? Enumerable.Empty&lt;IChannel&gt;();</div>
<div class="line"><span class="lineno">  887</span>            }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>            var guildsChannelsTasks = currentGuildsResponse.Entity</div>
<div class="line"><span class="lineno">  890</span>                .Select(GetGuildChannels);</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>            var guildsChannels = await <a class="code hl_class" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html">ValueTaskExtensions</a>.<a class="code hl_function" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3">WhenAll</a>(guildsChannelsTasks, currentGuildsResponse.Entity.Count);</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>            var allAccessibleChannels = guildsChannels</div>
<div class="line"><span class="lineno">  895</span>                .SelectMany(channels =&gt; channels)</div>
<div class="line"><span class="lineno">  896</span>                .Where(guildChannel =&gt; <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1896b3a7ddd7b500c2624d3676b64eaf">SupportedGuildChannelTypes</a>.Contains(guildChannel.Type));</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>            <span class="keywordflow">return</span> allAccessibleChannels;</div>
<div class="line"><span class="lineno">  899</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html">Tgstation.Server.Common.Extensions.ValueTaskExtensions</a></div><div class="ttdoc">Extension methods for the ValueTask and ValueTask&lt;TResult&gt; classes.</div><div class="ttdef"><b>Definition</b> <a href="_value_task_extensions_8cs_source.html#l00011">ValueTaskExtensions.cs:12</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions_html_a58adbd94d764754bd3e6c566a5fe7fe3"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3">Tgstation.Server.Common.Extensions.ValueTaskExtensions.WhenAll</a></div><div class="ttdeci">static async ValueTask WhenAll(IEnumerable&lt; ValueTask &gt; tasks)</div><div class="ttdoc">Fully await a given list of tasks .</div><div class="ttdef"><b>Definition</b> <a href="_value_task_extensions_8cs_source.html#l00099">ValueTaskExtensions.cs:99</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a1896b3a7ddd7b500c2624d3676b64eaf"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1896b3a7ddd7b500c2624d3676b64eaf">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SupportedGuildChannelTypes</a></div><div class="ttdeci">static readonly ChannelType[] SupportedGuildChannelTypes</div><div class="ttdoc">The ChannelTypes supported by the DiscordProvider for mapping.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00062">DiscordProvider.cs:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>, <a class="el" href="_discord_provider_8cs_source.html#l00062">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SupportedGuildChannelTypes</a>, and <a class="el" href="_value_task_extensions_8cs_source.html#l00099">Tgstation.Server.Common.Extensions.ValueTaskExtensions.WhenAll()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00669">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.MapChannelsImpl()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00198">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendMessage()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_cgraph">
<area shape="rect" title="Get all text IChannels accessible to and supported by the bot." alt="" coords="5,5,246,61"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3" title="Fully await a given list of tasks ." alt="" coords="294,5,509,61"/>
<area shape="poly" title=" " alt="" coords="246,31,278,31,278,36,246,36"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_ab92d4920074cec3e48fa204af595a498_icgraph">
<area shape="rect" title="Get all text IChannels accessible to and supported by the bot." alt="" coords="362,34,602,90"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a48adcd32348dbab4150bd2c8087623e0" title=" " alt="" coords="5,5,314,46"/>
<area shape="poly" title=" " alt="" coords="346,49,314,46,315,40,346,44"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1494b2b91cc869199100c9338f91d864" title="Send a message to the IProvider.A ValueTask representing the running operation." alt="" coords="42,70,277,126"/>
<area shape="poly" title=" " alt="" coords="346,79,277,87,277,82,346,74"/>
</map>
</div>

</div>
</div>
<a id="a48adcd32348dbab4150bd2c8087623e0" name="a48adcd32348dbab4150bd2c8087623e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48adcd32348dbab4150bd2c8087623e0">&#9670;&#160;</a></span>MapChannelsImpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask&lt; Dictionary&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">Models.ChatChannel</a>, IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html">ChannelRepresentation</a> &gt; &gt; &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.MapChannelsImpl </td>
          <td>(</td>
          <td class="paramtype">IEnumerable&lt; <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_chat_channel.html">Models::ChatChannel</a> &gt;&#160;</td>
          <td class="paramname"><em>channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00669">669</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  670</span>        {</div>
<div class="line"><span class="lineno">  671</span>            ArgumentNullException.ThrowIfNull(channels);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>            var remapRequired = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  674</span>            var guildsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestGuildAPI&gt;();</div>
<div class="line"><span class="lineno">  675</span>            var guildTasks = <span class="keyword">new</span> ConcurrentDictionary&lt;Snowflake, Task&lt;Result&lt;IGuild&gt;&gt;&gt;();</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>            async ValueTask&lt;Tuple&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;?&gt; GetModelChannelFromDBChannel(Models.ChatChannel channelFromDB)</div>
<div class="line"><span class="lineno">  678</span>            {</div>
<div class="line"><span class="lineno">  679</span>                <span class="keywordflow">if</span> (!channelFromDB.DiscordChannelId.HasValue)</div>
<div class="line"><span class="lineno">  680</span>                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;ChatChannel missing DiscordChannelId!&quot;</span>);</div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>                var channelId = channelFromDB.DiscordChannelId.Value;</div>
<div class="line"><span class="lineno">  683</span>                var channelsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestChannelAPI&gt;();</div>
<div class="line"><span class="lineno">  684</span>                var discordChannelResponse = await channelsClient.GetChannelAsync(<span class="keyword">new</span> Snowflake(channelId), cancellationToken);</div>
<div class="line"><span class="lineno">  685</span>                <span class="keywordflow">if</span> (!discordChannelResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  686</span>                {</div>
<div class="line"><span class="lineno">  687</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  688</span>                        <span class="stringliteral">&quot;Error retrieving discord channel {channelId}: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  689</span>                        channelId,</div>
<div class="line"><span class="lineno">  690</span>                        discordChannelResponse.LogFormat());</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>                    var remapConditional = !(discordChannelResponse.Error is RestResultError&lt;RestError&gt; restResultError</div>
<div class="line"><span class="lineno">  693</span>                        &amp;&amp; (restResultError.Error?.Code == DiscordError.MissingAccess</div>
<div class="line"><span class="lineno">  694</span>                        || restResultError.Error?.Code == DiscordError.UnknownChannel));</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>                    <span class="keywordflow">if</span> (remapConditional)</div>
<div class="line"><span class="lineno">  697</span>                    {</div>
<div class="line"><span class="lineno">  698</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.Log(</div>
<div class="line"><span class="lineno">  699</span>                            remapRequired</div>
<div class="line"><span class="lineno">  700</span>                                ? LogLevel.Trace</div>
<div class="line"><span class="lineno">  701</span>                                : LogLevel.Debug,</div>
<div class="line"><span class="lineno">  702</span>                            <span class="stringliteral">&quot;Error on channel {channelId} is not an access/thread issue. Will retry remap...&quot;</span>,</div>
<div class="line"><span class="lineno">  703</span>                            channelId);</div>
<div class="line"><span class="lineno">  704</span>                        remapRequired = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  705</span>                    }</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>                    <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  708</span>                }</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>                var channelType = discordChannelResponse.Entity.Type;</div>
<div class="line"><span class="lineno">  711</span>                <span class="keywordflow">if</span> (!<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a1896b3a7ddd7b500c2624d3676b64eaf">SupportedGuildChannelTypes</a>.Contains(channelType))</div>
<div class="line"><span class="lineno">  712</span>                {</div>
<div class="line"><span class="lineno">  713</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(<span class="stringliteral">&quot;Cound not map channel {channelId}! Incorrect type: {channelType}&quot;</span>, channelId, discordChannelResponse.Entity.Type);</div>
<div class="line"><span class="lineno">  714</span>                    <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  715</span>                }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>                var guildId = discordChannelResponse.Entity.GuildID.Value;</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>                var added = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  720</span>                var guildsResponse = await guildTasks.GetOrAdd(</div>
<div class="line"><span class="lineno">  721</span>                    guildId,</div>
<div class="line"><span class="lineno">  722</span>                    localGuildId =&gt;</div>
<div class="line"><span class="lineno">  723</span>                    {</div>
<div class="line"><span class="lineno">  724</span>                        added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  725</span>                        <span class="keywordflow">return</span> guildsClient.GetGuildAsync(</div>
<div class="line"><span class="lineno">  726</span>                            localGuildId,</div>
<div class="line"><span class="lineno">  727</span>                            <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  728</span>                            cancellationToken);</div>
<div class="line"><span class="lineno">  729</span>                    });</div>
<div class="line"><span class="lineno">  730</span>                <span class="keywordflow">if</span> (!guildsResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  731</span>                {</div>
<div class="line"><span class="lineno">  732</span>                    <span class="keywordflow">if</span> (added)</div>
<div class="line"><span class="lineno">  733</span>                    {</div>
<div class="line"><span class="lineno">  734</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  735</span>                            <span class="stringliteral">&quot;Error retrieving discord guild {guildID}: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  736</span>                            guildId,</div>
<div class="line"><span class="lineno">  737</span>                            guildsResponse.LogFormat());</div>
<div class="line"><span class="lineno">  738</span>                        remapRequired = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  739</span>                    }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>                    <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  742</span>                }</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>                var connectionName = guildsResponse.Entity.Name;</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>                var channelModel = <span class="keyword">new</span> ChannelRepresentation(</div>
<div class="line"><span class="lineno">  747</span>                    guildsResponse.Entity.Name,</div>
<div class="line"><span class="lineno">  748</span>                    discordChannelResponse.Entity.Name.Value!,</div>
<div class="line"><span class="lineno">  749</span>                    channelId)</div>
<div class="line"><span class="lineno">  750</span>                {</div>
<div class="line"><span class="lineno">  751</span>                    IsAdminChannel = channelFromDB.IsAdminChannel == <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  752</span>                    IsPrivateChannel = <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  753</span>                    Tag = channelFromDB.Tag,</div>
<div class="line"><span class="lineno">  754</span>                    EmbedsSupported = <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  755</span>                };</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;Mapped channel {realId}: {friendlyName}&quot;</span>, channelModel.RealId, channelModel.FriendlyName);</div>
<div class="line"><span class="lineno">  758</span>                <span class="keywordflow">return</span> Tuple.Create&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;(</div>
<div class="line"><span class="lineno">  759</span>                    channelFromDB,</div>
<div class="line"><span class="lineno">  760</span>                    <span class="keyword">new</span> List&lt;ChannelRepresentation&gt; { channelModel });</div>
<div class="line"><span class="lineno">  761</span>            }</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>            var tasks = channels</div>
<div class="line"><span class="lineno">  764</span>                .Where(x =&gt; x.DiscordChannelId != 0)</div>
<div class="line"><span class="lineno">  765</span>                .Select(GetModelChannelFromDBChannel);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>            var channelTuples = await <a class="code hl_class" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html">ValueTaskExtensions</a>.<a class="code hl_function" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3">WhenAll</a>(tasks.ToList());</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>            var list = channelTuples</div>
<div class="line"><span class="lineno">  770</span>                .Where(x =&gt; x != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  771</span>                .Cast&lt;Tuple&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;&gt;() <span class="comment">// NRT my beloathed</span></div>
<div class="line"><span class="lineno">  772</span>                .ToList();</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>            var channelIdZeroModel = channels.FirstOrDefault(x =&gt; x.DiscordChannelId == 0);</div>
<div class="line"><span class="lineno">  775</span>            <span class="keywordflow">if</span> (channelIdZeroModel != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  776</span>            {</div>
<div class="line"><span class="lineno">  777</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogInformation(<span class="stringliteral">&quot;Mapping ALL additional accessible text channels&quot;</span>);</div>
<div class="line"><span class="lineno">  778</span>                var allAccessibleChannels = await <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498">GetAllAccessibleTextChannels</a>(cancellationToken);</div>
<div class="line"><span class="lineno">  779</span>                var unmappedTextChannels = allAccessibleChannels</div>
<div class="line"><span class="lineno">  780</span>                    .Where(x =&gt; !tasks.Any(task =&gt; task.Result != <span class="keyword">null</span> &amp;&amp; <span class="keyword">new</span> Snowflake(task.Result.Item1.DiscordChannelId!.Value) == x.ID));</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>                async ValueTask&lt;Tuple&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;&gt; CreateMappingsForUnmappedChannels()</div>
<div class="line"><span class="lineno">  783</span>                {</div>
<div class="line"><span class="lineno">  784</span>                    var unmappedTasks =</div>
<div class="line"><span class="lineno">  785</span>                        unmappedTextChannels.Select(</div>
<div class="line"><span class="lineno">  786</span>                            async unmappedTextChannel =&gt;</div>
<div class="line"><span class="lineno">  787</span>                            {</div>
<div class="line"><span class="lineno">  788</span>                                var fakeChannelModel = <span class="keyword">new</span> Models.ChatChannel</div>
<div class="line"><span class="lineno">  789</span>                                {</div>
<div class="line"><span class="lineno">  790</span>                                    DiscordChannelId = unmappedTextChannel.ID.Value,</div>
<div class="line"><span class="lineno">  791</span>                                    IsAdminChannel = channelIdZeroModel.IsAdminChannel,</div>
<div class="line"><span class="lineno">  792</span>                                    Tag = channelIdZeroModel.Tag,</div>
<div class="line"><span class="lineno">  793</span>                                };</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>                                var tuple = await GetModelChannelFromDBChannel(fakeChannelModel);</div>
<div class="line"><span class="lineno">  796</span>                                <span class="keywordflow">return</span> tuple?.Item2.First();</div>
<div class="line"><span class="lineno">  797</span>                            })</div>
<div class="line"><span class="lineno">  798</span>                        .ToList();</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>                    <span class="comment">// Add catch-all channel</span></div>
<div class="line"><span class="lineno">  801</span>                    unmappedTasks.Add(Task.FromResult&lt;ChannelRepresentation?&gt;(</div>
<div class="line"><span class="lineno">  802</span>                        <span class="keyword">new</span> ChannelRepresentation(</div>
<div class="line"><span class="lineno">  803</span>                            <span class="stringliteral">&quot;(Unknown Discord Guilds)&quot;</span>,</div>
<div class="line"><span class="lineno">  804</span>                            <span class="stringliteral">&quot;(Unknown Discord Channels)&quot;</span>,</div>
<div class="line"><span class="lineno">  805</span>                            0)</div>
<div class="line"><span class="lineno">  806</span>                        {</div>
<div class="line"><span class="lineno">  807</span>                            IsAdminChannel = channelIdZeroModel.IsAdminChannel!.Value,</div>
<div class="line"><span class="lineno">  808</span>                            EmbedsSupported = <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  809</span>                            Tag = channelIdZeroModel.Tag,</div>
<div class="line"><span class="lineno">  810</span>                        }));</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>                    await Task.WhenAll(unmappedTasks);</div>
<div class="line"><span class="lineno">  813</span>                    <span class="keywordflow">return</span> Tuple.Create&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;(</div>
<div class="line"><span class="lineno">  814</span>                        channelIdZeroModel,</div>
<div class="line"><span class="lineno">  815</span>                        unmappedTasks</div>
<div class="line"><span class="lineno">  816</span>                            .Select(x =&gt; x.Result)</div>
<div class="line"><span class="lineno">  817</span>                            .Where(x =&gt; x != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  818</span>                            .Cast&lt;ChannelRepresentation&gt;() <span class="comment">// NRT my beloathed</span></div>
<div class="line"><span class="lineno">  819</span>                            .ToList());</div>
<div class="line"><span class="lineno">  820</span>                }</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>                var task = CreateMappingsForUnmappedChannels();</div>
<div class="line"><span class="lineno">  823</span>                var tuple = await task;</div>
<div class="line"><span class="lineno">  824</span>                list.Add(tuple);</div>
<div class="line"><span class="lineno">  825</span>            }</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>            lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>)</div>
<div class="line"><span class="lineno">  828</span>            {</div>
<div class="line"><span class="lineno">  829</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.Clear();</div>
<div class="line"><span class="lineno">  830</span>                <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.AddRange(list.SelectMany(x =&gt; x.Item2).Select(x =&gt; x.RealId));</div>
<div class="line"><span class="lineno">  831</span>            }</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>            <span class="keywordflow">if</span> (remapRequired)</div>
<div class="line"><span class="lineno">  834</span>            {</div>
<div class="line"><span class="lineno">  835</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(<span class="stringliteral">&quot;Some channels failed to load with unknown errors. We will request that these be remapped, but it may result in communication spam. Please check prior logs and report an issue if this occurs.&quot;</span>);</div>
<div class="line"><span class="lineno">  836</span>                <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe">EnqueueMessage</a>(<span class="keyword">null</span>);</div>
<div class="line"><span class="lineno">  837</span>            }</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>            <span class="keywordflow">return</span> <span class="keyword">new</span> Dictionary&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;(list.Select(x =&gt; <span class="keyword">new</span> KeyValuePair&lt;Models.ChatChannel, IEnumerable&lt;ChannelRepresentation&gt;&gt;(x.Item1, x.Item2)));</div>
<div class="line"><span class="lineno">  840</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_ab92d4920074cec3e48fa204af595a498"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels</a></div><div class="ttdeci">async ValueTask&lt; IEnumerable&lt; IChannel &gt; &gt; GetAllAccessibleTextChannels(CancellationToken cancellationToken)</div><div class="ttdoc">Get all text IChannels accessible to and supported by the bot.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00847">DiscordProvider.cs:847</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider_html_a6a6dd225ccb27e30c2cc06562b035ebe"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe">Tgstation.Server.Host.Components.Chat.Providers.Provider.EnqueueMessage</a></div><div class="ttdeci">void EnqueueMessage(Message? message)</div><div class="ttdoc">Queues a message  for NextMessage(CancellationToken).</div><div class="ttdef"><b>Definition</b> <a href="_provider_8cs_source.html#l00239">Provider.cs:239</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_provider_8cs_source.html#l00239">Tgstation.Server.Host.Components.Chat.Providers.Provider.EnqueueMessage()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00847">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels()</a>, <a class="el" href="_chat_channel_base_8cs_source.html#l00015">Tgstation.Server.Api.Models.Internal.ChatChannelBase.IsAdminChannel</a>, <a class="el" href="_channel_representation_8cs_source.html#l00043">Tgstation.Server.Host.Components.Chat.ChannelRepresentation.IsAdminChannel</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, <a class="el" href="_discord_provider_8cs_source.html#l00088">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</a>, <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>, <a class="el" href="_discord_provider_8cs_source.html#l00062">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SupportedGuildChannelTypes</a>, <a class="el" href="_channel_representation_8cs_source.html#l00053">Tgstation.Server.Host.Components.Chat.ChannelRepresentation.Tag</a>, and <a class="el" href="_value_task_extensions_8cs_source.html#l00099">Tgstation.Server.Common.Extensions.ValueTaskExtensions.WhenAll()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a48adcd32348dbab4150bd2c8087623e0_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a48adcd32348dbab4150bd2c8087623e0_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a48adcd32348dbab4150bd2c8087623e0_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a48adcd32348dbab4150bd2c8087623e0_cgraph">
<area shape="rect" title=" " alt="" coords="5,77,314,118"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe" title="Queues a message &#160;for NextMessage(CancellationToken)." alt="" coords="362,5,625,46"/>
<area shape="poly" title=" " alt="" coords="256,74,380,47,382,52,258,79"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498" title="Get all text IChannels accessible to and supported by the bot." alt="" coords="373,70,614,126"/>
<area shape="poly" title=" " alt="" coords="314,95,357,95,357,100,314,100"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3" title="Fully await a given list of tasks ." alt="" coords="673,103,888,159"/>
<area shape="poly" title=" " alt="" coords="247,116,362,135,436,140,493,140,625,135,658,134,658,139,625,140,493,146,435,146,361,140,246,121"/>
<area shape="poly" title=" " alt="" coords="614,109,658,114,657,119,614,114"/>
</map>
</div>

</div>
</div>
<a id="a3cf5b9ba9079d6c9f582f61b5894f7c1" name="a3cf5b9ba9079d6c9f582f61b5894f7c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cf5b9ba9079d6c9f582f61b5894f7c1">&#9670;&#160;</a></span>NormalizeMentions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static string Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.NormalizeMentions </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>fromDiscord</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Normalize a discord mention string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fromDiscord</td><td>The mention string provided by the Discord library.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The normalized mention string.</dd></dl>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00483">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3cf5b9ba9079d6c9f582f61b5894f7c1_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3cf5b9ba9079d6c9f582f61b5894f7c1_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3cf5b9ba9079d6c9f582f61b5894f7c1_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a3cf5b9ba9079d6c9f582f61b5894f7c1_icgraph">
<area shape="rect" title="Normalize a discord mention string." alt="" coords="345,5,607,61"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a8d7bbc5ddb64df2800554c354ff1974a" title=" " alt="" coords="5,13,297,54"/>
<area shape="poly" title=" " alt="" coords="329,36,297,36,297,31,329,31"/>
</map>
</div>

</div>
</div>
<a id="a8d7bbc5ddb64df2800554c354ff1974a" name="a8d7bbc5ddb64df2800554c354ff1974a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7bbc5ddb64df2800554c354ff1974a">&#9670;&#160;</a></span>RespondAsync() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task&lt; Result &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync </td>
          <td>(</td>
          <td class="paramtype">IMessageCreate&#160;</td>
          <td class="paramname"><em>messageCreateEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00483">483</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  484</span>        {</div>
<div class="line"><span class="lineno">  485</span>            ArgumentNullException.ThrowIfNull(messageCreateEvent);</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>            <span class="keywordflow">if</span> ((messageCreateEvent.Type != MessageType.Default</div>
<div class="line"><span class="lineno">  488</span>                &amp;&amp; messageCreateEvent.Type != MessageType.InlineReply)</div>
<div class="line"><span class="lineno">  489</span>                || messageCreateEvent.Author.ID == <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a38455db633742e90572b9a83aa681831">currentUserId</a>)</div>
<div class="line"><span class="lineno">  490</span>                <span class="keywordflow">return</span> Result.FromSuccess();</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>            var messageReference = <span class="keyword">new</span> MessageReference</div>
<div class="line"><span class="lineno">  493</span>            {</div>
<div class="line"><span class="lineno">  494</span>                ChannelID = messageCreateEvent.ChannelID,</div>
<div class="line"><span class="lineno">  495</span>                GuildID = messageCreateEvent.GuildID,</div>
<div class="line"><span class="lineno">  496</span>                MessageID = messageCreateEvent.ID,</div>
<div class="line"><span class="lineno">  497</span>                FailIfNotExists = <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  498</span>            };</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>            var channelsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestChannelAPI&gt;();</div>
<div class="line"><span class="lineno">  501</span>            var channelResponse = await channelsClient.GetChannelAsync(messageCreateEvent.ChannelID, cancellationToken);</div>
<div class="line"><span class="lineno">  502</span>            <span class="keywordflow">if</span> (!channelResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  503</span>            {</div>
<div class="line"><span class="lineno">  504</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  505</span>                    <span class="stringliteral">&quot;Failed to get channel {channelId} in response to message {messageId}!&quot;</span>,</div>
<div class="line"><span class="lineno">  506</span>                    messageCreateEvent.ChannelID,</div>
<div class="line"><span class="lineno">  507</span>                    messageCreateEvent.ID);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>                <span class="comment">// we&#39;ll handle the errors ourselves</span></div>
<div class="line"><span class="lineno">  510</span>                <span class="keywordflow">return</span> Result.FromSuccess();</div>
<div class="line"><span class="lineno">  511</span>            }</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>            var pm = channelResponse.Entity.Type == ChannelType.DM || channelResponse.Entity.Type == ChannelType.GroupDM;</div>
<div class="line"><span class="lineno">  514</span>            var shouldNotAnswer = !pm;</div>
<div class="line"><span class="lineno">  515</span>            <span class="keywordflow">if</span> (shouldNotAnswer)</div>
<div class="line"><span class="lineno">  516</span>                lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>)</div>
<div class="line"><span class="lineno">  517</span>                    shouldNotAnswer = !<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.Contains(messageCreateEvent.ChannelID.Value) &amp;&amp; !<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.Contains(0);</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>            var content = <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">NormalizeMentions</a>(messageCreateEvent.Content);</div>
<div class="line"><span class="lineno">  520</span>            var mentionedUs = messageCreateEvent.Mentions.Any(x =&gt; x.ID == <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a38455db633742e90572b9a83aa681831">currentUserId</a>)</div>
<div class="line"><span class="lineno">  521</span>                || (!shouldNotAnswer &amp;&amp; content.Split(<span class="charliteral">&#39; &#39;</span>).First().Equals(ChatManager.CommonMention, StringComparison.OrdinalIgnoreCase));</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">if</span> (shouldNotAnswer)</div>
<div class="line"><span class="lineno">  524</span>            {</div>
<div class="line"><span class="lineno">  525</span>                <span class="keywordflow">if</span> (mentionedUs)</div>
<div class="line"><span class="lineno">  526</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(</div>
<div class="line"><span class="lineno">  527</span>                        <span class="stringliteral">&quot;Ignoring mention from {channelId} ({channelName}) by {authorId} ({authorName}). Channel not mapped!&quot;</span>,</div>
<div class="line"><span class="lineno">  528</span>                        messageCreateEvent.ChannelID,</div>
<div class="line"><span class="lineno">  529</span>                        channelResponse.Entity.Name,</div>
<div class="line"><span class="lineno">  530</span>                        messageCreateEvent.Author.ID,</div>
<div class="line"><span class="lineno">  531</span>                        messageCreateEvent.Author.Username);</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>                <span class="keywordflow">return</span> Result.FromSuccess();</div>
<div class="line"><span class="lineno">  534</span>            }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>            <span class="keywordtype">string</span> guildName = <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div>
<div class="line"><span class="lineno">  537</span>            <span class="keywordflow">if</span> (!pm)</div>
<div class="line"><span class="lineno">  538</span>            {</div>
<div class="line"><span class="lineno">  539</span>                var guildsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestGuildAPI&gt;();</div>
<div class="line"><span class="lineno">  540</span>                var messageGuildResponse = await guildsClient.GetGuildAsync(messageCreateEvent.GuildID.Value, <span class="keyword">false</span>, cancellationToken);</div>
<div class="line"><span class="lineno">  541</span>                <span class="keywordflow">if</span> (messageGuildResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  542</span>                    guildName = messageGuildResponse.Entity.Name;</div>
<div class="line"><span class="lineno">  543</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  544</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  545</span>                        <span class="stringliteral">&quot;Failed to get channel {channelID} in response to message {messageID}: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  546</span>                        messageCreateEvent.ChannelID,</div>
<div class="line"><span class="lineno">  547</span>                        messageCreateEvent.ID,</div>
<div class="line"><span class="lineno">  548</span>                        messageGuildResponse.LogFormat());</div>
<div class="line"><span class="lineno">  549</span>            }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>            var result = <span class="keyword">new</span> DiscordMessage(</div>
<div class="line"><span class="lineno">  552</span>                <span class="keyword">new</span> ChatUser(</div>
<div class="line"><span class="lineno">  553</span>                    <span class="keyword">new</span> ChannelRepresentation(</div>
<div class="line"><span class="lineno">  554</span>                        pm ? messageCreateEvent.Author.Username : guildName,</div>
<div class="line"><span class="lineno">  555</span>                        channelResponse.Entity.Name.Value!,</div>
<div class="line"><span class="lineno">  556</span>                        messageCreateEvent.ChannelID.Value)</div>
<div class="line"><span class="lineno">  557</span>                    {</div>
<div class="line"><span class="lineno">  558</span>                        IsPrivateChannel = pm,</div>
<div class="line"><span class="lineno">  559</span>                        EmbedsSupported = <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>                        <span class="comment">// isAdmin and Tag populated by manager</span></div>
<div class="line"><span class="lineno">  562</span>                    },</div>
<div class="line"><span class="lineno">  563</span>                    messageCreateEvent.Author.Username,</div>
<div class="line"><span class="lineno">  564</span>                    <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">NormalizeMentions</a>($<span class="stringliteral">&quot;&lt;@{messageCreateEvent.Author.ID}&gt;&quot;</span>),</div>
<div class="line"><span class="lineno">  565</span>                    messageCreateEvent.Author.ID.Value),</div>
<div class="line"><span class="lineno">  566</span>                content,</div>
<div class="line"><span class="lineno">  567</span>                messageReference);</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>            <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe">EnqueueMessage</a>(result);</div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">return</span> Result.FromSuccess();</div>
<div class="line"><span class="lineno">  571</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_a3cf5b9ba9079d6c9f582f61b5894f7c1"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.NormalizeMentions</a></div><div class="ttdeci">static string NormalizeMentions(string fromDiscord)</div><div class="ttdoc">Normalize a discord mention string.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_chat_manager_8cs_source.html#l00033">Tgstation.Server.Host.Components.Chat.ChatManager.CommonMention</a>, <a class="el" href="_discord_provider_8cs_source.html#l00123">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.currentUserId</a>, <a class="el" href="_provider_8cs_source.html#l00239">Tgstation.Server.Host.Components.Chat.Providers.Provider.EnqueueMessage()</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, <a class="el" href="_discord_provider_8cs_source.html#l00088">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.NormalizeMentions()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a8d7bbc5ddb64df2800554c354ff1974a_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a8d7bbc5ddb64df2800554c354ff1974a_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a8d7bbc5ddb64df2800554c354ff1974a_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a8d7bbc5ddb64df2800554c354ff1974a_cgraph">
<area shape="rect" title=" " alt="" coords="5,41,297,82"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe" title="Queues a message &#160;for NextMessage(CancellationToken)." alt="" coords="345,5,608,46"/>
<area shape="poly" title=" " alt="" coords="297,43,329,39,330,45,297,48"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1" title="Normalize a discord mention string." alt="" coords="345,70,608,126"/>
<area shape="poly" title=" " alt="" coords="297,75,330,79,329,84,297,80"/>
</map>
</div>

</div>
</div>
<a id="addfb0baffffb90712e76e9bfc1800a15" name="addfb0baffffb90712e76e9bfc1800a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addfb0baffffb90712e76e9bfc1800a15">&#9670;&#160;</a></span>RespondAsync() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Task&lt; Result &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync </td>
          <td>(</td>
          <td class="paramtype">IReady&#160;</td>
          <td class="paramname"><em>readyEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00574">574</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  575</span>        {</div>
<div class="line"><span class="lineno">  576</span>            ArgumentNullException.ThrowIfNull(readyEvent);</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>            <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;Gatway ready. Version: {version}&quot;</span>, readyEvent.Version);</div>
<div class="line"><span class="lineno">  579</span>            <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3f81033139026af1ea3160ef0063e737">gatewayReadyTcs</a>?.TrySetResult();</div>
<div class="line"><span class="lineno">  580</span>            <span class="keywordflow">return</span> Task.FromResult(Result.FromSuccess());</div>
<div class="line"><span class="lineno">  581</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00113">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayReadyTcs</a>, and <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>.</p>

</div>
</div>
<a id="a1494b2b91cc869199100c9338f91d864" name="a1494b2b91cc869199100c9338f91d864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1494b2b91cc869199100c9338f91d864">&#9670;&#160;</a></span>SendMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html">Message</a>?&#160;</td>
          <td class="paramname"><em>replyTo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html">MessageContent</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulong&#160;</td>
          <td class="paramname"><em>channelId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a message to the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a>.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">replyTo</td><td>The optional <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_message.html" title="Represents a message received by a IProvider.">Message</a> to reply to.</td></tr>
    <tr><td class="paramname">message</td><td>The MessageContent.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ValueTask representing the running operation.</dd></dl>
 </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#a59810a31bf8aa92d9eb31e619593a8bb">Tgstation.Server.Host.Components.Chat.Providers.IProvider</a>.</p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00198">198</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>        {</div>
<div class="line"><span class="lineno">  200</span>            ArgumentNullException.ThrowIfNull(message);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>            Optional&lt;IMessageReference&gt; replyToReference = <span class="keywordflow">default</span>;</div>
<div class="line"><span class="lineno">  203</span>            Optional&lt;IAllowedMentions&gt; allowedMentions = <span class="keywordflow">default</span>;</div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">if</span> (replyTo != <span class="keyword">null</span> &amp;&amp; replyTo is DiscordMessage discordMessage)</div>
<div class="line"><span class="lineno">  205</span>            {</div>
<div class="line"><span class="lineno">  206</span>                replyToReference = discordMessage.MessageReference;</div>
<div class="line"><span class="lineno">  207</span>                allowedMentions = <span class="keyword">new</span> AllowedMentions(</div>
<div class="line"><span class="lineno">  208</span>                    Parse: new <a class="code hl_enumvalue" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">List</a>&lt;MentionType&gt; <span class="comment">// reset settings back to how discord acts if this is not passed (which is different than the default if empty)</span></div>
<div class="line"><span class="lineno">  209</span>                    {</div>
<div class="line"><span class="lineno">  210</span>                        MentionType.Everyone,</div>
<div class="line"><span class="lineno">  211</span>                        MentionType.Roles,</div>
<div class="line"><span class="lineno">  212</span>                        MentionType.Users,</div>
<div class="line"><span class="lineno">  213</span>                    },</div>
<div class="line"><span class="lineno">  214</span>                    MentionRepliedUser: <span class="keyword">false</span>); <span class="comment">// disable reply mentions</span></div>
<div class="line"><span class="lineno">  215</span>            }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>            var embeds = <a class="code hl_function" href="_discord_provider_8cs.html#a6faaab8be32021a7d88c1d1ac62162c8">ConvertEmbed</a>(message.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html#a60f2aaeaf7f59e642e62b322bb1bce63">Embed</a>);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>            var channelsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestChannelAPI&gt;();</div>
<div class="line"><span class="lineno">  220</span>            async ValueTask SendToChannel(Snowflake channelId)</div>
<div class="line"><span class="lineno">  221</span>            {</div>
<div class="line"><span class="lineno">  222</span>                <span class="keywordflow">if</span> (message.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html#acc847c3c842120dede3072ddb6e0c0cd">Text</a> == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  223</span>                {</div>
<div class="line"><span class="lineno">  224</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  225</span>                        <span class="stringliteral">&quot;Failed to send to channel {channelId}: Message was null!&quot;</span>,</div>
<div class="line"><span class="lineno">  226</span>                        channelId);</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>                    await channelsClient.CreateMessageAsync(</div>
<div class="line"><span class="lineno">  229</span>                        channelId,</div>
<div class="line"><span class="lineno">  230</span>                        <span class="stringliteral">&quot;TGS: Could not send message to Discord. Message was `null`!&quot;</span>,</div>
<div class="line"><span class="lineno">  231</span>                        messageReference: replyToReference,</div>
<div class="line"><span class="lineno">  232</span>                        allowedMentions: allowedMentions,</div>
<div class="line"><span class="lineno">  233</span>                        ct: cancellationToken);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  236</span>                }</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>                var result = await channelsClient.CreateMessageAsync(</div>
<div class="line"><span class="lineno">  239</span>                    channelId,</div>
<div class="line"><span class="lineno">  240</span>                    message.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html#acc847c3c842120dede3072ddb6e0c0cd">Text</a>,</div>
<div class="line"><span class="lineno">  241</span>                    embeds: embeds,</div>
<div class="line"><span class="lineno">  242</span>                    messageReference: replyToReference,</div>
<div class="line"><span class="lineno">  243</span>                    allowedMentions: allowedMentions,</div>
<div class="line"><span class="lineno">  244</span>                    ct: cancellationToken);</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>                <span class="keywordflow">if</span> (!result.IsSuccess)</div>
<div class="line"><span class="lineno">  247</span>                {</div>
<div class="line"><span class="lineno">  248</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  249</span>                        <span class="stringliteral">&quot;Failed to send to channel {channelId}: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  250</span>                        channelId,</div>
<div class="line"><span class="lineno">  251</span>                        result.LogFormat());</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>                    <span class="keywordflow">if</span> (result.Error is RestResultError&lt;RestError&gt; restError &amp;&amp; restError.Error.Code == DiscordError.InvalidFormBody)</div>
<div class="line"><span class="lineno">  254</span>                        await channelsClient.CreateMessageAsync(</div>
<div class="line"><span class="lineno">  255</span>                            channelId,</div>
<div class="line"><span class="lineno">  256</span>                            <span class="stringliteral">&quot;TGS: Could not send message to Discord. Body was malformed or too long&quot;</span>,</div>
<div class="line"><span class="lineno">  257</span>                            messageReference: replyToReference,</div>
<div class="line"><span class="lineno">  258</span>                            allowedMentions: allowedMentions,</div>
<div class="line"><span class="lineno">  259</span>                            ct: cancellationToken);</div>
<div class="line"><span class="lineno">  260</span>                }</div>
<div class="line"><span class="lineno">  261</span>            }</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>            <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  264</span>            {</div>
<div class="line"><span class="lineno">  265</span>                <span class="keywordflow">if</span> (channelId == 0)</div>
<div class="line"><span class="lineno">  266</span>                {</div>
<div class="line"><span class="lineno">  267</span>                    IEnumerable&lt;IChannel&gt; unmappedTextChannels;</div>
<div class="line"><span class="lineno">  268</span>                    var allAccessibleTextChannels = await <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498">GetAllAccessibleTextChannels</a>(cancellationToken);</div>
<div class="line"><span class="lineno">  269</span>                    lock (<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>)</div>
<div class="line"><span class="lineno">  270</span>                    {</div>
<div class="line"><span class="lineno">  271</span>                        unmappedTextChannels = allAccessibleTextChannels</div>
<div class="line"><span class="lineno">  272</span>                            .Where(x =&gt; !<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.Contains(x.ID.Value))</div>
<div class="line"><span class="lineno">  273</span>                            .ToList();</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>                        var remapRequired = unmappedTextChannels.Any()</div>
<div class="line"><span class="lineno">  276</span>                            || <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a044ae95d278a4ed4a6a02449e24e8146">mappedChannels</a>.Any(</div>
<div class="line"><span class="lineno">  277</span>                                mappedChannel =&gt; !allAccessibleTextChannels.Any(</div>
<div class="line"><span class="lineno">  278</span>                                    accessibleTextChannel =&gt; accessibleTextChannel.ID == <span class="keyword">new</span> Snowflake(mappedChannel)));</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>                        <span class="keywordflow">if</span> (remapRequired)</div>
<div class="line"><span class="lineno">  281</span>                            <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe">EnqueueMessage</a>(<span class="keyword">null</span>);</div>
<div class="line"><span class="lineno">  282</span>                    }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>                    <span class="comment">// discord API confirmed weak boned: https://stackoverflow.com/a/52462336</span></div>
<div class="line"><span class="lineno">  285</span>                    <span class="keywordflow">if</span> (unmappedTextChannels.Any())</div>
<div class="line"><span class="lineno">  286</span>                    {</div>
<div class="line"><span class="lineno">  287</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogDebug(<span class="stringliteral">&quot;Dispatching to {count} unmapped channels...&quot;</span>, unmappedTextChannels.Count());</div>
<div class="line"><span class="lineno">  288</span>                        await <a class="code hl_class" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html">ValueTaskExtensions</a>.<a class="code hl_function" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3">WhenAll</a>(</div>
<div class="line"><span class="lineno">  289</span>                            unmappedTextChannels.Select(</div>
<div class="line"><span class="lineno">  290</span>                                x =&gt; SendToChannel(x.ID)));</div>
<div class="line"><span class="lineno">  291</span>                    }</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  294</span>                }</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>                await SendToChannel(<span class="keyword">new</span> Snowflake(channelId));</div>
<div class="line"><span class="lineno">  297</span>            }</div>
<div class="line"><span class="lineno">  298</span>            <span class="keywordflow">catch</span> (<a class="code hl_class" href="class_exception.html">Exception</a> e) when (e is not OperationCanceledException)</div>
<div class="line"><span class="lineno">  299</span>            {</div>
<div class="line"><span class="lineno">  300</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(e, <span class="stringliteral">&quot;Error sending discord message!&quot;</span>);</div>
<div class="line"><span class="lineno">  301</span>            }</div>
<div class="line"><span class="lineno">  302</span>        }</div>
<div class="ttc" id="a_discord_provider_8cs_html_a6faaab8be32021a7d88c1d1ac62162c8"><div class="ttname"><a href="_discord_provider_8cs.html#a6faaab8be32021a7d88c1d1ac62162c8">ConvertEmbed</a></div><div class="ttdeci">Optional&lt; IReadOnlyList&lt; IEmbed &gt; &gt; ConvertEmbed(ChatEmbed? embed)</div><div class="ttdoc">Convert a ChatEmbed to an IEmbed parameters.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l01020">DiscordProvider.cs:1020</a></div></div>
<div class="ttc" id="aclass_exception_html"><div class="ttname"><a href="class_exception.html">Exception</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content_html_a60f2aaeaf7f59e642e62b322bb1bce63"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html#a60f2aaeaf7f59e642e62b322bb1bce63">Tgstation.Server.Host.Components.Interop.MessageContent.Embed</a></div><div class="ttdeci">ChatEmbed? Embed</div><div class="ttdoc">The ChatEmbed.</div><div class="ttdef"><b>Definition</b> <a href="_message_content_8cs_source.html#l00016">MessageContent.cs:16</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content_html_acc847c3c842120dede3072ddb6e0c0cd"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_interop_1_1_message_content.html#acc847c3c842120dede3072ddb6e0c0cd">Tgstation.Server.Host.Components.Interop.MessageContent.Text</a></div><div class="ttdeci">string? Text</div><div class="ttdoc">The message string.</div><div class="ttdef"><b>Definition</b> <a href="_message_content_8cs_source.html#l00011">MessageContent.cs:11</a></div></div>
<div class="ttc" id="anamespace_tgstation_1_1_server_1_1_api_1_1_rights_html_a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135"><div class="ttname"><a href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">Tgstation.Server.Api.Rights.ConfigurationRights.List</a></div><div class="ttdeci">@ List</div><div class="ttdoc">User may list files if the Models.Instance allows it.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l01020">ConvertEmbed()</a>, <a class="el" href="_message_content_8cs_source.html#l00016">Tgstation.Server.Host.Components.Interop.MessageContent.Embed</a>, <a class="el" href="_provider_8cs_source.html#l00239">Tgstation.Server.Host.Components.Chat.Providers.Provider.EnqueueMessage()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00847">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels()</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, <a class="el" href="_discord_provider_8cs_source.html#l00088">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</a>, <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>, <a class="el" href="_message_content_8cs_source.html#l00011">Tgstation.Server.Host.Components.Interop.MessageContent.Text</a>, and <a class="el" href="_value_task_extensions_8cs_source.html#l00099">Tgstation.Server.Common.Extensions.ValueTaskExtensions.WhenAll()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a1494b2b91cc869199100c9338f91d864_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a1494b2b91cc869199100c9338f91d864_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a1494b2b91cc869199100c9338f91d864_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a1494b2b91cc869199100c9338f91d864_cgraph">
<area shape="rect" title="Send a message to the IProvider.A ValueTask representing the running operation." alt="" coords="5,84,240,139"/>
<area shape="rect" href="_discord_provider_8cs.html#a6faaab8be32021a7d88c1d1ac62162c8" title="Convert a ChatEmbed to an IEmbed parameters." alt="" coords="366,5,473,31"/>
<area shape="poly" title=" " alt="" coords="183,81,287,41,351,26,352,31,288,46,185,85"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a6a6dd225ccb27e30c2cc06562b035ebe" title="Queues a message &#160;for NextMessage(CancellationToken)." alt="" coords="288,55,551,96"/>
<area shape="poly" title=" " alt="" coords="240,95,272,91,272,96,240,100"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ab92d4920074cec3e48fa204af595a498" title="Get all text IChannels accessible to and supported by the bot." alt="" coords="299,120,540,175"/>
<area shape="poly" title=" " alt="" coords="240,123,284,128,283,134,240,128"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_common_1_1_extensions_1_1_value_task_extensions.html#a58adbd94d764754bd3e6c566a5fe7fe3" title="Fully await a given list of tasks ." alt="" coords="599,153,814,209"/>
<area shape="poly" title=" " alt="" coords="172,137,226,164,288,185,364,197,441,201,516,200,583,195,584,200,516,205,441,206,363,202,287,190,224,169,169,142"/>
<area shape="poly" title=" " alt="" coords="540,159,584,164,583,169,540,164"/>
</map>
</div>

</div>
</div>
<a id="a6b14b94a01f2a1478f1ade14ef9a7471" name="a6b14b94a01f2a1478f1ade14ef9a7471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b14b94a01f2a1478f1ade14ef9a7471">&#9670;&#160;</a></span>SendUpdateMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">override async ValueTask&lt; Func&lt; string?, string, ValueTask&lt; Func&lt; bool, ValueTask &gt; &gt; &gt; &gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models::RevisionInformation</a>&#160;</td>
          <td class="paramname"><em>revisionInformation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_models_1_1_revision_information.html">Models::RevisionInformation</a>?&#160;</td>
          <td class="paramname"><em>previousRevisionInformation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html">EngineVersion</a>&#160;</td>
          <td class="paramname"><em>engineVersion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DateTimeOffset?&#160;</td>
          <td class="paramname"><em>estimatedCompletionTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string?&#160;</td>
          <td class="paramname"><em>gitHubOwner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string?&#160;</td>
          <td class="paramname"><em>gitHubRepo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ulong&#160;</td>
          <td class="paramname"><em>channelId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>localCommitPushed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CancellationToken&#160;</td>
          <td class="paramname"><em>cancellationToken</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the message for a deployment.<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">revisionInformation</td><td>The RevisionInformation of the deployment.</td></tr>
    <tr><td class="paramname">previousRevisionInformation</td><td>The RevisionInformation of the previous deployment if any.</td></tr>
    <tr><td class="paramname">engineVersion</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html" title="Information about an engine installation.">Api.Models.EngineVersion</a> of the deployment.</td></tr>
    <tr><td class="paramname">estimatedCompletionTime</td><td>The optional DateTimeOffset the deployment is expected to be completed at.</td></tr>
    <tr><td class="paramname">gitHubOwner</td><td>The repository GitHub owner, if any.</td></tr>
    <tr><td class="paramname">gitHubRepo</td><td>The repository GitHub name, if any.</td></tr>
    <tr><td class="paramname">channelId</td><td>The <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_channel_representation.html#a983af752bfee4125d2a94370dc128c48" title="The Providers.IProvider channel Id.">ChannelRepresentation.RealId</a> to send to.</td></tr>
    <tr><td class="paramname">localCommitPushed</td><td><code>true</code> if the local deployment commit was pushed to the remote repository.</td></tr>
    <tr><td class="paramname">cancellationToken</td><td>The CancellationToken for the operation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ValueTask&lt;TResult&gt; resulting in a Func&lt;T1, T2, TResult&gt; to call to update the message at the deployment's conclusion. Parameters: Error message if any, DreamMaker output if any. Returns another callback which should be called to mark the deployment as active.</dd></dl>
 </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#a30727f02429224226c107a9ce9ad504e">Tgstation.Server.Host.Components.Chat.Providers.IProvider</a>.</p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00305">305</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>        {</div>
<div class="line"><span class="lineno">  316</span>            ArgumentNullException.ThrowIfNull(revisionInformation);</div>
<div class="line"><span class="lineno">  317</span>            ArgumentNullException.ThrowIfNull(engineVersion);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>            localCommitPushed |= revisionInformation.CommitSha == revisionInformation.OriginCommitSha;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>            var fields = <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aa0b4853705d24be3e16314bf050f9e7c">BuildUpdateEmbedFields</a>(revisionInformation, previousRevisionInformation, engineVersion, gitHubOwner, gitHubRepo, localCommitPushed);</div>
<div class="line"><span class="lineno">  322</span>            Optional&lt;IEmbedAuthor&gt; author = <span class="keyword">new</span> EmbedAuthor(<a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a73f7fae07fc8d7efc90b6464dc2eca79">assemblyInformationProvider</a>.<a class="code hl_property" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html#ab2a2be82555afbf6ffb5b7ae3d90b7f0">VersionPrefix</a>)</div>
<div class="line"><span class="lineno">  323</span>            {</div>
<div class="line"><span class="lineno">  324</span>                Url = <span class="stringliteral">&quot;https://github.com/tgstation/tgstation-server&quot;</span>,</div>
<div class="line"><span class="lineno">  325</span>                IconUrl = <span class="stringliteral">&quot;https://cdn.discordapp.com/attachments/1114451486374637629/1151650846019432448/tgs.png&quot;</span>, <span class="comment">// 404&#39;s in browsers but works in Discord</span></div>
<div class="line"><span class="lineno">  326</span>            };</div>
<div class="line"><span class="lineno">  327</span>            var embed = <span class="keyword">new</span> Embed</div>
<div class="line"><span class="lineno">  328</span>            {</div>
<div class="line"><span class="lineno">  329</span>                Author = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a182447c000f64abfb2e30336a6b9718f">deploymentBranding</a> ? author : <span class="keywordflow">default</span>,</div>
<div class="line"><span class="lineno">  330</span>                Colour = Color.FromArgb(0xF1, 0xC4, 0x0F),</div>
<div class="line"><span class="lineno">  331</span>                Description = <span class="stringliteral">&quot;TGS has begun deploying active repository code to production.&quot;</span>,</div>
<div class="line"><span class="lineno">  332</span>                Fields = fields,</div>
<div class="line"><span class="lineno">  333</span>                Title = <span class="stringliteral">&quot;Code Deployment&quot;</span>,</div>
<div class="line"><span class="lineno">  334</span>                Footer = <span class="keyword">new</span> EmbedFooter(</div>
<div class="line"><span class="lineno">  335</span>                    $<span class="stringliteral">&quot;In progress...{(estimatedCompletionTime.HasValue ? &quot;</span> ETA<span class="stringliteral">&quot; : String.Empty)}&quot;</span>),</div>
<div class="line"><span class="lineno">  336</span>                Timestamp = estimatedCompletionTime ?? <span class="keywordflow">default</span>,</div>
<div class="line"><span class="lineno">  337</span>            };</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>            <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogTrace(<span class="stringliteral">&quot;Attempting to post deploy embed to channel {channelId}...&quot;</span>, channelId);</div>
<div class="line"><span class="lineno">  340</span>            var channelsClient = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ae7dd055bf64dcff2228ae66fdcff7e92">serviceProvider</a>.GetRequiredService&lt;IDiscordRestChannelAPI&gt;();</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>            var prefix = <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a838ad29e96221a58a71b29358c086c0c">GetEngineCompilerPrefix</a>(engineVersion.<a class="code hl_property" href="class_tgstation_1_1_server_1_1_api_1_1_models_1_1_engine_version.html#ae13db4c5dbd6b06c79d37ad9afd25af2">Engine</a>!.Value);</div>
<div class="line"><span class="lineno">  343</span>            var messageResponse = await channelsClient.CreateMessageAsync(</div>
<div class="line"><span class="lineno">  344</span>                <span class="keyword">new</span> Snowflake(channelId),</div>
<div class="line"><span class="lineno">  345</span>                $<span class="stringliteral">&quot;{prefix}: Deployment in progress...&quot;</span>,</div>
<div class="line"><span class="lineno">  346</span>                embeds: new <a class="code hl_enumvalue" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">List</a>&lt;IEmbed&gt; { embed },</div>
<div class="line"><span class="lineno">  347</span>                ct: cancellationToken);</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>            <span class="keywordflow">if</span> (!messageResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  350</span>                <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(<span class="stringliteral">&quot;Failed to post deploy embed to channel {channelId}: {result}&quot;</span>, channelId, messageResponse.LogFormat());</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>            <span class="keywordflow">return</span> async (errorMessage, dreamMakerOutput) =&gt;</div>
<div class="line"><span class="lineno">  353</span>            {</div>
<div class="line"><span class="lineno">  354</span>                var completionString = errorMessage == <span class="keyword">null</span> ? <span class="stringliteral">&quot;Pending&quot;</span> : <span class="stringliteral">&quot;Failed&quot;</span>;</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>                Embed CreateUpdatedEmbed(<span class="keywordtype">string</span> message, Color color) =&gt; <span class="keyword">new</span>()</div>
<div class="line"><span class="lineno">  357</span>                {</div>
<div class="line"><span class="lineno">  358</span>                    Author = embed.Author,</div>
<div class="line"><span class="lineno">  359</span>                    Colour = color,</div>
<div class="line"><span class="lineno">  360</span>                    Description = message,</div>
<div class="line"><span class="lineno">  361</span>                    Fields = fields,</div>
<div class="line"><span class="lineno">  362</span>                    Title = embed.Title,</div>
<div class="line"><span class="lineno">  363</span>                    Footer = <span class="keyword">new</span> EmbedFooter(</div>
<div class="line"><span class="lineno">  364</span>                        completionString),</div>
<div class="line"><span class="lineno">  365</span>                    Timestamp = DateTimeOffset.UtcNow,</div>
<div class="line"><span class="lineno">  366</span>                };</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>                <span class="keywordflow">if</span> (errorMessage == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  369</span>                    embed = CreateUpdatedEmbed(</div>
<div class="line"><span class="lineno">  370</span>                        <span class="stringliteral">&quot;The deployment completed successfully and will be available at the next server reboot.&quot;</span>,</div>
<div class="line"><span class="lineno">  371</span>                        Color.Blue);</div>
<div class="line"><span class="lineno">  372</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  373</span>                    embed = CreateUpdatedEmbed(</div>
<div class="line"><span class="lineno">  374</span>                        <span class="stringliteral">&quot;The deployment failed.&quot;</span>,</div>
<div class="line"><span class="lineno">  375</span>                        Color.Red);</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>                var showDMOutput = <a class="code hl_variable" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a96681c4d5a393d80bd2ff022eed95ee5">outputDisplayType</a> <span class="keywordflow">switch</span></div>
<div class="line"><span class="lineno">  378</span>                {</div>
<div class="line"><span class="lineno">  379</span>                    DiscordDMOutputDisplayType.Always =&gt; <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  380</span>                    DiscordDMOutputDisplayType.Never =&gt; <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  381</span>                    DiscordDMOutputDisplayType.OnError =&gt; errorMessage != <span class="keyword">null</span>,</div>
<div class="line"><span class="lineno">  382</span>                    _ =&gt; <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;Invalid DiscordDMOutputDisplayType: {outputDisplayType}&quot;</span>),</div>
<div class="line"><span class="lineno">  383</span>                };</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>                <span class="keywordflow">if</span> (dreamMakerOutput != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  386</span>                {</div>
<div class="line"><span class="lineno">  387</span>                    <span class="comment">// https://github.com/discord-net/Discord.Net/blob/8349cd7e1eb92e9a3baff68082c30a7b43e8e9b7/src/Discord.Net.Core/Entities/Messages/EmbedBuilder.cs#L431</span></div>
<div class="line"><span class="lineno">  388</span>                    <span class="keyword">const</span> <span class="keywordtype">int</span> MaxFieldValueLength = 1024;</div>
<div class="line"><span class="lineno">  389</span>                    showDMOutput = showDMOutput &amp;&amp; dreamMakerOutput.Length &lt; MaxFieldValueLength - (6 + Environment.NewLine.Length);</div>
<div class="line"><span class="lineno">  390</span>                    <span class="keywordflow">if</span> (showDMOutput)</div>
<div class="line"><span class="lineno">  391</span>                        fields.Add(<span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  392</span>                            <span class="stringliteral">&quot;Compiler Output&quot;</span>,</div>
<div class="line"><span class="lineno">  393</span>                            $<span class="stringliteral">&quot;```{Environment.NewLine}{dreamMakerOutput}{Environment.NewLine}```&quot;</span>,</div>
<div class="line"><span class="lineno">  394</span>                            <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  395</span>                }</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>                <span class="keywordflow">if</span> (errorMessage != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  398</span>                    fields.Add(<span class="keyword">new</span> EmbedField(</div>
<div class="line"><span class="lineno">  399</span>                        <span class="stringliteral">&quot;Error Message&quot;</span>,</div>
<div class="line"><span class="lineno">  400</span>                        errorMessage,</div>
<div class="line"><span class="lineno">  401</span>                        <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>                var updatedMessageText = errorMessage == <span class="keyword">null</span> ? $<span class="stringliteral">&quot;{prefix}: Deployment pending reboot...&quot;</span> : $<span class="stringliteral">&quot;{prefix}: Deployment failed!&quot;</span>;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>                IMessage? updatedMessage = <span class="keyword">null</span>;</div>
<div class="line"><span class="lineno">  406</span>                async ValueTask CreateUpdatedMessage()</div>
<div class="line"><span class="lineno">  407</span>                {</div>
<div class="line"><span class="lineno">  408</span>                    var createUpdatedMessageResponse = await channelsClient.CreateMessageAsync(</div>
<div class="line"><span class="lineno">  409</span>                        <span class="keyword">new</span> Snowflake(channelId),</div>
<div class="line"><span class="lineno">  410</span>                        updatedMessageText,</div>
<div class="line"><span class="lineno">  411</span>                        embeds: new <a class="code hl_enumvalue" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">List</a>&lt;IEmbed&gt; { embed },</div>
<div class="line"><span class="lineno">  412</span>                        ct: cancellationToken);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>                    <span class="keywordflow">if</span> (!createUpdatedMessageResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  415</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  416</span>                            <span class="stringliteral">&quot;Creating updated deploy embed failed: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  417</span>                            createUpdatedMessageResponse.LogFormat());</div>
<div class="line"><span class="lineno">  418</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  419</span>                        updatedMessage = createUpdatedMessageResponse.Entity;</div>
<div class="line"><span class="lineno">  420</span>                }</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>                <span class="keywordflow">if</span> (!messageResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  423</span>                    await CreateUpdatedMessage();</div>
<div class="line"><span class="lineno">  424</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  425</span>                {</div>
<div class="line"><span class="lineno">  426</span>                    var editResponse = await channelsClient.EditMessageAsync(</div>
<div class="line"><span class="lineno">  427</span>                        <span class="keyword">new</span> Snowflake(channelId),</div>
<div class="line"><span class="lineno">  428</span>                        messageResponse.Entity.ID,</div>
<div class="line"><span class="lineno">  429</span>                        updatedMessageText,</div>
<div class="line"><span class="lineno">  430</span>                        embeds: new <a class="code hl_enumvalue" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">List</a>&lt;IEmbed&gt; { embed },</div>
<div class="line"><span class="lineno">  431</span>                        ct: cancellationToken);</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>                    <span class="keywordflow">if</span> (!editResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  434</span>                    {</div>
<div class="line"><span class="lineno">  435</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  436</span>                            <span class="stringliteral">&quot;Updating deploy embed {messageId} failed, attempting new post: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  437</span>                            messageResponse.Entity.ID,</div>
<div class="line"><span class="lineno">  438</span>                            editResponse.LogFormat());</div>
<div class="line"><span class="lineno">  439</span>                        await CreateUpdatedMessage();</div>
<div class="line"><span class="lineno">  440</span>                    }</div>
<div class="line"><span class="lineno">  441</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  442</span>                        updatedMessage = editResponse.Entity;</div>
<div class="line"><span class="lineno">  443</span>                }</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>                <span class="keywordflow">return</span> async (active) =&gt;</div>
<div class="line"><span class="lineno">  446</span>                {</div>
<div class="line"><span class="lineno">  447</span>                    <span class="keywordflow">if</span> (updatedMessage == <span class="keyword">null</span> || errorMessage != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  448</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>                    <span class="keywordflow">if</span> (active)</div>
<div class="line"><span class="lineno">  451</span>                    {</div>
<div class="line"><span class="lineno">  452</span>                        completionString = <span class="stringliteral">&quot;Succeeded&quot;</span>;</div>
<div class="line"><span class="lineno">  453</span>                        updatedMessageText = $<span class="stringliteral">&quot;{prefix}: Deployment succeeded!&quot;</span>;</div>
<div class="line"><span class="lineno">  454</span>                        embed = CreateUpdatedEmbed(</div>
<div class="line"><span class="lineno">  455</span>                            <span class="stringliteral">&quot;The deployment completed successfully and was applied to server.&quot;</span>,</div>
<div class="line"><span class="lineno">  456</span>                            Color.Green);</div>
<div class="line"><span class="lineno">  457</span>                    }</div>
<div class="line"><span class="lineno">  458</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  459</span>                    {</div>
<div class="line"><span class="lineno">  460</span>                        completionString = <span class="stringliteral">&quot;Inactive&quot;</span>;</div>
<div class="line"><span class="lineno">  461</span>                        embed = CreateUpdatedEmbed(</div>
<div class="line"><span class="lineno">  462</span>                            <span class="stringliteral">&quot;This deployment has been superceeded by a new one.&quot;</span>,</div>
<div class="line"><span class="lineno">  463</span>                            Color.Gray);</div>
<div class="line"><span class="lineno">  464</span>                    }</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>                    var editResponse = await channelsClient.EditMessageAsync(</div>
<div class="line"><span class="lineno">  467</span>                        <span class="keyword">new</span> Snowflake(channelId),</div>
<div class="line"><span class="lineno">  468</span>                        updatedMessage.ID,</div>
<div class="line"><span class="lineno">  469</span>                        updatedMessageText,</div>
<div class="line"><span class="lineno">  470</span>                        embeds: new <a class="code hl_enumvalue" href="namespace_tgstation_1_1_server_1_1_api_1_1_rights.html#a691a59767073bc7dff0f17b809d07b0ca4ee29ca12c7d126654bd0e5275de6135">List</a>&lt;IEmbed&gt; { embed },</div>
<div class="line"><span class="lineno">  471</span>                        ct: cancellationToken);</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>                    <span class="keywordflow">if</span> (!editResponse.IsSuccess)</div>
<div class="line"><span class="lineno">  474</span>                        <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#ab24337ff80dfef1a9657f7106758a8c3">Logger</a>.LogWarning(</div>
<div class="line"><span class="lineno">  475</span>                            <span class="stringliteral">&quot;Finalizing deploy embed {messageId} failed: {result}&quot;</span>,</div>
<div class="line"><span class="lineno">  476</span>                            messageResponse.Entity.ID,</div>
<div class="line"><span class="lineno">  477</span>                            editResponse.LogFormat());</div>
<div class="line"><span class="lineno">  478</span>                };</div>
<div class="line"><span class="lineno">  479</span>            };</div>
<div class="line"><span class="lineno">  480</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_aa0b4853705d24be3e16314bf050f9e7c"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aa0b4853705d24be3e16314bf050f9e7c">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.BuildUpdateEmbedFields</a></div><div class="ttdeci">List&lt; IEmbedField &gt; BuildUpdateEmbedFields(Models.RevisionInformation revisionInformation, Models.RevisionInformation? previousRevisionInformation, EngineVersion engineVersion, string? gitHubOwner, string? gitHubRepo, bool localCommitPushed)</div><div class="ttdoc">Create a List&lt;T&gt; of IEmbedFields for a discord update embed.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00911">DiscordProvider.cs:911</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider_html_a838ad29e96221a58a71b29358c086c0c"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a838ad29e96221a58a71b29358c086c0c">Tgstation.Server.Host.Components.Chat.Providers.Provider.GetEngineCompilerPrefix</a></div><div class="ttdeci">static string GetEngineCompilerPrefix(Api.Models.EngineType engineType)</div><div class="ttdoc">Get the prefix for messages about deployments.</div></div>
<div class="ttc" id="ainterface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider_html_ab2a2be82555afbf6ffb5b7ae3d90b7f0"><div class="ttname"><a href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html#ab2a2be82555afbf6ffb5b7ae3d90b7f0">Tgstation.Server.Host.System.IAssemblyInformationProvider.VersionPrefix</a></div><div class="ttdeci">string VersionPrefix</div><div class="ttdoc">Prefix to VersionString.</div><div class="ttdef"><b>Definition</b> <a href="_i_assembly_information_provider_8cs_source.html#l00025">IAssemblyInformationProvider.cs:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_discord_provider_8cs_source.html#l00073">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.assemblyInformationProvider</a>, <a class="el" href="_discord_provider_8cs_source.html#l00911">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.BuildUpdateEmbedFields()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00098">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.deploymentBranding</a>, <a class="el" href="_engine_version_8cs_source.html#l00024">Tgstation.Server.Api.Models.EngineVersion.Engine</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a838ad29e96221a58a71b29358c086c0c">Tgstation.Server.Host.Components.Chat.Providers.Provider.GetEngineCompilerPrefix()</a>, <a class="el" href="_provider_8cs_source.html#l00035">Tgstation.Server.Host.Components.Chat.Providers.Provider.Logger</a>, <a class="el" href="_discord_provider_8cs_source.html#l00103">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.outputDisplayType</a>, <a class="el" href="_discord_provider_8cs_source.html#l00083">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</a>, and <a class="el" href="_i_assembly_information_provider_8cs_source.html#l00025">Tgstation.Server.Host.System.IAssemblyInformationProvider.VersionPrefix</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a6b14b94a01f2a1478f1ade14ef9a7471_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a6b14b94a01f2a1478f1ade14ef9a7471_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a6b14b94a01f2a1478f1ade14ef9a7471_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_a6b14b94a01f2a1478f1ade14ef9a7471_cgraph">
<area shape="rect" title="Send the message for a deployment.A ValueTask&lt;TResult&gt; resulting in a Func&lt;T1, T2,..." alt="" coords="5,41,240,97"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#aa0b4853705d24be3e16314bf050f9e7c" title="Create a List&lt;T&gt; of IEmbedFields for a discord update embed." alt="" coords="323,5,556,61"/>
<area shape="poly" title=" " alt="" coords="240,53,307,45,308,51,240,59"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_provider.html#a838ad29e96221a58a71b29358c086c0c" title="Get the prefix for messages about deployments." alt="" coords="288,85,591,126"/>
<area shape="poly" title=" " alt="" coords="240,80,272,83,272,89,240,85"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a73f7fae07fc8d7efc90b6464dc2eca79" name="a73f7fae07fc8d7efc90b6464dc2eca79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73f7fae07fc8d7efc90b6464dc2eca79">&#9670;&#160;</a></span>assemblyInformationProvider</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_system_1_1_i_assembly_information_provider.html">IAssemblyInformationProvider</a> Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.assemblyInformationProvider</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The IAssemblyInformationProvider for the DiscordProvider. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00073">73</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00305">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage()</a>.</p>

</div>
</div>
<a id="a01881ab9506db0431f75db21224bf7e6" name="a01881ab9506db0431f75db21224bf7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01881ab9506db0431f75db21224bf7e6">&#9670;&#160;</a></span>connectDisconnectLock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly object Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.connectDisconnectLock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lock object used to sychronize connect/disconnect operations. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00093">93</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00644">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>.</p>

</div>
</div>
<a id="a38455db633742e90572b9a83aa681831" name="a38455db633742e90572b9a83aa681831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38455db633742e90572b9a83aa681831">&#9670;&#160;</a></span>currentUserId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Snowflake Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.currentUserId</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The bot's Snowflake. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00123">123</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00483">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync()</a>.</p>

</div>
</div>
<a id="a182447c000f64abfb2e30336a6b9718f" name="a182447c000f64abfb2e30336a6b9718f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182447c000f64abfb2e30336a6b9718f">&#9670;&#160;</a></span>deploymentBranding</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly bool Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.deploymentBranding</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If the tgstation-server logo is shown in deployment embeds. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00098">98</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00305">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage()</a>.</p>

</div>
</div>
<a id="a317ac4b2144b7b5d2764063b158c7f54" name="a317ac4b2144b7b5d2764063b158c7f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a317ac4b2144b7b5d2764063b158c7f54">&#9670;&#160;</a></span>disposing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.disposing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If serviceProvider is being disposed. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00128">128</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00175">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisposeAsync()</a>.</p>

</div>
</div>
<a id="a6551c929800df136bef095841ea8fd09" name="a6551c929800df136bef095841ea8fd09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6551c929800df136bef095841ea8fd09">&#9670;&#160;</a></span>false</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00988">988</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

</div>
</div>
<a id="aecdf08d03a7a5fad8b9ff607fbec8bb6" name="aecdf08d03a7a5fad8b9ff607fbec8bb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecdf08d03a7a5fad8b9ff607fbec8bb6">&#9670;&#160;</a></span>gatewayCts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CancellationTokenSource? Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayCts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The CancellationTokenSource for the gatewayTask. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00108">108</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00644">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00175">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisposeAsync()</a>.</p>

</div>
</div>
<a id="a3f81033139026af1ea3160ef0063e737" name="a3f81033139026af1ea3160ef0063e737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f81033139026af1ea3160ef0063e737">&#9670;&#160;</a></span>gatewayReadyTcs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TaskCompletionSource? Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayReadyTcs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The TaskCompletionSource for the initial gateway connection event. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00113">113</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00574">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync()</a>.</p>

</div>
</div>
<a id="a968f8dd1140ebe40a77c774fe7f9019b" name="a968f8dd1140ebe40a77c774fe7f9019b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968f8dd1140ebe40a77c774fe7f9019b">&#9670;&#160;</a></span>gatewayTask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Task&lt;Result&gt;? Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.gatewayTask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The Task representing the lifetime of the client. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00118">118</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00644">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisconnectImpl()</a>.</p>

</div>
</div>
<a id="ac93400b45eefb577306a70a7a530147f" name="ac93400b45eefb577306a70a7a530147f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac93400b45eefb577306a70a7a530147f">&#9670;&#160;</a></span>generalConfigurationOptions</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly IOptionsMonitor&lt;<a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_configuration_1_1_general_configuration.html">GeneralConfiguration</a>&gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.generalConfigurationOptions</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The GeneralConfiguration IOptionsMonitor&lt;TOptions&gt; for the DiscordProvider. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00078">78</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>.</p>

</div>
</div>
<a id="a044ae95d278a4ed4a6a02449e24e8146" name="a044ae95d278a4ed4a6a02449e24e8146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044ae95d278a4ed4a6a02449e24e8146">&#9670;&#160;</a></span>mappedChannels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly List&lt;ulong&gt; Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.mappedChannels</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List&lt;T&gt; of mapped channel Snowflakes. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00088">88</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00669">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.MapChannelsImpl()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00483">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00198">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendMessage()</a>.</p>

</div>
</div>
<a id="a96681c4d5a393d80bd2ff022eed95ee5" name="a96681c4d5a393d80bd2ff022eed95ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96681c4d5a393d80bd2ff022eed95ee5">&#9670;&#160;</a></span>outputDisplayType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#af16952d12561118ecebc3d8ccf510221">DiscordDMOutputDisplayType</a> Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.outputDisplayType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The <a class="el" href="namespace_tgstation_1_1_server_1_1_api_1_1_models.html#af16952d12561118ecebc3d8ccf510221" title="When the DM output section of Discord deployment embeds should be shown.">DiscordDMOutputDisplayType</a>. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00103">103</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00305">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage()</a>.</p>

</div>
</div>
<a id="ae7dd055bf64dcff2228ae66fdcff7e92" name="ae7dd055bf64dcff2228ae66fdcff7e92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7dd055bf64dcff2228ae66fdcff7e92">&#9670;&#160;</a></span>serviceProvider</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly ServiceProvider Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.serviceProvider</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The ServiceProvider containing Discord services. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00083">83</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00584">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connect()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00146">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DiscordProvider()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00175">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.DisposeAsync()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00847">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00669">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.MapChannelsImpl()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00483">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.RespondAsync()</a>, <a class="el" href="_discord_provider_8cs_source.html#l00198">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendMessage()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00305">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SendUpdateMessage()</a>.</p>

</div>
</div>
<a id="a1896b3a7ddd7b500c2624d3676b64eaf" name="a1896b3a7ddd7b500c2624d3676b64eaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1896b3a7ddd7b500c2624d3676b64eaf">&#9670;&#160;</a></span>SupportedGuildChannelTypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly ChannelType [] Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.SupportedGuildChannelTypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">        [</div>
<div class="line">            ChannelType.GuildText,</div>
<div class="line">            ChannelType.GuildAnnouncement,</div>
<div class="line">            ChannelType.PrivateThread,</div>
<div class="line">            ChannelType.PublicThread,</div>
<div class="line">        ]</div>
</div><!-- fragment -->
<p>The ChannelTypes supported by the DiscordProvider for mapping. </p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00062">62</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

<p class="reference">Referenced by <a class="el" href="_discord_provider_8cs_source.html#l00847">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.GetAllAccessibleTextChannels()</a>, and <a class="el" href="_discord_provider_8cs_source.html#l00669">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.MapChannelsImpl()</a>.</p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="af40c0ea392de9986a4705d403674f61c" name="af40c0ea392de9986a4705d403674f61c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af40c0ea392de9986a4705d403674f61c">&#9670;&#160;</a></span>BotMention</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override string Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.BotMention</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The string that indicates the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> was mentioned. </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#a781f872cb8143fe3ff92f3cc8d0d5abb">Tgstation.Server.Host.Components.Chat.Providers.IProvider</a>.</p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00049">49</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>        {</div>
<div class="line"><span class="lineno">   51</span>            <span class="keyword">get</span></div>
<div class="line"><span class="lineno">   52</span>            {</div>
<div class="line"><span class="lineno">   53</span>                <span class="keywordflow">if</span> (!<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac2744da20824177724b971eb20a6d5a0">Connected</a>)</div>
<div class="line"><span class="lineno">   54</span>                    <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="stringliteral">&quot;Provider not connected&quot;</span>);</div>
<div class="line"><span class="lineno">   55</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#a3cf5b9ba9079d6c9f582f61b5894f7c1">NormalizeMentions</a>($<span class="stringliteral">&quot;&lt;@{currentUserId}&gt;&quot;</span>);</div>
<div class="line"><span class="lineno">   56</span>            }</div>
<div class="line"><span class="lineno">   57</span>        }</div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider_html_ac2744da20824177724b971eb20a6d5a0"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_discord_provider.html#ac2744da20824177724b971eb20a6d5a0">Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connected</a></div><div class="ttdeci">override bool Connected</div><div class="ttdoc">If the IProvider is currently connected.</div><div class="ttdef"><b>Definition</b> <a href="_discord_provider_8cs_source.html#l00046">DiscordProvider.cs:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2744da20824177724b971eb20a6d5a0" name="ac2744da20824177724b971eb20a6d5a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2744da20824177724b971eb20a6d5a0">&#9670;&#160;</a></span>Connected</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override bool Tgstation.Server.Host.Components.Chat.Providers.DiscordProvider.Connected</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If the <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html" title="For interacting with a chat service.">IProvider</a> is currently connected. </p>

<p>Implements <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_components_1_1_chat_1_1_providers_1_1_i_provider.html#acc07a6bfb2fbb35243aa1e147d92dd87">Tgstation.Server.Host.Components.Chat.Providers.IProvider</a>.</p>

<p class="definition">Definition at line <a class="el" href="_discord_provider_8cs_source.html#l00046">46</a> of file <a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Tgstation.Server.Host/Components/Chat/Providers/<a class="el" href="_discord_provider_8cs_source.html">DiscordProvider.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
