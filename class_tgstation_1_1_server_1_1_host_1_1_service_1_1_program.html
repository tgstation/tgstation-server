<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tgstation-server: Tgstation.Server.Host.Service.Program Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tgstation-server
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="api.html"><span>API</span></a></li>
      <li><a href="architecture.html"><span>Architecture</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_tgstation.html">Tgstation</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server.html">Server</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host.html">Host</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_service.html">Service</a></li><li class="navelem"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html">Program</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Tgstation.Server.Host.Service.Program Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the entrypoint for the application  
 <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a86d24d735c64eb7c67a935b809927dd4"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a86d24d735c64eb7c67a935b809927dd4">OnExecuteAsync</a> ()</td></tr>
<tr class="memdesc:a86d24d735c64eb7c67a935b809927dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Command line handler, always runs  <a href="#a86d24d735c64eb7c67a935b809927dd4">More...</a><br /></td></tr>
<tr class="separator:a86d24d735c64eb7c67a935b809927dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a6868da29a3857b56bba33e5d7c623b68"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a><code> [get]</code></td></tr>
<tr class="memdesc:a6868da29a3857b56bba33e5d7c623b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;uninstall or -u option  <a href="#a6868da29a3857b56bba33e5d7c623b68">More...</a><br /></td></tr>
<tr class="separator:a6868da29a3857b56bba33e5d7c623b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3be244b24cbb3c9ba859f55e53715e6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ae3be244b24cbb3c9ba859f55e53715e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;install or -i option  <a href="#ae3be244b24cbb3c9ba859f55e53715e6">More...</a><br /></td></tr>
<tr class="separator:ae3be244b24cbb3c9ba859f55e53715e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba3eb445c2c2c0f8a11d150096b7457"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a><code> [get, set]</code></td></tr>
<tr class="memdesc:aaba3eb445c2c2c0f8a11d150096b7457"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;configure or -c option  <a href="#aaba3eb445c2c2c0f8a11d150096b7457">More...</a><br /></td></tr>
<tr class="separator:aaba3eb445c2c2c0f8a11d150096b7457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7201b8cfa09c341ec68d81297aabad"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5d7201b8cfa09c341ec68d81297aabad">Trace</a><code> [get, set]</code></td></tr>
<tr class="memdesc:a5d7201b8cfa09c341ec68d81297aabad"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;trace or -t option. Enables trace logs  <a href="#a5d7201b8cfa09c341ec68d81297aabad">More...</a><br /></td></tr>
<tr class="separator:a5d7201b8cfa09c341ec68d81297aabad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a938d576ceba93bf3cb1a32ae1dcccc52"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a938d576ceba93bf3cb1a32ae1dcccc52">Debug</a><code> [get, set]</code></td></tr>
<tr class="memdesc:a938d576ceba93bf3cb1a32ae1dcccc52"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;debug or -d option. Enables debug logs  <a href="#a938d576ceba93bf3cb1a32ae1dcccc52">More...</a><br /></td></tr>
<tr class="separator:a938d576ceba93bf3cb1a32ae1dcccc52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a5c942ce276ce92ca31ecbe9c88f2e982"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5c942ce276ce92ca31ecbe9c88f2e982">IsAdministrator</a> ()</td></tr>
<tr class="memdesc:a5c942ce276ce92ca31ecbe9c88f2e982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the running user is a system administrator  <a href="#a5c942ce276ce92ca31ecbe9c88f2e982">More...</a><br /></td></tr>
<tr class="separator:a5c942ce276ce92ca31ecbe9c88f2e982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626a9a4670edb87ce05328762d46cf8f"><td class="memItemLeft" align="right" valign="top">static Task&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a626a9a4670edb87ce05328762d46cf8f">Main</a> (string[] args)</td></tr>
<tr class="memdesc:a626a9a4670edb87ce05328762d46cf8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entrypoint for the application  <a href="#a626a9a4670edb87ce05328762d46cf8f">More...</a><br /></td></tr>
<tr class="separator:a626a9a4670edb87ce05328762d46cf8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a9d3a5224a3e18f775a58b31d57d2d68a"><td class="memItemLeft" align="right" valign="top">static readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory.html">IWatchdogFactory</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a9d3a5224a3e18f775a58b31d57d2d68a">watchdogFactory</a> = new <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory.html">WatchdogFactory</a>()</td></tr>
<tr class="separator:a9d3a5224a3e18f775a58b31d57d2d68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains the entrypoint for the application </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00021">21</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a5c942ce276ce92ca31ecbe9c88f2e982"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool Tgstation.Server.Host.Service.Program.IsAdministrator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the running user is a system administrator </p>
<dl class="section return"><dt>Returns</dt><dd>if the running user is a system administrator,  otherwise</dd></dl>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00059">59</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            var user = WindowsIdentity.GetCurrent();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            var principal = <span class="keyword">new</span> WindowsPrincipal(user);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">return</span> principal.IsInRole(WindowsBuiltInRole.Administrator);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a626a9a4670edb87ce05328762d46cf8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Task&lt;int&gt; Tgstation.Server.Host.Service.Program.Main </td>
          <td>(</td>
          <td class="paramtype">string[]&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entrypoint for the application </p>

</div>
</div>
<a class="anchor" id="a86d24d735c64eb7c67a935b809927dd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Service.Program.OnExecuteAsync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Command line handler, always runs </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00069">69</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

<p>References <a class="el" href="_server_service_8cs_source.html#l00023">Tgstation.Server.Host.Service.ServerService.Name</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">if</span> (Environment.UserInteractive)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a> &amp;&amp; !<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a> &amp;&amp; !<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a>)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    var result = MessageBox.Show(<span class="stringliteral">&quot;You are running the TGS windows service executable directly. It should only be run by the service control manager. Would you like to install and configure the service in this location?&quot;</span>, <span class="stringliteral">&quot;TGS Service&quot;</span>, MessageBoxButtons.YesNo);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    <span class="keywordflow">if</span> (result != DialogResult.Yes)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5c942ce276ce92ca31ecbe9c88f2e982">IsAdministrator</a>())</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    <span class="comment">//try to restart as admin</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    <span class="comment">//its windows, first arg is .exe name guaranteed</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    var exe = Environment.GetCommandLineArgs().First();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    var startInfo = <span class="keyword">new</span> ProcessStartInfo</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                        UseShellExecute = <span class="keyword">true</span>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                        Verb = <span class="stringliteral">&quot;runas&quot;</span>,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                        Arguments = String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;{0} {1}&quot;</span>, <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a> ? <span class="stringliteral">&quot;-i&quot;</span> : <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a> ? <span class="stringliteral">&quot;-u&quot;</span> : String.Empty, <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a> ? <span class="stringliteral">&quot;-c&quot;</span> : String.Empty),</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        FileName = exe,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                        WorkingDirectory = Environment.CurrentDirectory,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    };</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    <span class="keyword">using</span> (Process.Start(startInfo))</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keyword">using</span> (var loggerFactory = <span class="keyword">new</span> LoggerFactory())</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a>)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    await <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a9d3a5224a3e18f775a58b31d57d2d68a">watchdogFactory</a>.<a class="code" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory.html#a4610f9c60c131dab81a56aa23abdfbb8">CreateWatchdog</a>(loggerFactory).<a class="code" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog.html#abe13ec45a7d7ba7db422ea661156b697">RunAsync</a>(<span class="keyword">true</span>, Array.Empty&lt;<span class="keywordtype">string</span>&gt;(), <span class="keywordflow">default</span>).ConfigureAwait(<span class="keyword">false</span>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a>)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a>)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        <span class="comment">//oh no, it&#39;s retarded...</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    <span class="keyword">using</span> (var processInstaller = <span class="keyword">new</span> ServiceProcessInstaller())</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    <span class="keyword">using</span> (var installer = <span class="keyword">new</span> ServiceInstaller())</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                        processInstaller.Account = ServiceAccount.LocalSystem;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        installer.Context = <span class="keyword">new</span> InstallContext(<span class="stringliteral">&quot;tgs-4-install.log&quot;</span>, <span class="keyword">new</span> <span class="keywordtype">string</span>[] { String.Format(CultureInfo.InvariantCulture, <span class="stringliteral">&quot;/assemblypath={0}&quot;</span>, Assembly.GetEntryAssembly().Location) });</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        installer.Description = <span class="stringliteral">&quot;/tg/station 13 server v4 running as a windows service&quot;</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        installer.DisplayName = <span class="stringliteral">&quot;/tg/station server 4&quot;</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        installer.DelayedAutoStart = <span class="keyword">true</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        installer.StartType = ServiceStartMode.Automatic;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        installer.ServicesDependedOn = <span class="keyword">new</span> <span class="keywordtype">string</span>[] { <span class="stringliteral">&quot;Tcpip&quot;</span>, <span class="stringliteral">&quot;Dhcp&quot;</span>, <span class="stringliteral">&quot;Dnscache&quot;</span> };</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        installer.ServiceName = ServerService.Name;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        installer.Parent = processInstaller;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        var state = <span class="keyword">new</span> ListDictionary();</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                        installer.Install(state);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a>)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keyword">using</span> (var installer = <span class="keyword">new</span> ServiceInstaller())</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                        installer.Context = <span class="keyword">new</span> InstallContext(<span class="stringliteral">&quot;tgs-4-uninstall.log&quot;</span>, null);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        installer.ServiceName = ServerService.Name;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        installer.Uninstall(null);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a>)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <a class="code" href="class_service_base.html">ServiceBase</a>.Run(<span class="keyword">new</span> ServerService(<a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a9d3a5224a3e18f775a58b31d57d2d68a">watchdogFactory</a>, loggerFactory, <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5d7201b8cfa09c341ec68d81297aabad">Trace</a> ? LogLevel.Trace : <a class="code" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a938d576ceba93bf3cb1a32ae1dcccc52">Debug</a> ? LogLevel.Debug : LogLevel.Information));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="ttc" id="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory_html_a4610f9c60c131dab81a56aa23abdfbb8"><div class="ttname"><a href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory.html#a4610f9c60c131dab81a56aa23abdfbb8">Tgstation.Server.Host.Watchdog.IWatchdogFactory.CreateWatchdog</a></div><div class="ttdeci">IWatchdog CreateWatchdog(ILoggerFactory loggerFactory)</div><div class="ttdoc">Create a IWatchdog </div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a6868da29a3857b56bba33e5d7c623b68"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Tgstation.Server.Host.Service.Program.Uninstall</a></div><div class="ttdeci">bool Uninstall</div><div class="ttdoc">The –uninstall or -u option </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00027">Program.cs:27</a></div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a9d3a5224a3e18f775a58b31d57d2d68a"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a9d3a5224a3e18f775a58b31d57d2d68a">Tgstation.Server.Host.Service.Program.watchdogFactory</a></div><div class="ttdeci">static readonly IWatchdogFactory watchdogFactory</div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00053">Program.cs:53</a></div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a5c942ce276ce92ca31ecbe9c88f2e982"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5c942ce276ce92ca31ecbe9c88f2e982">Tgstation.Server.Host.Service.Program.IsAdministrator</a></div><div class="ttdeci">static bool IsAdministrator()</div><div class="ttdoc">Check if the running user is a system administrator </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00059">Program.cs:59</a></div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a938d576ceba93bf3cb1a32ae1dcccc52"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a938d576ceba93bf3cb1a32ae1dcccc52">Tgstation.Server.Host.Service.Program.Debug</a></div><div class="ttdeci">bool Debug</div><div class="ttdoc">The –debug or -d option. Enables debug logs </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00051">Program.cs:51</a></div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_aaba3eb445c2c2c0f8a11d150096b7457"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Tgstation.Server.Host.Service.Program.Configure</a></div><div class="ttdeci">bool Configure</div><div class="ttdoc">The –configure or -c option </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00039">Program.cs:39</a></div></div>
<div class="ttc" id="class_service_base_html"><div class="ttname"><a href="class_service_base.html">ServiceBase</a></div></div>
<div class="ttc" id="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_html_abe13ec45a7d7ba7db422ea661156b697"><div class="ttname"><a href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog.html#abe13ec45a7d7ba7db422ea661156b697">Tgstation.Server.Host.Watchdog.IWatchdog.RunAsync</a></div><div class="ttdeci">Task RunAsync(bool runConfigure, string[] args, CancellationToken cancellationToken)</div><div class="ttdoc">Run the IWatchdog </div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_ae3be244b24cbb3c9ba859f55e53715e6"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Tgstation.Server.Host.Service.Program.Install</a></div><div class="ttdeci">bool Install</div><div class="ttdoc">The –install or -i option </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00033">Program.cs:33</a></div></div>
<div class="ttc" id="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a5d7201b8cfa09c341ec68d81297aabad"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a5d7201b8cfa09c341ec68d81297aabad">Tgstation.Server.Host.Service.Program.Trace</a></div><div class="ttdeci">bool Trace</div><div class="ttdoc">The –trace or -t option. Enables trace logs </div><div class="ttdef"><b>Definition:</b> <a href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00045">Program.cs:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9d3a5224a3e18f775a58b31d57d2d68a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory.html">IWatchdogFactory</a> Tgstation.Server.Host.Service.Program.watchdogFactory = new <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory.html">WatchdogFactory</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00053">53</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a class="anchor" id="aaba3eb445c2c2c0f8a11d150096b7457"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Configure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;configure or -c option </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00039">39</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a938d576ceba93bf3cb1a32ae1dcccc52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Debug</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;debug or -d option. Enables debug logs </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00051">51</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<a class="anchor" id="ae3be244b24cbb3c9ba859f55e53715e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Install</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;install or -i option </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00033">33</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a5d7201b8cfa09c341ec68d81297aabad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Trace</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;trace or -t option. Enables trace logs </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00045">45</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<a class="anchor" id="a6868da29a3857b56bba33e5d7c623b68"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Uninstall</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;uninstall or -u option </p>

<p>Definition at line <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00027">27</a> of file <a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Tgstation.Server.Host.Service/<a class="el" href="src_2_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
