<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tgstation-server: Tgstation.Server.Host.Service.Program Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign">
   <div id="projectname">tgstation-server<span id="projectnumber">&#160;6.8.0</span>
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_tgstation.html">Tgstation</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server.html">Server</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host.html">Host</a></li><li class="navelem"><a class="el" href="namespace_tgstation_1_1_server_1_1_host_1_1_service.html">Service</a></li><li class="navelem"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html">Program</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Tgstation.Server.Host.Service.Program Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains the entrypoint for the application.   
 <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Tgstation.Server.Host.Service.Program:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program__coll__graph.png" border="0" usemap="#a_tgstation_8_server_8_host_8_service_8_program_coll__map" alt="Collaboration graph"/></div>
<map name="a_tgstation_8_server_8_host_8_service_8_program_coll__map" id="a_tgstation_8_server_8_host_8_service_8_program_coll__map">
<area shape="rect" title="Contains the entrypoint for the application." alt="" coords="12,108,211,148"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog_factory.html" title="Factory for creating IWatchdogs." alt="" coords="5,5,217,45"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a86d24d735c64eb7c67a935b809927dd4"><td class="memItemLeft" align="right" valign="top">async Task&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a86d24d735c64eb7c67a935b809927dd4">OnExecuteAsync</a> ()</td></tr>
<tr class="memdesc:a86d24d735c64eb7c67a935b809927dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Command line handler, always runs.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a86d24d735c64eb7c67a935b809927dd4">More...</a><br /></td></tr>
<tr class="separator:a86d24d735c64eb7c67a935b809927dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="properties" name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a6868da29a3857b56bba33e5d7c623b68"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a><code> [get]</code></td></tr>
<tr class="memdesc:a6868da29a3857b56bba33e5d7c623b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;uninstall or -u option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">More...</a><br /></td></tr>
<tr class="separator:a6868da29a3857b56bba33e5d7c623b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563d12bf3b4f48c462f4379e122ad57c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a563d12bf3b4f48c462f4379e122ad57c">Detach</a><code> [get]</code></td></tr>
<tr class="memdesc:a563d12bf3b4f48c462f4379e122ad57c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;detach or -x option. Valid only with <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6" title="The â€“install or -i option.">Install</a>.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a563d12bf3b4f48c462f4379e122ad57c">More...</a><br /></td></tr>
<tr class="separator:a563d12bf3b4f48c462f4379e122ad57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d8688ebf1d118649770e7d1bf259563"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a8d8688ebf1d118649770e7d1bf259563">Restart</a><code> [get]</code></td></tr>
<tr class="memdesc:a8d8688ebf1d118649770e7d1bf259563"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;restart or -r option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a8d8688ebf1d118649770e7d1bf259563">More...</a><br /></td></tr>
<tr class="separator:a8d8688ebf1d118649770e7d1bf259563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3be244b24cbb3c9ba859f55e53715e6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ae3be244b24cbb3c9ba859f55e53715e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;install or -i option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">More...</a><br /></td></tr>
<tr class="separator:ae3be244b24cbb3c9ba859f55e53715e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb3a8d49ef4c39444078ed044da78cf5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#abb3a8d49ef4c39444078ed044da78cf5">Force</a><code> [get, set]</code></td></tr>
<tr class="memdesc:abb3a8d49ef4c39444078ed044da78cf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;force or -f option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#abb3a8d49ef4c39444078ed044da78cf5">More...</a><br /></td></tr>
<tr class="separator:abb3a8d49ef4c39444078ed044da78cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad981f8101c04fde2b46e66414819fb1f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ad981f8101c04fde2b46e66414819fb1f">Silent</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ad981f8101c04fde2b46e66414819fb1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;silent or -s option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ad981f8101c04fde2b46e66414819fb1f">More...</a><br /></td></tr>
<tr class="separator:ad981f8101c04fde2b46e66414819fb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaba3eb445c2c2c0f8a11d150096b7457"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a><code> [get, set]</code></td></tr>
<tr class="memdesc:aaba3eb445c2c2c0f8a11d150096b7457"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;configure or -c option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">More...</a><br /></td></tr>
<tr class="separator:aaba3eb445c2c2c0f8a11d150096b7457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e95748d2a42975265ae8343a9caa1da"><td class="memItemLeft" align="right" valign="top">string?&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a4e95748d2a42975265ae8343a9caa1da">PassthroughArgs</a><code> [get, set]</code></td></tr>
<tr class="memdesc:a4e95748d2a42975265ae8343a9caa1da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The &ndash;passthroughargs or -p option.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a4e95748d2a42975265ae8343a9caa1da">More...</a><br /></td></tr>
<tr class="separator:a4e95748d2a42975265ae8343a9caa1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a1f4cbdc9d86cde68277bea22e6d1eb9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e">InvokeSC</a> (string? serviceToUninstall)</td></tr>
<tr class="memdesc:a1f4cbdc9d86cde68277bea22e6d1eb9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs sc.exe to either uninstall a given <em>serviceToUninstall</em>  or install the running <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_server_service.html" title="Represents a IWatchdog as a ServiceBase.">ServerService</a>.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e">More...</a><br /></td></tr>
<tr class="separator:a1f4cbdc9d86cde68277bea22e6d1eb9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a0b94eaf8077d6c2830834b9fc8dd2205"><td class="memItemLeft" align="right" valign="top">static Task&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a0b94eaf8077d6c2830834b9fc8dd2205">Main</a> (string[] args)</td></tr>
<tr class="memdesc:a0b94eaf8077d6c2830834b9fc8dd2205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entrypoint for the application.   <a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a0b94eaf8077d6c2830834b9fc8dd2205">More...</a><br /></td></tr>
<tr class="separator:a0b94eaf8077d6c2830834b9fc8dd2205"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Contains the entrypoint for the application.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00025">25</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a1f4cbdc9d86cde68277bea22e6d1eb9e" name="a1f4cbdc9d86cde68277bea22e6d1eb9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4cbdc9d86cde68277bea22e6d1eb9e">&#9670;&#160;</a></span>InvokeSC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Tgstation.Server.Host.Service.Program.InvokeSC </td>
          <td>(</td>
          <td class="paramtype">string?&#160;</td>
          <td class="paramname"><em>serviceToUninstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Runs sc.exe to either uninstall a given <em>serviceToUninstall</em>  or install the running <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_server_service.html" title="Represents a IWatchdog as a ServiceBase.">ServerService</a>.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">serviceToUninstall</td><td>The name of a service to uninstall.</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00160">160</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  161</span>        {</div>
<div class="line"><span class="lineno">  162</span>            <span class="keyword">using </span>var installer = <span class="keyword">new</span> ServiceInstaller();</div>
<div class="line"><span class="lineno">  163</span>            <span class="keywordflow">if</span> (serviceToUninstall != <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  164</span>            {</div>
<div class="line"><span class="lineno">  165</span>                installer.Context = <span class="keyword">new</span> InstallContext($<span class="stringliteral">&quot;old-{serviceToUninstall}-uninstall.log&quot;</span>, <span class="keyword">null</span>);</div>
<div class="line"><span class="lineno">  166</span>                installer.ServiceName = serviceToUninstall;</div>
<div class="line"><span class="lineno">  167</span>                installer.Uninstall(<span class="keyword">null</span>);</div>
<div class="line"><span class="lineno">  168</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  169</span>            }</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>            var fullPathToAssembly = Path.GetFullPath(</div>
<div class="line"><span class="lineno">  172</span>                Assembly.GetExecutingAssembly().Location);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>            var assemblyDirectory = Path.GetDirectoryName(fullPathToAssembly);</div>
<div class="line"><span class="lineno">  175</span>            <span class="keywordflow">if</span> (assemblyDirectory == <span class="keyword">null</span>)</div>
<div class="line"><span class="lineno">  176</span>                <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidOperationException($<span class="stringliteral">&quot;Failed to resolve directory name of {assemblyDirectory}&quot;</span>);</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>            var assemblyNameWithoutExtension = Path.GetFileNameWithoutExtension(fullPathToAssembly);</div>
<div class="line"><span class="lineno">  179</span>            var exePath = Path.Combine(assemblyDirectory, $<span class="stringliteral">&quot;{assemblyNameWithoutExtension}.exe&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>            var programDataDirectory = Path.Combine(</div>
<div class="line"><span class="lineno">  182</span>                Environment.GetFolderPath(</div>
<div class="line"><span class="lineno">  183</span>                    Environment.SpecialFolder.CommonApplicationData,</div>
<div class="line"><span class="lineno">  184</span>                    Environment.SpecialFolderOption.DoNotVerify),</div>
<div class="line"><span class="lineno">  185</span>                Server.Common.Constants.CanonicalPackageName);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>            <span class="keyword">using </span>var processInstaller = <span class="keyword">new</span> ServiceProcessInstaller();</div>
<div class="line"><span class="lineno">  188</span>            processInstaller.Account = ServiceAccount.LocalSystem;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>            <span class="comment">// Mimicing Tgstation.Server.Host.Service.Wix here, which is the source of truth for this data</span></div>
<div class="line"><span class="lineno">  191</span>            installer.Context = <span class="keyword">new</span> InstallContext(</div>
<div class="line"><span class="lineno">  192</span>                Path.Combine(programDataDirectory, $<span class="stringliteral">&quot;tgs-install-{Guid.NewGuid()}.log&quot;</span>),</div>
<div class="line"><span class="lineno">  193</span>                <span class="keyword">new</span>[]</div>
<div class="line"><span class="lineno">  194</span>                {</div>
<div class="line"><span class="lineno">  195</span>                    $<span class="stringliteral">&quot;assemblypath=\&quot;{exePath}\&quot;{(String.IsNullOrWhiteSpace(PassthroughArgs) ? String.Empty : $&quot;</span> -p=\<span class="stringliteral">&quot;{PassthroughArgs}\&quot;&quot;</span>)}<span class="stringliteral">&quot;,</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">                });</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral">            installer.Description = $&quot;</span>{Server.Common.Constants.CanonicalPackageName} running as a Windows service.<span class="stringliteral">&quot;;</span></div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">            installer.DisplayName = Server.Common.Constants.CanonicalPackageName;</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">            installer.StartType = ServiceStartMode.Automatic;</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">            installer.ServicesDependedOn = new string[] { &quot;</span>Tcpip<span class="stringliteral">&quot;, &quot;</span>Dhcp<span class="stringliteral">&quot;, &quot;</span>Dnscache<span class="stringliteral">&quot; };</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">            installer.ServiceName = ServerService.Name;</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral">            installer.Parent = processInstaller;</span></div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">            var state = new ListDictionary();</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">            try</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">            {</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">                installer.Install(state);</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">                installer.Commit(state);</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">            }</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">            catch</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">            {</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">                installer.Rollback(state);</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">                throw;</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">            }</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">        }</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">        bool RunServiceInstall()</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        {</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">            // First check if the service already exists</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">            bool serviceStopped = false;</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">            if (Force || !WindowsServiceHelpers.IsWindowsService())</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">                foreach (ServiceController sc in ServiceController.GetServices())</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">                    using (sc)</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">                    {</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">                        var serviceName = sc.ServiceName;</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">                        if (serviceName == ServerService.Name || serviceName == &quot;</span>tgstation-server-4<span class="stringliteral">&quot;)</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">                        {</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">                            NativeMethods.DialogResult result = !Force</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">                                ? NativeMethods.MessageBox(</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">                                    default,</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">                                    $&quot;</span>You already have another TGS service installed ({sc.ServiceName}). Would you like to uninstall it now? Pressing \<span class="stringliteral">&quot;No\&quot; will cancel this install.&quot;</span>,</div>
<div class="line"><span class="lineno">  237</span>                                    <span class="stringliteral">&quot;TGS Service&quot;</span>,</div>
<div class="line"><span class="lineno">  238</span>                                    NativeMethods.MessageBoxButtons.YesNo)</div>
<div class="line"><span class="lineno">  239</span>                                : NativeMethods.DialogResult.Yes;</div>
<div class="line"><span class="lineno">  240</span>                            <span class="keywordflow">if</span> (result != NativeMethods.DialogResult.Yes)</div>
<div class="line"><span class="lineno">  241</span>                                <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// is this needed after exit?</span></div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>                            <span class="comment">// Stop it first to give it some cleanup time</span></div>
<div class="line"><span class="lineno">  244</span>                            <a class="code hl_function" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a">RestartService</a>(sc);</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>                            <span class="comment">// And remove it</span></div>
<div class="line"><span class="lineno">  247</span>                            <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e">InvokeSC</a>(sc.ServiceName);</div>
<div class="line"><span class="lineno">  248</span>                        }</div>
<div class="ttc" id="a_tgstation_8_server_8_host_8_service_2_program_8cs_html_a7a5d1a672c9435fca33efa3cdfda3f7a"><div class="ttname"><a href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a">RestartService</a></div><div class="ttdeci">void RestartService(ServiceController serviceController)</div><div class="ttdoc">Restarts a service using a given serviceController .</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00260">Program.cs:260</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a1f4cbdc9d86cde68277bea22e6d1eb9e"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e">Tgstation.Server.Host.Service.Program.InvokeSC</a></div><div class="ttdeci">void InvokeSC(string? serviceToUninstall)</div><div class="ttdoc">Runs sc.exe to either uninstall a given serviceToUninstall  or install the running ServerService.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00160">Program.cs:160</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00160">Tgstation.Server.Host.Service.Program.InvokeSC()</a>, and <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00260">RestartService()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00160">Tgstation.Server.Host.Service.Program.InvokeSC()</a>, and <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_cgraph">
<area shape="rect" title="Runs sc.exe to either uninstall a given serviceToUninstall &#160;or install the running ServerService." alt="" coords="5,29,204,69"/>
<area shape="rect" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a" title="Restarts a service using a given serviceController ." alt="" coords="252,37,360,62"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_common_1_1_pipe_commands.html#a06c8d3400eeb8207d35f8f3bae86cfb5" title="Gets the int value of a given command ." alt="" coords="408,29,660,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_icgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_icgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_icgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a1f4cbdc9d86cde68277bea22e6d1eb9e_icgraph">
<area shape="rect" title="Runs sc.exe to either uninstall a given serviceToUninstall &#160;or install the running ServerService." alt="" coords="252,29,451,69"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a86d24d735c64eb7c67a935b809927dd4" title="Command line handler, always runs." alt="" coords="5,29,204,69"/>
</map>
</div>

</div>
</div>
<a id="a0b94eaf8077d6c2830834b9fc8dd2205" name="a0b94eaf8077d6c2830834b9fc8dd2205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b94eaf8077d6c2830834b9fc8dd2205">&#9670;&#160;</a></span>Main()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static Task&lt; int &gt; Tgstation.Server.Host.Service.Program.Main </td>
          <td>(</td>
          <td class="paramtype">string[]&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entrypoint for the application.  </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>The application arguments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Task resulting in the <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html" title="Contains the entrypoint for the application.">Program</a>'s exit code.</dd></dl>

</div>
</div>
<a id="a86d24d735c64eb7c67a935b809927dd4" name="a86d24d735c64eb7c67a935b809927dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86d24d735c64eb7c67a935b809927dd4">&#9670;&#160;</a></span>OnExecuteAsync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">async Task Tgstation.Server.Host.Service.Program.OnExecuteAsync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Command line handler, always runs.  </p>
<dl class="section return"><dt>Returns</dt><dd>A Task representing the running operation.</dd></dl>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">93</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>        {</div>
<div class="line"><span class="lineno">   95</span>            var standardRun = !<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a> &amp;&amp; !<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a> &amp;&amp; !<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a>;</div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordflow">if</span> (standardRun)</div>
<div class="line"><span class="lineno">   97</span>                <span class="keywordflow">if</span> (!<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ad981f8101c04fde2b46e66414819fb1f">Silent</a> &amp;&amp; !WindowsServiceHelpers.IsWindowsService())</div>
<div class="line"><span class="lineno">   98</span>                {</div>
<div class="line"><span class="lineno">   99</span>                    var result = NativeMethods.MessageBox(</div>
<div class="line"><span class="lineno">  100</span>                        <span class="keywordflow">default</span>,</div>
<div class="line"><span class="lineno">  101</span>                        <span class="stringliteral">&quot;You are running the TGS windows service executable directly. It should only be run by the service control manager. Would you like to install and configure the service in this location?&quot;</span>,</div>
<div class="line"><span class="lineno">  102</span>                        <span class="stringliteral">&quot;TGS Service&quot;</span>,</div>
<div class="line"><span class="lineno">  103</span>                        NativeMethods.MessageBoxButtons.YesNo);</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>                    <span class="keywordflow">if</span> (result != NativeMethods.DialogResult.Yes)</div>
<div class="line"><span class="lineno">  106</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  109</span>                    <a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  110</span>                }</div>
<div class="line"><span class="lineno">  111</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  112</span>                    <span class="keyword">using</span> (var service = <span class="keyword">new</span> ServerService(<a class="code hl_class" href="class_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory.html">WatchdogFactory</a>, <a class="code hl_function" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a1c79ecbbbf76c50e43de105dbbde8571">GetPassthroughArgs</a>(), LogLevel.Trace))</div>
<div class="line"><span class="lineno">  113</span>                    {</div>
<div class="line"><span class="lineno">  114</span>                        service.Run();</div>
<div class="line"><span class="lineno">  115</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  116</span>                    }</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>            <span class="keywordflow">if</span> (<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Configure</a>)</div>
<div class="line"><span class="lineno">  119</span>                await <a class="code hl_function" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a4981a34f5f9ca5f428d65dcc28f8deff">RunConfigure</a>(CancellationToken.None); <span class="comment">// DCT: None available</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>            <span class="keywordtype">bool</span> stopped = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  122</span>            <span class="keywordflow">if</span> (<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Uninstall</a>)</div>
<div class="line"><span class="lineno">  123</span>            {</div>
<div class="line"><span class="lineno">  124</span>                <span class="keywordflow">foreach</span> (ServiceController sc <span class="keywordflow">in</span> ServiceController.GetServices())</div>
<div class="line"><span class="lineno">  125</span>                {</div>
<div class="line"><span class="lineno">  126</span>                    <span class="keywordtype">bool</span> match;</div>
<div class="line"><span class="lineno">  127</span>                    <span class="keyword">using</span> (sc)</div>
<div class="line"><span class="lineno">  128</span>                    {</div>
<div class="line"><span class="lineno">  129</span>                        match = sc.ServiceName == ServerService.Name;</div>
<div class="line"><span class="lineno">  130</span>                        <span class="keywordflow">if</span> (match)</div>
<div class="line"><span class="lineno">  131</span>                            <a class="code hl_function" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a">RestartService</a>(sc);</div>
<div class="line"><span class="lineno">  132</span>                    }</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>                    <span class="keywordflow">if</span> (match)</div>
<div class="line"><span class="lineno">  135</span>                        <a class="code hl_function" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e">InvokeSC</a>(ServerService.Name);</div>
<div class="line"><span class="lineno">  136</span>                }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>                stopped = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  139</span>            }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">if</span> (<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Install</a>)</div>
<div class="line"><span class="lineno">  142</span>                stopped |= RunServiceInstall();</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>            <span class="keywordflow">if</span> (<a class="code hl_property" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a8d8688ebf1d118649770e7d1bf259563">Restart</a>)</div>
<div class="line"><span class="lineno">  145</span>                <span class="keywordflow">foreach</span> (ServiceController sc <span class="keywordflow">in</span> ServiceController.GetServices())</div>
<div class="line"><span class="lineno">  146</span>                    <span class="keyword">using</span> (sc)</div>
<div class="line"><span class="lineno">  147</span>                        <span class="keywordflow">if</span> (sc.ServiceName == ServerService.Name)</div>
<div class="line"><span class="lineno">  148</span>                        {</div>
<div class="line"><span class="lineno">  149</span>                            <span class="keywordflow">if</span> (!stopped)</div>
<div class="line"><span class="lineno">  150</span>                                <a class="code hl_function" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a">RestartService</a>(sc);</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>                            sc.Start();</div>
<div class="line"><span class="lineno">  153</span>                        }</div>
<div class="line"><span class="lineno">  154</span>        }</div>
<div class="ttc" id="a_tgstation_8_server_8_host_8_service_2_program_8cs_html_a1c79ecbbbf76c50e43de105dbbde8571"><div class="ttname"><a href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a1c79ecbbbf76c50e43de105dbbde8571">GetPassthroughArgs</a></div><div class="ttdeci">string[] GetPassthroughArgs()</div><div class="ttdoc">Format PassthroughArgs into an Array.</div></div>
<div class="ttc" id="a_tgstation_8_server_8_host_8_service_2_program_8cs_html_a4981a34f5f9ca5f428d65dcc28f8deff"><div class="ttname"><a href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a4981a34f5f9ca5f428d65dcc28f8deff">RunConfigure</a></div><div class="ttdeci">async ValueTask RunConfigure(CancellationToken cancellationToken)</div><div class="ttdoc">Runs the host application with the setup wizard.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00287">Program.cs:287</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a6868da29a3857b56bba33e5d7c623b68"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a6868da29a3857b56bba33e5d7c623b68">Tgstation.Server.Host.Service.Program.Uninstall</a></div><div class="ttdeci">bool Uninstall</div><div class="ttdoc">The â€“uninstall or -u option.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00038">Program.cs:38</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_a8d8688ebf1d118649770e7d1bf259563"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a8d8688ebf1d118649770e7d1bf259563">Tgstation.Server.Host.Service.Program.Restart</a></div><div class="ttdeci">bool Restart</div><div class="ttdoc">The â€“restart or -r option.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00050">Program.cs:50</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_aaba3eb445c2c2c0f8a11d150096b7457"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#aaba3eb445c2c2c0f8a11d150096b7457">Tgstation.Server.Host.Service.Program.Configure</a></div><div class="ttdeci">bool Configure</div><div class="ttdoc">The â€“configure or -c option.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00074">Program.cs:74</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_ad981f8101c04fde2b46e66414819fb1f"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ad981f8101c04fde2b46e66414819fb1f">Tgstation.Server.Host.Service.Program.Silent</a></div><div class="ttdeci">bool Silent</div><div class="ttdoc">The â€“silent or -s option.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00068">Program.cs:68</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_html_ae3be244b24cbb3c9ba859f55e53715e6"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6">Tgstation.Server.Host.Service.Program.Install</a></div><div class="ttdeci">bool Install</div><div class="ttdoc">The â€“install or -i option.</div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00056">Program.cs:56</a></div></div>
<div class="ttc" id="aclass_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory_html"><div class="ttname"><a href="class_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory.html">Tgstation.Server.Host.Watchdog.WatchdogFactory</a></div><div class="ttdef"><b>Definition:</b> <a href="_tgstation_8_server_8_host_8_watchdog_2_watchdog_factory_8cs_source.html#l00008">WatchdogFactory.cs:9</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00074">Tgstation.Server.Host.Service.Program.Configure</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a1c79ecbbbf76c50e43de105dbbde8571">GetPassthroughArgs()</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00056">Tgstation.Server.Host.Service.Program.Install</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00160">Tgstation.Server.Host.Service.Program.InvokeSC()</a>, <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_native_methods.html#ae07fe7e0f9de11e2406dbcb8d04b6811">Tgstation.Server.Host.Service.NativeMethods.MessageBox()</a>, <a class="el" href="_server_service_8cs_source.html#l00025">Tgstation.Server.Host.Service.ServerService.Name</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00050">Tgstation.Server.Host.Service.Program.Restart</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00260">RestartService()</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00287">RunConfigure()</a>, <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00068">Tgstation.Server.Host.Service.Program.Silent</a>, and <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00038">Tgstation.Server.Host.Service.Program.Uninstall</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a86d24d735c64eb7c67a935b809927dd4_cgraph.png" border="0" usemap="#aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a86d24d735c64eb7c67a935b809927dd4_cgraph" alt=""/></div>
<map name="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a86d24d735c64eb7c67a935b809927dd4_cgraph" id="aclass_tgstation_1_1_server_1_1_host_1_1_service_1_1_program_a86d24d735c64eb7c67a935b809927dd4_cgraph">
<area shape="rect" title="Command line handler, always runs." alt="" coords="5,137,204,177"/>
<area shape="rect" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a1c79ecbbbf76c50e43de105dbbde8571" title="Format PassthroughArgs into an Array." alt="" coords="539,159,681,185"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#a1f4cbdc9d86cde68277bea22e6d1eb9e" title="Runs sc.exe to either uninstall a given serviceToUninstall &#160;or install the running ServerService." alt="" coords="252,29,451,69"/>
<area shape="rect" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a7a5d1a672c9435fca33efa3cdfda3f7a" title="Restarts a service using a given serviceController ." alt="" coords="556,66,664,91"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_native_methods.html#ae07fe7e0f9de11e2406dbcb8d04b6811" title="Displays a modal dialog box that contains a system icon, a set of buttons, and a brief application&#45;sp..." alt="" coords="252,195,451,235"/>
<area shape="rect" href="_tgstation_8_server_8_host_8_service_2_program_8cs.html#a4981a34f5f9ca5f428d65dcc28f8deff" title="Runs the host application with the setup wizard." alt="" coords="302,259,401,285"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_common_1_1_pipe_commands.html#a06c8d3400eeb8207d35f8f3bae86cfb5" title="Gets the int value of a given command ." alt="" coords="769,59,1021,99"/>
<area shape="rect" href="class_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_watchdog_factory.html#ad1ffef58b23302061a59e4332c031e79" title="Create a IWatchdog. A new IWatchdog." alt="" coords="499,237,721,277"/>
<area shape="rect" href="interface_tgstation_1_1_server_1_1_host_1_1_watchdog_1_1_i_watchdog.html#aba34e712e0cdbbd747feba6fb9f83176" title="Run the IWatchdog." alt="" coords="504,301,716,341"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a id="aaba3eb445c2c2c0f8a11d150096b7457" name="aaba3eb445c2c2c0f8a11d150096b7457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaba3eb445c2c2c0f8a11d150096b7457">&#9670;&#160;</a></span>Configure</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Configure</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;configure or -c option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00074">74</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>

</div>
</div>
<a id="a563d12bf3b4f48c462f4379e122ad57c" name="a563d12bf3b4f48c462f4379e122ad57c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563d12bf3b4f48c462f4379e122ad57c">&#9670;&#160;</a></span>Detach</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Detach</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;detach or -x option. Valid only with <a class="el" href="class_tgstation_1_1_server_1_1_host_1_1_service_1_1_program.html#ae3be244b24cbb3c9ba859f55e53715e6" title="The â€“install or -i option.">Install</a>.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00044">44</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span>{ <span class="keyword">get</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="abb3a8d49ef4c39444078ed044da78cf5" name="abb3a8d49ef4c39444078ed044da78cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb3a8d49ef4c39444078ed044da78cf5">&#9670;&#160;</a></span>Force</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Force</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;force or -f option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00062">62</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3be244b24cbb3c9ba859f55e53715e6" name="ae3be244b24cbb3c9ba859f55e53715e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3be244b24cbb3c9ba859f55e53715e6">&#9670;&#160;</a></span>Install</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Install</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;install or -i option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00056">56</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>

</div>
</div>
<a id="a4e95748d2a42975265ae8343a9caa1da" name="a4e95748d2a42975265ae8343a9caa1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e95748d2a42975265ae8343a9caa1da">&#9670;&#160;</a></span>PassthroughArgs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string? Tgstation.Server.Host.Service.Program.PassthroughArgs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;passthroughargs or -p option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00080">80</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d8688ebf1d118649770e7d1bf259563" name="a8d8688ebf1d118649770e7d1bf259563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d8688ebf1d118649770e7d1bf259563">&#9670;&#160;</a></span>Restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Restart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;restart or -r option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00050">50</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>{ <span class="keyword">get</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>

</div>
</div>
<a id="ad981f8101c04fde2b46e66414819fb1f" name="ad981f8101c04fde2b46e66414819fb1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad981f8101c04fde2b46e66414819fb1f">&#9670;&#160;</a></span>Silent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Silent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;silent or -s option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00068">68</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>{ <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>

</div>
</div>
<a id="a6868da29a3857b56bba33e5d7c623b68" name="a6868da29a3857b56bba33e5d7c623b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6868da29a3857b56bba33e5d7c623b68">&#9670;&#160;</a></span>Uninstall</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tgstation.Server.Host.Service.Program.Uninstall</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The &ndash;uninstall or -u option.  </p>

<p class="definition">Definition at line <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00038">38</a> of file <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{ <span class="keyword">get</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html#l00093">Tgstation.Server.Host.Service.Program.OnExecuteAsync()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Tgstation.Server.Host.Service/<a class="el" href="_tgstation_8_server_8_host_8_service_2_program_8cs_source.html">Program.cs</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
