<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tgstation-server: TGS.Server/Instance/Repository.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tgs.ico"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tgstation-server
   </div>
   <div id="projectbrief">The /tg/station 13 server suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d416ca425b5524beda4d68f02698bdb3.html">TGS.Server</a></li><li class="navelem"><a class="el" href="dir_247dc62efdba86a5141239c39fc82c17.html">Instance</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Repository.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_t_g_s_8_server_2_instance_2_repository_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_lib_git2_sharp.html">LibGit2Sharp</a>;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> Newtonsoft.Json;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> Newtonsoft.Json.Linq;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> <a class="code" href="_t_g_s_8_command_line_2_program_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a>;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Diagnostics;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.IO;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Net;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Threading;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_t_g_s.html">TGS</a>.<a class="code" href="namespace_t_g_s_1_1_interface.html">Interface</a>;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_t_g_s.html">TGS</a>.<a class="code" href="namespace_t_g_s_1_1_interface.html">Interface</a>.<a class="code" href="namespace_t_g_s_1_1_interface_1_1_components.html">Components</a>;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_t_g_s.html">TGS</a>.<a class="code" href="class_t_g_s_1_1_interface_1_1_server.html">Server</a></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;{</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    sealed <span class="keyword">partial class </span><a class="code" href="class_t_g_s_1_1_interface_1_1_instance.html">Instance</a> : <a class="code" href="interface_t_g_s_1_1_interface_1_1_components_1_1_i_t_g_repository.html">ITGRepository</a>, <a class="code" href="class_i_disposable.html">IDisposable</a></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    {</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ac5445b16310369325042c5f678d330fd">   21</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> RepoPath = <span class="stringliteral">&quot;Repository&quot;</span>;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a92be8ba81fd1326b755a9e0582a958ac">   25</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> RemoteTempBranchName = <span class="stringliteral">&quot;___TGS3TempBranch&quot;</span>;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aadcdb4e1f858c283771dedb14baeb44d">   29</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> RepoTGS3SettingsPath = RepoPath + <span class="stringliteral">&quot;/TGS3.json&quot;</span>;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ab02a3f6b4183f965d6e7f1f3b69c771b">   33</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> CachedTGS3SettingsPath = <span class="stringliteral">&quot;TGS3.json&quot;</span>;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a61ce14bfd634ae093b669fb8ba61b9fd">   37</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> RepoErrorUpToDate = <span class="stringliteral">&quot;Already up to date!&quot;</span>;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a2e4fbf4a4caf26ec2d958c4fad93395a">   41</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> SSHPushRemote = <span class="stringliteral">&quot;ssh_push_target&quot;</span>;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a5c0c5108a336d1ec6e664c81e800a7e5">   45</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> RepoKeyDir = <span class="stringliteral">&quot;RepoKey/&quot;</span>;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a536bd20d4c5e1a84a48c0ef13928495c">   49</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> PrivateKeyPath = RepoKeyDir + <span class="stringliteral">&quot;private_key.txt&quot;</span>;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aaadb267170db9b85e56b13136a93da15">   53</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> PublicKeyPath = RepoKeyDir + <span class="stringliteral">&quot;public_key.txt&quot;</span>;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#afabbb968df135f20d7dc6b9684bb3205">   57</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> PRJobFile = <span class="stringliteral">&quot;prtestjob.json&quot;</span>;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ac5c950acf89122f63e09ca01c495f647">   61</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> LiveTrackingBranch = <span class="stringliteral">&quot;___TGSLiveCommitTrackingBranch&quot;</span>;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a7918693e49a91ef4376b1a2b13285239">   65</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> CommitMessage = <span class="stringliteral">&quot;Automatic changelog compile, [ci skip]&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#af61d84cdc4e6ebdfab069f9705c4254b">   70</a></span>&#160;        <span class="keywordtype">object</span> RepoLock = <span class="keyword">new</span> object();</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a1e7fb86e4909538c2cfb04e228717c4b">   74</a></span>&#160;        <span class="keywordtype">bool</span> RepoBusy = <span class="keyword">false</span>;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#affa0200662dbc73df3917828e28a46e3">   78</a></span>&#160;        <span class="keywordtype">bool</span> Cloning = <span class="keyword">false</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ae59778f28034fa3b6dd2abec09536f6e">   83</a></span>&#160;        Repository <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ae59778f28034fa3b6dd2abec09536f6e">Repo</a>;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#af34ec3b6bf17a85bd373018a19cf54da">   87</a></span>&#160;        <span class="keywordtype">int</span> currentProgress = -1;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#adaecb345b5b6040438f86604659051ab">   92</a></span>&#160;        <a class="code" href="namespace_system.html">System</a>.Timers.Timer autoUpdateTimer = <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.Timers.Timer()</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            AutoReset = <span class="keyword">true</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        };</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a40fc1ed9ca23a8c0d6a51521e91f66ef">  100</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a40fc1ed9ca23a8c0d6a51521e91f66ef">InitRepo</a>()</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            Directory.CreateDirectory(RelativePath(RepoKeyDir));</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span> (Exists())</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                UpdateBridgeDll(<span class="keyword">false</span>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> (LoadRepo() == null)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                DisableGarbageCollectionNoLock();</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="comment">//start the autoupdate timer</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            autoUpdateTimer.Elapsed += AutoUpdateTimer_Elapsed;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            SetAutoUpdateInterval(Config.AutoUpdateInterval);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aa279ed5a9e086c8ce04c4af07be0fe51">  116</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aa279ed5a9e086c8ce04c4af07be0fe51">RepoConfigsMatch</a>()</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="comment">//this should never be called while the repo is busy</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html">RepoConfig</a> I = null;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                <span class="keywordflow">if</span> (!RepoBusy &amp;&amp; LoadRepo() == null)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    I = <span class="keyword">new</span> <a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html">RepoConfig</a>(RelativePath(RepoTGS3SettingsPath));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">if</span> (I == null)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Unable to load TGS3.json from repo!&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            var J = GetCachedRepoConfig();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordflow">return</span> I == J;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a42e57a4aa98fefe7c844ada8d6f2eb9a">  133</a></span>&#160;        <a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html">RepoConfig</a> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a42e57a4aa98fefe7c844ada8d6f2eb9a">GetCachedRepoConfig</a>()</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html">RepoConfig</a>(RelativePath(CachedTGS3SettingsPath));</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ac3c034d54751b0cc2c76a77232e4a15e">  139</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ac3c034d54751b0cc2c76a77232e4a15e">OperationInProgress</a>()</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">return</span> RepoBusy;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a6388054e24e414ef49593fa51ce0ae24">  146</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a6388054e24e414ef49593fa51ce0ae24">CheckoutProgress</a>()</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">return</span> currentProgress;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a8170aa201e010210c23b5f6bb75b19ba">  155</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a8170aa201e010210c23b5f6bb75b19ba">LoadRepo</a>()</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (Repo != null)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">if</span> (!Repository.IsValid(RelativePath(RepoPath)))</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repository does not exist&quot;</span>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                Repo = <span class="keyword">new</span> Repository(RelativePath(RepoPath));</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a7ca212db696b8c01419fd60902b98378">  175</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a7ca212db696b8c01419fd60902b98378">DisposeRepo</a>()</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">if</span> (Repo != null)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                Repo.Dispose();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                Repo = null;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#acbbd8b294a54c3573371c933467f5575">  185</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#acbbd8b294a54c3573371c933467f5575">Exists</a>()</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">return</span> !Cloning &amp;&amp; Repository.IsValid(RelativePath(RepoPath));</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a2ec78124dea785dbd28b9dec109eb909">  196</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a2ec78124dea785dbd28b9dec109eb909">HandleTransferProgress</a>(TransferProgress progress)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            currentProgress = ((int)(((<span class="keywordtype">float</span>)progress.ReceivedObjects / progress.TotalObjects) * 100) / 2) + ((int)(((<span class="keywordtype">float</span>)progress.IndexedObjects / progress.TotalObjects) * 100) / 2);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#abf1b05ba88199291ea366ffec194d3d7">  208</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#abf1b05ba88199291ea366ffec194d3d7">HandleCheckoutProgress</a>(<span class="keywordtype">string</span> path, <span class="keywordtype">int</span> completedSteps, <span class="keywordtype">int</span> totalSteps)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            currentProgress = (int)(((<span class="keywordtype">float</span>)completedSteps / totalSteps) * 100);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a3443b6d7f6b2481e21e8c7a63c429221">  217</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a3443b6d7f6b2481e21e8c7a63c429221">Clone</a>(<span class="keywordtype">object</span> twostrings)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">//busy flag set by caller</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            var ts = ((string)twostrings).Split(<span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            var RepoURL = ts[0];</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            var BranchName = ts[1];</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                SendMessage(String.Format(<span class="stringliteral">&quot;REPO: {2} started: Cloning {0} branch of {1} ...&quot;</span>, BranchName, RepoURL, Repository.IsValid(RepoPath) ? <span class="stringliteral">&quot;Full reset&quot;</span> : <span class="stringliteral">&quot;Setup&quot;</span>), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    DisposeRepo();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a5b1d1510ab671f24b98ecafa79f98c00">DeleteDirectory</a>(RelativePath(RepoPath));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    DeletePRList();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    <span class="comment">/*</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">                    lock (configLock)</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">                    {</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                        BackupAndDeleteStaticDirectory();</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">                    }*/</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    var Opts = <span class="keyword">new</span> CloneOptions()</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        BranchName = BranchName,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        RecurseSubmodules = <span class="keyword">true</span>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        OnTransferProgress = HandleTransferProgress,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        OnCheckoutProgress = HandleCheckoutProgress,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        CredentialsProvider = GenerateGitCredentials,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    };</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    Repository.Clone(RepoURL, RelativePath(RepoPath), Opts);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    currentProgress = -1;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    LoadRepo();</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    DisableGarbageCollectionNoLock();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <span class="comment">//create an ssh remote for pushing</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    Repo.Network.Remotes.Add(SSHPushRemote, RepoURL.Replace(<span class="stringliteral">&quot;git://&quot;</span>, <span class="stringliteral">&quot;ssh://&quot;</span>).Replace(<span class="stringliteral">&quot;https://&quot;</span>, <span class="stringliteral">&quot;ssh://&quot;</span>));</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="keywordflow">if</span> (!Directory.Exists(RelativePath(StaticDirs)))</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        InitialConfigureRepository();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    SendMessage(<span class="stringliteral">&quot;REPO: Clone complete!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    WriteInfo(<span class="stringliteral">&quot;Repository {0}:{1} successfully cloned&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoClone);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">finally</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    currentProgress = -1;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                SendMessage(<span class="stringliteral">&quot;REPO: Setup failed!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                WriteWarning(String.Format(<span class="stringliteral">&quot;Failed to clone {2}:{0}: {1}&quot;</span>, BranchName, e.ToString(), RepoURL), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoCloneFail);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                lock (RepoLock)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    RepoBusy = <span class="keyword">false</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    Cloning = <span class="keyword">false</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ae37cbe097d7326ff0432bcd39ffce488">  286</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ae37cbe097d7326ff0432bcd39ffce488">DisableGarbageCollectionNoLock</a>()</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            Repo.Config.Set(<span class="stringliteral">&quot;gc.auto&quot;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a5956aa08c166860be43e49e2378cd383">  294</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a5956aa08c166860be43e49e2378cd383">BackupAndDeleteStaticDirectory</a>()</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            var rsd = RelativePath(StaticDirs);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">if</span> (Directory.Exists(rsd))</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordtype">int</span> count = 1;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                var rsbd = RelativePath(StaticBackupDir);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordtype">string</span> path = Path.GetDirectoryName(rsbd);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordtype">string</span> newFullPath = rsbd;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">while</span> (File.Exists(newFullPath) || Directory.Exists(newFullPath))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    <span class="keywordtype">string</span> tempDirName = <span class="keywordtype">string</span>.Format(<span class="stringliteral">&quot;{0}({1})&quot;</span>, rsbd, count++);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    newFullPath = Path.Combine(path, tempDirName);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a5c7123b266b9815f4ef6247a0b21387c">CopyDirectory</a>(rsd, newFullPath);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a5b1d1510ab671f24b98ecafa79f98c00">DeleteDirectory</a>(rsd);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a1f4b564db63526863dacc273a6715801">  320</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a1f4b564db63526863dacc273a6715801">UpdateTGS3Json</a>()</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="keywordflow">if</span> (File.Exists(RelativePath(RepoTGS3SettingsPath)))</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    File.Copy(RelativePath(RepoTGS3SettingsPath), RelativePath(CachedTGS3SettingsPath), <span class="keyword">true</span>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (File.Exists(RelativePath(CachedTGS3SettingsPath)))</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    File.Delete(RelativePath(CachedTGS3SettingsPath));</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a29a3c86b836454d030d1ea31a7a6faf9">  339</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a29a3c86b836454d030d1ea31a7a6faf9">InitialConfigureRepository</a>()</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            Directory.CreateDirectory(RelativePath(StaticDirs));</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            UpdateBridgeDll(<span class="keyword">false</span>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            UpdateTGS3Json();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            var Config = GetCachedRepoConfig(); <span class="comment">//RepoBusy is set if we&#39;re here</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> Config.StaticDirectoryPaths)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    var source = Path.Combine(RelativePath(RepoPath), I);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    var dest = Path.Combine(RelativePath(StaticDirs), I);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="keywordflow">if</span> (Directory.Exists(source))</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                        <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a5c7123b266b9815f4ef6247a0b21387c">CopyDirectory</a>(source, dest);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        Directory.CreateDirectory(dest);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">catch</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    WriteError(<span class="stringliteral">&quot;Could not setup static directory: &quot;</span> + I, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoConfigurationFail);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> Config.DLLPaths)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    var source = Path.Combine(RelativePath(RepoPath), I);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    <span class="keywordflow">if</span> (!File.Exists(source))</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        WriteWarning(<span class="stringliteral">&quot;Could not find DLL: &quot;</span> + I, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoConfigurationFail);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    var dest = Path.Combine(RelativePath(StaticDirs), I);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a40624df8add53e83b2ebdb7d446b70fe">CopyFileForceDirectories</a>(source, dest, <span class="keyword">false</span>);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">catch</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    WriteError(<span class="stringliteral">&quot;Could not setup static DLL: &quot;</span> + I, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoConfigurationFail);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ac4b0aee9af3f27ca17b0066daf07287d">  382</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ac4b0aee9af3f27ca17b0066daf07287d">Setup</a>(<span class="keywordtype">string</span> RepoURL, <span class="keywordtype">string</span> BranchName)</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                lock (CompilerLock)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                {</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    <span class="keywordflow">if</span> (!CompilerIdleNoLock())</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Compiler is running!&quot;</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <span class="keywordflow">if</span> (RepoURL.Contains(<span class="stringliteral">&quot;ssh://&quot;</span>) &amp;&amp; !SSHAuth())</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    <span class="keywordflow">return</span> String.Format(<span class="stringliteral">&quot;SSH url specified but either {0} or {1} does not exist in the server directory!&quot;</span>, PrivateKeyPath, PublicKeyPath);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                RepoBusy = <span class="keyword">true</span>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                Cloning = <span class="keyword">true</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="keyword">new</span> Thread(<span class="keyword">new</span> ParameterizedThreadStart(Clone))</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    IsBackground = <span class="keyword">true</span> <span class="comment">//make sure we don&#39;t hold up shutdown</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                }.Start(RepoURL + <span class="charliteral">&#39; &#39;</span> + BranchName);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#abb80352fb834bb68a8eaa19458769dfe">  412</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#abb80352fb834bb68a8eaa19458769dfe">GetShaOrBranch</a>(out <span class="keywordtype">string</span> error, <span class="keywordtype">bool</span> branch, <span class="keywordtype">bool</span> tracked)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    error = <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <span class="keywordflow">return</span> GetShaOrBranchNoLock(out error, branch, tracked);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a8f55a135fbd9335e91378dc08239d139">  432</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a8f55a135fbd9335e91378dc08239d139">GetShaOrBranchNoLock</a>(out <span class="keywordtype">string</span> error, <span class="keywordtype">bool</span> branch, <span class="keywordtype">bool</span> tracked)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            var result = LoadRepo();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                error = result;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                error = null;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keywordflow">if</span> (tracked &amp;&amp; Repo.Head.TrackedBranch != null)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="keywordflow">return</span> Repo.Head.TrackedBranch.Tip.Sha;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">return</span> branch ? Repo.Head.FriendlyName : Repo.Head.Tip.Sha;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                error = e.ToString();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#af5b6c24c3b6a500397c482cbe2739790">  456</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#af5b6c24c3b6a500397c482cbe2739790">GetHead</a>(<span class="keywordtype">bool</span> useTracked, out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">return</span> GetShaOrBranch(out error, <span class="keyword">false</span>, useTracked);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ab58aae42424613af52009f69695d6f93">  462</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ab58aae42424613af52009f69695d6f93">GetBranch</a>(out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordflow">return</span> GetShaOrBranch(out error, <span class="keyword">true</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#abeac01eeeff769611c0191173076f0e0">  468</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#abeac01eeeff769611c0191173076f0e0">GetRemote</a>(out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                var res = LoadRepo();</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    error = res;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                error = null;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">return</span> Repo.Network.Remotes[<span class="stringliteral">&quot;origin&quot;</span>].Url;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                error = e.ToString();</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a6107dd2858d2a2c70cb9ac7d5105d373">  493</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a6107dd2858d2a2c70cb9ac7d5105d373">ResetNoLock</a>(Branch targetBranch)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">if</span> (targetBranch != null)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    Repo.Reset(ResetMode.Hard, targetBranch.Tip);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    Repo.Reset(ResetMode.Hard);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ac49fce1ca9d542dca6992318c1c94855">  510</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ac49fce1ca9d542dca6992318c1c94855">Checkout</a>(<span class="keywordtype">string</span> sha)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordflow">if</span> (sha == LiveTrackingBranch)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;I&#39;m sorry Dave, I&#39;m afraid I can&#39;t do that...&quot;</span>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                var result = LoadRepo();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                SendMessage(<span class="stringliteral">&quot;REPO: Checking out object: &quot;</span> + sha, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                    <span class="keywordflow">if</span> (Repo.Branches[sha] == null)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                    {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="comment">//see if origin has the branch</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                        result = Fetch();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        var trackedBranch = Repo.Branches[String.Format(<span class="stringliteral">&quot;origin/{0}&quot;</span>, sha)];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        <span class="keywordflow">if</span> (trackedBranch != null)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                            var newBranch = Repo.CreateBranch(sha, trackedBranch.Tip);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            <span class="comment">//track it</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                            Repo.Branches.Update(newBranch, b =&gt; b.TrackedBranch = trackedBranch.CanonicalName);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    <span class="comment">//if this is a tracked branch, we need to reset to remote first and delete the PR list</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    ResetNoLock(Repo.Head.TrackedBranch ?? Repo.Head);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    DeletePRList();</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    var Opts = <span class="keyword">new</span> CheckoutOptions()</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        CheckoutModifiers = CheckoutModifiers.Force,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        OnCheckoutProgress = HandleCheckoutProgress,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    };</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    Commands.Checkout(Repo, sha, Opts);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    var res = ResetNoLock(null);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    UpdateSubmodules();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    SendMessage(<span class="stringliteral">&quot;REPO: Checkout complete!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    WriteInfo(<span class="stringliteral">&quot;Repo checked out &quot;</span> + sha, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoCheckout);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    SendMessage(<span class="stringliteral">&quot;REPO: Checkout failed!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    WriteWarning(String.Format(<span class="stringliteral">&quot;Repo checkout of {0} failed: {1}&quot;</span>, sha, e.ToString()), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoCheckoutFail);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a32f473cc0c8d3f91c6fe8927fe927996">  570</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a32f473cc0c8d3f91c6fe8927fe927996">MergeBranch</a>(<span class="keywordtype">string</span> committish, <span class="keywordtype">string</span> mergeMessage)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            var mo = <span class="keyword">new</span> MergeOptions()</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                OnCheckoutProgress = HandleCheckoutProgress</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            };</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">if</span> (mergeMessage != null)</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                mo.CommitOnSuccess = <span class="keyword">false</span>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                mo.FastForwardStrategy = FastForwardStrategy.NoFastForward;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            var sig = MakeSig();</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            var Result = Repo.Merge(committish, sig, mo);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            currentProgress = -1;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">switch</span> (Result.Status)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">case</span> MergeStatus.Conflicts:</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    ResetNoLock(null);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    SendMessage(String.Format(<span class="stringliteral">&quot;REPO: Merge of {0} conflicted, aborted.&quot;</span>, committish), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Merge conflict occurred.&quot;</span>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                <span class="keywordflow">case</span> MergeStatus.UpToDate:</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    <span class="keywordflow">return</span> RepoErrorUpToDate;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">if</span> (mergeMessage != null)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                Repo.Commit(mergeMessage, sig, sig);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a17149c71ad3f539181c44db6b9d17370">  598</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a17149c71ad3f539181c44db6b9d17370">PushTestmergeCommit</a>()</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> (Config.PushTestmergeCommits &amp;&amp; SSHAuth())</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="keywordtype">string</span> NewB = null;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                var targetRemote = Repo.Network.Remotes[SSHPushRemote];</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                var options = <span class="keyword">new</span> PushOptions()</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    CredentialsProvider = GenerateGitCredentials</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                };</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="comment">//now try and push the commit to the remote so they can be referenced</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    NewB = Repo.CreateBranch(RemoteTempBranchName).CanonicalName;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    Repo.Network.Push(targetRemote, NewB, options); <span class="comment">//push the branch</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    Repo.Branches.Remove(NewB);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    var removalString = String.Format(<span class="stringliteral">&quot;:{0}&quot;</span>, NewB);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    NewB = null;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    <span class="comment">//we need to delay the second operation a LOT otherwise we get ssh errors</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    Thread.Sleep(10000);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    Repo.Network.Push(targetRemote, removalString, options);   <span class="comment">//delete the branch</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    WriteInfo(<span class="stringliteral">&quot;Pushed reference commit: &quot;</span> + Repo.Head.Tip.Sha, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.ReferencePush);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                }</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                    WriteWarning(String.Format(<span class="stringliteral">&quot;Failed to push reference commit: {0}. Error: {1}&quot;</span>, Repo.Head.Tip.Sha, e.ToString()), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.ReferencePush);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordflow">finally</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="keywordflow">if</span> (NewB != null)</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <span class="comment">//Try to delete the branches regardless</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                            Repo.Branches.Remove(NewB);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        <span class="keywordflow">catch</span> { }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                            Repo.Network.Push(targetRemote, String.Format(<span class="stringliteral">&quot;:{0}&quot;</span>, NewB), options);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        <span class="keywordflow">catch</span> { }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a1f307cfcce4bfa27ff8d7f16947c7498">  646</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a1f307cfcce4bfa27ff8d7f16947c7498">Update</a>(<span class="keywordtype">bool</span> reset)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">return</span> UpdateImpl(reset, <span class="keyword">true</span>);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a607fe93fc7de00f94ff70963de9b5348">  657</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a607fe93fc7de00f94ff70963de9b5348">UpdateImpl</a>(<span class="keywordtype">bool</span> reset, <span class="keywordtype">bool</span> successOnUpToDate)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                var result = LoadRepo();</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    <span class="keywordflow">if</span> (Repo.Head == null || !Repo.Head.IsTracking)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Cannot update while not on a tracked branch&quot;</span>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    var res = Fetch();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    var originBranch = Repo.Head.TrackedBranch;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="keywordflow">if</span> (!successOnUpToDate &amp;&amp; Repo.Head.Tip.Sha == originBranch.Tip.Sha)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        <span class="keywordflow">return</span> RepoErrorUpToDate;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    SendMessage(String.Format(<span class="stringliteral">&quot;REPO: Updating origin branch...{0}&quot;</span>, reset ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;(Merge)&quot;</span>), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="keywordflow">if</span> (reset)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        var error = ResetNoLock(Repo.Head.TrackedBranch);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        UpdateSubmodules();</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        <span class="keywordflow">if</span> (error != null)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(error);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        DeletePRList();</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        WriteInfo(<span class="stringliteral">&quot;Repo hard updated to &quot;</span> + originBranch.Tip.Sha, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoHardUpdate);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        <span class="keywordflow">return</span> error;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    res = MergeBranch(originBranch.FriendlyName, <span class="stringliteral">&quot;Merge origin into current testmerge&quot;</span>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keywordflow">if</span> (!LocalIsRemote())   <span class="comment">//might be fast forward</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        PushTestmergeCommit();</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(res);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    UpdateSubmodules();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    WriteInfo(<span class="stringliteral">&quot;Repo merge updated to &quot;</span> + originBranch.Tip.Sha, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoMergeUpdate);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="keywordflow">catch</span> (Exception E)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    SendMessage(<span class="stringliteral">&quot;REPO: Update failed!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    WriteWarning(String.Format(<span class="stringliteral">&quot;Repo{0} update failed&quot;</span>, reset ? <span class="stringliteral">&quot; hard&quot;</span> : <span class="stringliteral">&quot;&quot;</span>), reset ? <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoHardUpdateFail : <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoMergeUpdateFail);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="keywordflow">return</span> E.ToString();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#afa3c2cfeebe2079f6d35ae257d13fbe4">  712</a></span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#afa3c2cfeebe2079f6d35ae257d13fbe4">UpdateSubmodules</a>()</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            var suo = <span class="keyword">new</span> SubmoduleUpdateOptions</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                Init = <span class="keyword">true</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            };</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> Repo.Submodules)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    Repo.Submodules.Update(I.Name, suo);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <span class="keywordflow">try</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        <span class="comment">//workaround for https://github.com/libgit2/libgit2/issues/3820</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        <span class="comment">//kill off the modules/ folder in .git and try again</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                            <a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html">Helpers</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_helpers.html#a5b1d1510ab671f24b98ecafa79f98c00">DeleteDirectory</a>(String.Format(<span class="stringliteral">&quot;{0}/.git/modules/{1}&quot;</span>, RepoPath, I.Path));</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        <span class="keywordflow">catch</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                        {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                            <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        Repo.Submodules.Update(I.Name, suo);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                        var msg = String.Format(<span class="stringliteral">&quot;I had to reclone submodule {0}. If this is happening a lot find a better hack or fix https://github.com/libgit2/libgit2/issues/3820!&quot;</span>, I.Name);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        SendMessage(String.Format(<span class="stringliteral">&quot;REPO: {0}&quot;</span>, msg), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        WriteWarning(msg, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.Submodule);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    <span class="keywordflow">catch</span> (Exception ex)</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        WriteError(String.Format(<span class="stringliteral">&quot;Failed to update submodule {0}! Error: {1}&quot;</span>, I.Name, ex.ToString()), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.Submodule);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    }</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a6b332d573bb560960d2c55e047ca378c">  753</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a6b332d573bb560960d2c55e047ca378c">CreateBackup</a>()</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                lock (RepoLock)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    var res = LoadRepo();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                        <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    <span class="comment">//Make sure we don&#39;t already have a backup at this commit</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    var HEAD = Repo.Head.Tip.Sha;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    <span class="keywordflow">foreach</span> (var T <span class="keywordflow">in</span> Repo.Tags)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                        <span class="keywordflow">if</span> (T.Target.Sha == HEAD)</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                            <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    var tagName = <span class="stringliteral">&quot;TGS-Compile-Backup-&quot;</span> + DateTime.Now.ToString(<span class="stringliteral">&quot;yyyy-MM-dd--HH.mm.ss&quot;</span>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    var tag = Repo.ApplyTag(tagName);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="keywordflow">if</span> (tag != null)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        WriteInfo(<span class="stringliteral">&quot;Repo backup created at tag: &quot;</span> + tagName + <span class="stringliteral">&quot; commit: &quot;</span> + HEAD, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoBackupTag);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Tag creation failed!&quot;</span>);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                WriteWarning(String.Format(<span class="stringliteral">&quot;Failed backup tag creation at commit {0}!&quot;</span>, Repo.Head.Tip.Sha), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoBackupTagFail);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a7799e81d92bdec8a357d9b3240a202ef">  794</a></span>&#160;        <span class="keyword">public</span> IDictionary&lt;string, string&gt; <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a7799e81d92bdec8a357d9b3240a202ef">ListBackups</a>(out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                lock (RepoLock)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                        error = <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                    }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                    error = LoadRepo();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    <span class="keywordflow">if</span> (error != null)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    var res = <span class="keyword">new</span> Dictionary&lt;string, string&gt;();</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                    <span class="keywordflow">foreach</span> (var T <span class="keywordflow">in</span> Repo.Tags)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                        <span class="keywordflow">if</span> (T.FriendlyName.Contains(<span class="stringliteral">&quot;TGS&quot;</span>))</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                            res.Add(T.FriendlyName, T.Target.Sha);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            }</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                error = e.ToString();</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a76306067d70759b19a58f8b26af86c8d">  824</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a76306067d70759b19a58f8b26af86c8d">Reset</a>(<span class="keywordtype">bool</span> trackedBranch)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                var res = LoadRepo() ?? ResetNoLock(trackedBranch ? (Repo.Head.TrackedBranch ?? Repo.Head) : Repo.Head);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keywordflow">if</span> (res == null)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    SendMessage(String.Format(<span class="stringliteral">&quot;REPO: Hard reset to {0}branch&quot;</span>, trackedBranch ? <span class="stringliteral">&quot;tracked &quot;</span> : <span class="stringliteral">&quot;&quot;</span>), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keywordflow">if</span> (trackedBranch)</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                        DeletePRList();</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    WriteInfo(String.Format(<span class="stringliteral">&quot;Repo branch reset{0}&quot;</span>, trackedBranch ? <span class="stringliteral">&quot; to tracked branch&quot;</span> : <span class="stringliteral">&quot;&quot;</span>), trackedBranch ? <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoResetTracked : <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoReset);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                WriteWarning(String.Format(<span class="stringliteral">&quot;Failed to reset{0}: {1}&quot;</span>, trackedBranch ? <span class="stringliteral">&quot; to tracked branch&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, res), trackedBranch ? <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoResetTrackedFail : <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoResetFail);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aa3ce13d9776a31855262d70d43076b94">  848</a></span>&#160;        Signature <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aa3ce13d9776a31855262d70d43076b94">MakeSig</a>()</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> Signature(<span class="keyword">new</span> Identity(Config.CommitterName, Config.CommitterEmail), DateTimeOffset.Now);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a46b377aeb88f2ecc682c545aaacf1b33">  856</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a46b377aeb88f2ecc682c545aaacf1b33">DeletePRList</a>()</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">if</span> (File.Exists(RelativePath(PRJobFile)))</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    File.Delete(RelativePath(PRJobFile));</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    WriteError(<span class="stringliteral">&quot;Failed to delete PR list: &quot;</span> + e.ToString(), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPRListError);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a20679ec5991fbf42f9fd98e38fc08018">  873</a></span>&#160;        IDictionary&lt;string, IDictionary&lt;string, string&gt;&gt; <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a20679ec5991fbf42f9fd98e38fc08018">GetCurrentPRList</a>()</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordflow">if</span> (!File.Exists(RelativePath(PRJobFile)))</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> Dictionary&lt;<span class="keywordtype">string</span>, IDictionary&lt;string, string&gt;&gt;();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            var rawdata = File.ReadAllText(RelativePath(PRJobFile));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">return</span> JsonConvert.DeserializeObject&lt;IDictionary&lt;string, IDictionary&lt;string, string&gt;&gt;&gt;(rawdata);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#afad1d549f9f3bf36a13bcab8f8c0241a">  885</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#afad1d549f9f3bf36a13bcab8f8c0241a">SetCurrentPRList</a>(IDictionary&lt;<span class="keywordtype">string</span>, IDictionary&lt;string, string&gt;&gt; list)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            var rawdata = JsonConvert.SerializeObject(list, Formatting.Indented);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            File.WriteAllText(RelativePath(PRJobFile), rawdata);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#abf72ba5cdfd2d87d2c9f6030f4cafb20">  892</a></span>&#160;        <span class="keyword">public</span> IEnumerable&lt;string&gt; <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#abf72ba5cdfd2d87d2c9f6030f4cafb20">MergePullRequests</a>(IEnumerable&lt;PullRequestInfo&gt; pullRequestInfos, <span class="keywordtype">bool</span> silent)</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            var results = <span class="keyword">new</span> List&lt;string&gt;();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            var amount = pullRequestInfos.Count();</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">if</span> (amount &lt; 1)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="keywordflow">return</span> results;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">if</span> (!silent) {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                var messages = <span class="keyword">new</span> List&lt;string&gt;();</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> pullRequestInfos)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    var shortSha = I.Sha?.Substring(0, Math.Min(I.Sha.Length, 7));</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    messages.Add(String.Format(<span class="stringliteral">&quot;#{0}{1}&quot;</span>, I.Number, shortSha != null ? String.Format(<span class="stringliteral">&quot; at commit {0}&quot;</span>, shortSha) : shortSha));</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                SendMessage(String.Format(<span class="stringliteral">&quot;REPO: Merging PR{0} {1}...&quot;</span>, amount == 1 ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;s&quot;</span>, String.Join(<span class="stringliteral">&quot;, &quot;</span>, messages)), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordtype">bool</span> foundBad = <span class="keyword">false</span>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> pullRequestInfos)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                var res = MergePullRequest(I.Number, I.Sha, <span class="keyword">true</span>);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    foundBad = <span class="keyword">true</span>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                results.Add(res);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">return</span> foundBad ? results : null;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a22931c5f84cb3691e73c4531d6279f8f">  921</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a22931c5f84cb3691e73c4531d6279f8f">MergePullRequest</a>(<span class="keywordtype">int</span> PRNumber, <span class="keywordtype">string</span> atSHA, <span class="keywordtype">bool</span> silent)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                var result = LoadRepo();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">if</span>(!silent)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                    SendMessage(String.Format(<span class="stringliteral">&quot;REPO: Merging PR #{0}{1}...&quot;</span>, PRNumber, atSHA != null ? String.Format(<span class="stringliteral">&quot; at commit {0}&quot;</span>, atSHA): <span class="stringliteral">&quot;&quot;</span>), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                result = ResetNoLock(null);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    <span class="comment">//only supported with github</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    var remoteUrl = Repo.Network.Remotes[<span class="stringliteral">&quot;origin&quot;</span>].Url;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    <span class="keywordflow">if</span> (!remoteUrl.Contains(<span class="stringliteral">&quot;github.com&quot;</span>))</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Only supported with Github based repositories.&quot;</span>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    var Refspec = <span class="keyword">new</span> List&lt;string&gt;();</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    var PRBranchName = String.Format(<span class="stringliteral">&quot;pr-{0}&quot;</span>, PRNumber);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    var LocalBranchName = String.Format(<span class="stringliteral">&quot;pull/{0}/headrefs/heads/{1}&quot;</span>, PRNumber, PRBranchName);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    Refspec.Add(String.Format(<span class="stringliteral">&quot;pull/{0}/head:{1}&quot;</span>, PRNumber, PRBranchName));</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    var logMessage = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="comment">//Need to delete the branch first in case of rebase</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    Repo.Branches.Remove(LocalBranchName);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    Repo.Branches.Remove(PRBranchName);</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    Commands.Fetch(Repo, <span class="stringliteral">&quot;origin&quot;</span>, Refspec, GenerateFetchOptions(), logMessage);  <span class="comment">//shitty api has no failure state for this</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                    currentProgress = -1;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                    var branch = Repo.Branches[LocalBranchName];</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    <span class="keywordflow">if</span> (branch == null)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                        SendMessage(String.Format(<span class="stringliteral">&quot;REPO: PR {0}could not be fetched. Does it exist?&quot;</span>, silent ? String.Format(<span class="stringliteral">&quot;#{0} &quot;</span>, PRNumber) : <span class="stringliteral">&quot;&quot;</span>), <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        <span class="keywordflow">return</span> String.Format(<span class="stringliteral">&quot;PR #{0} could not be fetched. Does it exist?&quot;</span>, PRNumber);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <span class="comment">//give it a better name</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    branch = Repo.CreateBranch(PRBranchName, branch.Tip);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    Repo.Branches.Remove(LocalBranchName);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    <span class="keywordflow">if</span> (atSHA != null)</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                        <span class="comment">//find the commit</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        Commit commit = null;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        <span class="keywordtype">string</span> error = null;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                            commit = Repo.Lookup&lt;Commit&gt;(atSHA);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                        {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                            error = e.ToString();</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        <span class="keywordflow">if</span> (commit == null)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                        {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                            SendMessage(<span class="stringliteral">&quot;REPO: Commit could not be found, aborting!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                            <span class="keywordflow">return</span> error ?? String.Format(<span class="stringliteral">&quot;Commit {0} could not be found in the repository!&quot;</span>, atSHA);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                        }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    }</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    <span class="comment">//so we&#39;ll know if this fails</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    var Result = MergeBranch(atSHA ?? branch.CanonicalName, String.Format(<span class="stringliteral">&quot;[ci skip] Test merge commit for pull request #{0}{1}Server Instance: {2}&quot;</span>, PRNumber, Environment.NewLine, Config.Name));</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    <span class="keywordflow">if</span> (Result == null)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                            UpdateSubmodules();</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                        }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                        <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                            Result = e.ToString();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                        }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                    <span class="keywordflow">if</span> (Result == null)</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                        WriteInfo(String.Format(<span class="stringliteral">&quot;Merged pull request #{0}&quot;</span>, PRNumber), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPRMerge);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                        <span class="keywordflow">try</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                        {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                            var CurrentPRs = GetCurrentPRList();</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                            var PRNumberString = PRNumber.ToString();</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                            CurrentPRs.Remove(PRNumberString);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                            var newPR = <span class="keyword">new</span> Dictionary&lt;string, string&gt;();</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                            <span class="comment">//do some excellent remote fuckery here to get the api page</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                            var prAPI = remoteUrl;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                            prAPI = prAPI.Replace(<span class="stringliteral">&quot;/.git&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                            prAPI = prAPI.Replace(<span class="stringliteral">&quot;.git&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                            prAPI = prAPI.Replace(<span class="stringliteral">&quot;git:&quot;</span>, <span class="stringliteral">&quot;https:&quot;</span>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                            prAPI = prAPI.Replace(<span class="stringliteral">&quot;github.com&quot;</span>, <span class="stringliteral">&quot;api.github.com/repos&quot;</span>);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                            prAPI += <span class="stringliteral">&quot;/pulls/&quot;</span> + PRNumberString + <span class="stringliteral">&quot;.json&quot;</span>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                            <span class="keywordtype">string</span> json;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                            <span class="keyword">using</span> (var wc = <span class="keyword">new</span> WebClient())</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                            {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                wc.Headers.Add(<span class="stringliteral">&quot;user-agent&quot;</span>, <span class="stringliteral">&quot;TGS.Server&quot;</span>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                json = wc.DownloadString(prAPI);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                            }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                            var dick = JsonConvert.DeserializeObject&lt;IDictionary&lt;string, object&gt;&gt;(json);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            var user = ((JObject)dick[<span class="stringliteral">&quot;user&quot;</span>]).ToObject&lt;IDictionary&lt;string, object&gt;&gt;();</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                            newPR.Add(<span class="stringliteral">&quot;commit&quot;</span>, atSHA ?? branch.Tip.Sha);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                            newPR.Add(<span class="stringliteral">&quot;author&quot;</span>, (<span class="keywordtype">string</span>)user[<span class="stringliteral">&quot;login&quot;</span>]);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                            newPR.Add(<span class="stringliteral">&quot;title&quot;</span>, (<span class="keywordtype">string</span>)dick[<span class="stringliteral">&quot;title&quot;</span>]);</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            CurrentPRs.Add(PRNumberString, newPR);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                            SetCurrentPRList(CurrentPRs);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        }</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                        {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                            WriteError(<span class="stringliteral">&quot;Failed to update PR list&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPRListError);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                            <span class="keywordflow">return</span> <span class="stringliteral">&quot;PR Merged, JSON update failed: &quot;</span> + e.ToString();</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        PushTestmergeCommit();</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    <span class="keywordflow">return</span> Result;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                }</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keywordflow">catch</span> (Exception E)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    SendMessage(<span class="stringliteral">&quot;REPO: PR merge failed!&quot;</span>, <a class="code" href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">MessageType</a>.DeveloperInfo);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    WriteWarning(String.Format(<span class="stringliteral">&quot;Failed to merge pull request #{0}: {1}&quot;</span>, PRNumber, E.ToString()), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPRMergeFail);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    <span class="keywordflow">return</span> E.ToString();</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a2dc1986bc65a5297fa100f84bc2bd3c2"> 1054</a></span>&#160;        <span class="keyword">public</span> List&lt;PullRequestInfo&gt; <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a2dc1986bc65a5297fa100f84bc2bd3c2">MergedPullRequests</a>(out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    error = <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                var result = LoadRepo();</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="keywordflow">if</span> (result != null)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                    error = result;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    var PRRawData = GetCurrentPRList();</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    var output = <span class="keyword">new</span> List&lt;PullRequestInfo&gt;();</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> GetCurrentPRList())</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                        output.Add(<span class="keyword">new</span> <a class="code" href="class_t_g_s_1_1_interface_1_1_pull_request_info.html">PullRequestInfo</a>(Convert.ToInt32(I.Key), I.Value[<span class="stringliteral">&quot;author&quot;</span>], I.Value[<span class="stringliteral">&quot;title&quot;</span>], I.Value[<span class="stringliteral">&quot;commit&quot;</span>]));</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                    error = null;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    <span class="keywordflow">return</span> output;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    error = e.ToString();</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a162aa702f81dabcb2835ba592068355c"> 1087</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a162aa702f81dabcb2835ba592068355c">GetCommitterName</a>()</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">return</span> Config.CommitterName;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#afedbb93ad10a91d4c88c2b2d6c1c97c6"> 1093</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#afedbb93ad10a91d4c88c2b2d6c1c97c6">SetCommitterName</a>(<span class="keywordtype">string</span> newName)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            Config.CommitterName = newName;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            Config.Save();</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#acc0cbef7e2461246199ddb47774b7c4b"> 1100</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#acc0cbef7e2461246199ddb47774b7c4b">GetCommitterEmail</a>()</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        {</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordflow">return</span> Config.CommitterEmail;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        }</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a1bfb2ec6315f04af88bb97297b650b39"> 1106</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a1bfb2ec6315f04af88bb97297b650b39">SetCommitterEmail</a>(<span class="keywordtype">string</span> newEmail)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            Config.CommitterEmail = newEmail;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            Config.Save();</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a8be905dbecf8c22a190e20ab990eded3"> 1113</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a8be905dbecf8c22a190e20ab990eded3">SynchronizePush</a>()</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                var Config = GetCachedRepoConfig();</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">if</span> (Config == null)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Error reading changelog configuration&quot;</span>;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="keywordflow">if</span> (!Config.ChangelogSupport || !SSHAuth())</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                var res = LoadRepo();</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">if</span> (res != null)</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="keywordflow">return</span> LocalIsRemote() ? Commit(Config) ?? Push() : <span class="stringliteral">&quot;Can&#39;t push changelog: HEAD does not match tracked remote branch&quot;</span>;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            }</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        }</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a3a38e27cc6f790355d27a26af68b92e6"> 1135</a></span>&#160;        FetchOptions <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a3a38e27cc6f790355d27a26af68b92e6">GenerateFetchOptions</a>()</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> FetchOptions()</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                CredentialsProvider = GenerateGitCredentials,</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                OnTransferProgress = HandleTransferProgress,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                Prune = <span class="keyword">true</span>,</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            };</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        }</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a2d148a0b4c82814e214f51401ca0626e"> 1149</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a2d148a0b4c82814e214f51401ca0626e">Fetch</a>()</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                <span class="keywordtype">string</span> logMessage = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                var R = Repo.Network.Remotes[<span class="stringliteral">&quot;origin&quot;</span>];</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                IEnumerable&lt;string&gt; refSpecs = R.FetchRefSpecs.Select(X =&gt; X.Specification);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                Commands.Fetch(Repo, R.Name, refSpecs, GenerateFetchOptions(), logMessage);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ae3cfb93eda91ea124d29375bae70b37b"> 1169</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ae3cfb93eda91ea124d29375bae70b37b">LocalIsRemote</a>()</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                <span class="keywordflow">if</span> (LoadRepo() != null)</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <span class="keywordflow">if</span> (Fetch() != null)</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    <span class="keywordflow">return</span> Repo.Head.IsTracking &amp;&amp; Repo.Head.TrackedBranch.Tip.Sha == Repo.Head.Tip.Sha;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <span class="keywordflow">catch</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aaddf123cd4c3ceec4b4f8734bf4da456"> 1195</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aaddf123cd4c3ceec4b4f8734bf4da456">Commit</a>(<a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html">RepoConfig</a> Config)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="comment">// Stage the file</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                <span class="keywordflow">foreach</span> (var I <span class="keywordflow">in</span> Config.<a class="code" href="class_t_g_s_1_1_server_1_1_repo_config.html#a705cad9d519808587ace7579ec25a5e3">PathsToStage</a>)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                    Commands.Stage(Repo, I);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <span class="keywordflow">if</span> (Repo.RetrieveStatus().Staged.Count() == 0)   <span class="comment">//nothing to commit</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                <span class="comment">// Create the committer&#39;s signature and commit</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                var authorandcommitter = MakeSig();</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <span class="comment">// Commit to the repository</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                WriteInfo(String.Format(<span class="stringliteral">&quot;Commit {0} created from changelogs&quot;</span>, Repo.Commit(CommitMessage, authorandcommitter, authorandcommitter)), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoCommit);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                DeletePRList();</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            }</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                WriteWarning(<span class="stringliteral">&quot;Repo commit failed: &quot;</span> + e.ToString(), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoCommitFail);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            }</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a425b98c157a0fd03f603a1ee19a73ea8"> 1225</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a425b98c157a0fd03f603a1ee19a73ea8">Push</a>()</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                var options = <span class="keyword">new</span> PushOptions()</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                {</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    CredentialsProvider = GenerateGitCredentials,</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                };</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                Repo.Network.Push(Repo.Network.Remotes[SSHPushRemote], Repo.Head.CanonicalName, options);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                WriteInfo(<span class="stringliteral">&quot;Repo pushed up to commit: &quot;</span> + Repo.Head.Tip.Sha, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPush);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                WriteWarning(<span class="stringliteral">&quot;Repo push failed: &quot;</span> + e.ToString(), <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoPushFail);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                <span class="keywordflow">return</span> e.ToString();</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a7307d215fbff6e1ed02c818cddb1e455"> 1248</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a7307d215fbff6e1ed02c818cddb1e455">SSHAuth</a>()</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;            <span class="keywordflow">return</span> File.Exists(RelativePath(PrivateKeyPath)) &amp;&amp; File.Exists(RelativePath(PublicKeyPath));</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a5d3fc0a44c753811f92e13d02de32c0f"> 1260</a></span>&#160;        Credentials <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a5d3fc0a44c753811f92e13d02de32c0f">GenerateGitCredentials</a>(<span class="keywordtype">string</span> url, <span class="keywordtype">string</span> usernameFromUrl, SupportedCredentialTypes types)</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            var user = usernameFromUrl ?? <span class="stringliteral">&quot;git&quot;</span>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">if</span> (types == SupportedCredentialTypes.UsernameQuery)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">new</span> UsernameQueryCredentials()</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                    Username = user,</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                };</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> SshUserKeyCredentials()</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                Username = user,</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                PrivateKey = RelativePath(PrivateKeyPath),</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                PublicKey = RelativePath(PublicKeyPath),</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                Passphrase = <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            };</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#a3888e58764d94b814d9e5493073ac318"> 1278</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#a3888e58764d94b814d9e5493073ac318">GenerateChangelog</a>(out <span class="keywordtype">string</span> error)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="keywordflow">return</span> GenerateChangelogImpl(out error);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#ae09f4c1eea6852df2b225af315c2d4b1"> 1289</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#ae09f4c1eea6852df2b225af315c2d4b1">GenerateChangelogImpl</a>(out <span class="keywordtype">string</span> error, <span class="keywordtype">bool</span> recurse = <span class="keyword">false</span>)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            var RConfig = GetCachedRepoConfig();</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            <span class="keywordflow">if</span> (RConfig == null)</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                error = null;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;Error loading changelog config!&quot;</span>;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            }</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <span class="keywordflow">if</span> (!RConfig.ChangelogSupport)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                error = null;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            <span class="keywordtype">string</span> ChangelogPy = RConfig.PathToChangelogPy;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="keywordflow">if</span> (!Exists())</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            {</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                error = <span class="stringliteral">&quot;Repo does not exist!&quot;</span>;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            }</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            lock (RepoLock)</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">if</span> (RepoBusy)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    error = <span class="stringliteral">&quot;Repo is busy!&quot;</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                }</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                <span class="keywordflow">if</span> (!File.Exists(Path.Combine(RelativePath(RepoPath), ChangelogPy)))</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    error = <span class="stringliteral">&quot;Missing changelog generation script!&quot;</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                }</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                var pp = <a class="code" href="class_t_g_s_1_1_server_1_1_server.html">Server</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_server.html#adc8b0e2ed7eaa12ae89d661912a01e50">Config</a>.<a class="code" href="class_t_g_s_1_1_server_1_1_server_config.html#a4e036d3f118d402cd705d9ec7386d3c8">PythonPath</a>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                var PythonFile = Path.Combine(pp, <span class="stringliteral">&quot;python.exe&quot;</span>);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                <span class="keywordflow">if</span> (!File.Exists(PythonFile))</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                    error = <span class="stringliteral">&quot;Cannot locate python!&quot;</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                {</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                    <span class="keywordtype">string</span> result;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    <span class="keywordtype">int</span> exitCode;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                    <span class="keyword">using</span> (var python = <span class="keyword">new</span> Process())</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                        python.StartInfo.FileName = PythonFile;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                        python.StartInfo.Arguments = String.Format(<span class="stringliteral">&quot;{0} {1}&quot;</span>, ChangelogPy, RConfig.ChangelogPyArguments);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                        python.StartInfo.UseShellExecute = <span class="keyword">false</span>;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                        python.StartInfo.WorkingDirectory = <span class="keyword">new</span> DirectoryInfo(RelativePath(RepoPath)).FullName;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                        python.StartInfo.RedirectStandardOutput = <span class="keyword">true</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                        python.StartInfo.RedirectStandardError = <span class="keyword">true</span>;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                        python.Start();</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        <span class="keyword">using</span> (StreamReader reader = python.StandardOutput)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                            result = reader.ReadToEnd();</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        <span class="keyword">using</span> (StreamReader reader = python.StandardError)</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                            result += reader.ReadToEnd();</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                        python.WaitForExit();</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                        exitCode = python.ExitCode;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    <span class="keywordflow">if</span> (exitCode != 0)</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                        <span class="keywordflow">if</span> (recurse || RConfig.PipDependancies.Count == 0)</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                        {</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                            error = <span class="stringliteral">&quot;Script failed!&quot;</span>;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                        <span class="comment">//update pip deps and try again</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                        <span class="keywordtype">string</span> PipFile = Path.Combine(pp, <span class="stringliteral">&quot;scripts&quot;</span>, <span class="stringliteral">&quot;pip.exe&quot;</span>);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                        <span class="keywordflow">foreach</span>(var I <span class="keywordflow">in</span> RConfig.PipDependancies)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                            <span class="keyword">using</span> (var pip = <span class="keyword">new</span> Process())</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                            {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                pip.StartInfo.FileName = PipFile;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                pip.StartInfo.Arguments = <span class="stringliteral">&quot;install &quot;</span> + I;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                pip.StartInfo.UseShellExecute = <span class="keyword">false</span>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                pip.StartInfo.RedirectStandardOutput = <span class="keyword">true</span>;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                pip.StartInfo.RedirectStandardError = <span class="keyword">true</span>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                pip.Start();</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                <span class="keyword">using</span> (StreamReader reader = pip.StandardOutput)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                    result += <span class="stringliteral">&quot;\r\n---BEGIN-PIP-OUTPUT---\r\n&quot;</span> + reader.ReadToEnd();</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                <span class="keyword">using</span> (StreamReader reader = pip.StandardError)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                    result += reader.ReadToEnd();</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                pip.WaitForExit();</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                <span class="keywordflow">if</span> (pip.ExitCode != 0)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                {</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                    error = <span class="stringliteral">&quot;Script and pip failed!&quot;</span>;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                            }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        <span class="comment">//and recurse</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        <span class="keywordflow">return</span> GenerateChangelogImpl(out error, <span class="keyword">true</span>);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    error = null;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                    WriteInfo(<span class="stringliteral">&quot;Changelog generated&quot;</span> + error, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoChangelog);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                <span class="keywordflow">catch</span> (Exception e)</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    error = e.ToString();</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                    WriteWarning(<span class="stringliteral">&quot;Changelog generation failed: &quot;</span> + error, <a class="code" href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">EventID</a>.RepoChangelogFail);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        }</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aa4fa38c2c05e7bd4e3f88fc3dc22254f"> 1397</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aa4fa38c2c05e7bd4e3f88fc3dc22254f">SetAutoUpdateInterval</a>(ulong newInterval)</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        {</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            lock (autoUpdateTimer)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                autoUpdateTimer.Stop();</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                <span class="keywordflow">if</span> (newInterval &gt; 0) {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    autoUpdateTimer.Interval = newInterval * 60 * 1000; <span class="comment">//convert from minutes to ms</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    autoUpdateTimer.Start();</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            }</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            Config.AutoUpdateInterval = newInterval;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            Config.Save();</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#af986654609d219604051007dd6c086df"> 1412</a></span>&#160;        <span class="keyword">public</span> ulong <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#af986654609d219604051007dd6c086df">AutoUpdateInterval</a>()</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            <span class="keywordflow">return</span> Config.AutoUpdateInterval;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        </div><div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aa2e43abfda9bace7682d7d583ad7398a"> 1422</a></span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aa2e43abfda9bace7682d7d583ad7398a">AutoUpdateTimer_Elapsed</a>(<span class="keywordtype">object</span> sender, <a class="code" href="namespace_system.html">System</a>.Timers.ElapsedEventArgs e)</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">if</span> (UpdateImpl(<span class="keyword">true</span>, <span class="keyword">false</span>) == null)</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                Compile(<span class="keyword">true</span>);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aac0300d04759251f1a83dd9f37c165c9"> 1434</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aac0300d04759251f1a83dd9f37c165c9">UpdateLiveSha</a>(<span class="keywordtype">string</span> newSha)</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">if</span> (LoadRepo() != null)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            var B = Repo.Branches[LiveTrackingBranch];</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="keywordflow">if</span> (B != null)</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                Repo.Branches.Remove(B);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            Repo.CreateBranch(LiveTrackingBranch, newSha);      </div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aefd0e4e22081841d4169b583d29d92f0"> 1448</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aefd0e4e22081841d4169b583d29d92f0">LiveSha</a>()</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            var B = Repo.Branches[LiveTrackingBranch];</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordflow">return</span> B != null ? B.Tip.Sha : <span class="stringliteral">&quot;UNKNOWN&quot;</span>;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#aa744293f90ea34372f3e489d2ca2cf7a"> 1455</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#aa744293f90ea34372f3e489d2ca2cf7a">PushTestmergeCommits</a>()</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        {</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <span class="keywordflow">return</span> Config.PushTestmergeCommits;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        }</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="class_t_g_s_1_1_server_1_1_instance.html#af6e9f04936092063dacb3d6caa23dfb2"> 1461</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_t_g_s_1_1_server_1_1_instance.html#af6e9f04936092063dacb3d6caa23dfb2">SetPushTestmergeCommits</a>(<span class="keywordtype">bool</span> newValue)</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            Config.PushTestmergeCommits = newValue;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            Config.Save();</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div><div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ac4b0aee9af3f27ca17b0066daf07287d"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ac4b0aee9af3f27ca17b0066daf07287d">TGS.Server.Instance.Setup</a></div><div class="ttdeci">string Setup(string RepoURL, string BranchName)</div><div class="ttdoc">Deletes whatever may be left over and clones the repo at remote  and checks out branch ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00382">Repository.cs:382</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_af6e9f04936092063dacb3d6caa23dfb2"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#af6e9f04936092063dacb3d6caa23dfb2">TGS.Server.Instance.SetPushTestmergeCommits</a></div><div class="ttdeci">void SetPushTestmergeCommits(bool newValue)</div><div class="ttdoc">Set if we push a temporary branch to the remote when we make testmerge commits  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01461">Repository.cs:1461</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ab58aae42424613af52009f69695d6f93"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ab58aae42424613af52009f69695d6f93">TGS.Server.Instance.GetBranch</a></div><div class="ttdeci">string GetBranch(out string error)</div><div class="ttdoc">Gets the name of the current branch  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00462">Repository.cs:462</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a76306067d70759b19a58f8b26af86c8d"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a76306067d70759b19a58f8b26af86c8d">TGS.Server.Instance.Reset</a></div><div class="ttdeci">string Reset(bool trackedBranch)</div><div class="ttdoc">Runs git reset hard  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00824">Repository.cs:824</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a40fc1ed9ca23a8c0d6a51521e91f66ef"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a40fc1ed9ca23a8c0d6a51521e91f66ef">TGS.Server.Instance.InitRepo</a></div><div class="ttdeci">void InitRepo()</div><div class="ttdoc">Initializes the repository </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00100">Repository.cs:100</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_interface_1_1_server_html"><div class="ttname"><a href="class_t_g_s_1_1_interface_1_1_server.html">TGS.Interface.Server</a></div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_interface_2_server_8cs_source.html#l00008">Server.cs:8</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aa744293f90ea34372f3e489d2ca2cf7a"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aa744293f90ea34372f3e489d2ca2cf7a">TGS.Server.Instance.PushTestmergeCommits</a></div><div class="ttdeci">bool PushTestmergeCommits()</div><div class="ttdoc">Check if we push a temporary branch to the remote when we make testmerge commits  ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01455">Repository.cs:1455</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a22931c5f84cb3691e73c4531d6279f8f"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a22931c5f84cb3691e73c4531d6279f8f">TGS.Server.Instance.MergePullRequest</a></div><div class="ttdeci">string MergePullRequest(int PRNumber, string atSHA, bool silent)</div><div class="ttdoc">Merges the target pull request into the current branch if the remote is a github repository  ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00921">Repository.cs:921</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_af986654609d219604051007dd6c086df"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#af986654609d219604051007dd6c086df">TGS.Server.Instance.AutoUpdateInterval</a></div><div class="ttdeci">ulong AutoUpdateInterval()</div><div class="ttdoc">Get the current autoupdate interval  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01412">Repository.cs:1412</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a6388054e24e414ef49593fa51ce0ae24"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a6388054e24e414ef49593fa51ce0ae24">TGS.Server.Instance.CheckoutProgress</a></div><div class="ttdeci">int CheckoutProgress()</div><div class="ttdoc">Gets the progress of repository operations, not all operations are supported  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00146">Repository.cs:146</a></div></div>
<div class="ttc" id="namespace_t_g_s_1_1_interface_html"><div class="ttname"><a href="namespace_t_g_s_1_1_interface.html">TGS.Interface</a></div><div class="ttdef"><b>Definition:</b> <a href="_authentication_header_applicator_8cs_source.html#l00009">AuthenticationHeaderApplicator.cs:9</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_abf1b05ba88199291ea366ffec194d3d7"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#abf1b05ba88199291ea366ffec194d3d7">TGS.Server.Instance.HandleCheckoutProgress</a></div><div class="ttdeci">void HandleCheckoutProgress(string path, int completedSteps, int totalSteps)</div><div class="ttdoc">Updates currentProgress with the progess of the current Repo checkout operation </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00208">Repository.cs:208</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a1bfb2ec6315f04af88bb97297b650b39"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a1bfb2ec6315f04af88bb97297b650b39">TGS.Server.Instance.SetCommitterEmail</a></div><div class="ttdeci">void SetCommitterEmail(string newEmail)</div><div class="ttdoc">Sets the email of the configured git committer  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01106">Repository.cs:1106</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aa3ce13d9776a31855262d70d43076b94"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aa3ce13d9776a31855262d70d43076b94">TGS.Server.Instance.MakeSig</a></div><div class="ttdeci">Signature MakeSig()</div><div class="ttdoc">Creates a commit LibGit2Sharp.Signature based off of the configured name and e-mail ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00848">Repository.cs:848</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a607fe93fc7de00f94ff70963de9b5348"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a607fe93fc7de00f94ff70963de9b5348">TGS.Server.Instance.UpdateImpl</a></div><div class="ttdeci">string UpdateImpl(bool reset, bool successOnUpToDate)</div><div class="ttdoc">Fetches the origin and merges it into the current branch </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00657">Repository.cs:657</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a29a3c86b836454d030d1ea31a7a6faf9"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a29a3c86b836454d030d1ea31a7a6faf9">TGS.Server.Instance.InitialConfigureRepository</a></div><div class="ttdeci">void InitialConfigureRepository()</div><div class="ttdoc">Initial setup for the StaticDirs and CachedTGS3SettingsPath </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00339">Repository.cs:339</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a162aa702f81dabcb2835ba592068355c"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a162aa702f81dabcb2835ba592068355c">TGS.Server.Instance.GetCommitterName</a></div><div class="ttdeci">string GetCommitterName()</div><div class="ttdoc">Gets the name of the configured git committer  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01087">Repository.cs:1087</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aa279ed5a9e086c8ce04c4af07be0fe51"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aa279ed5a9e086c8ce04c4af07be0fe51">TGS.Server.Instance.RepoConfigsMatch</a></div><div class="ttdeci">bool RepoConfigsMatch()</div><div class="ttdoc">Checks if the CachedTGS3SettingsPath and RepoTGS3SettingsPath json files match. </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00116">Repository.cs:116</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a5956aa08c166860be43e49e2378cd383"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a5956aa08c166860be43e49e2378cd383">TGS.Server.Instance.BackupAndDeleteStaticDirectory</a></div><div class="ttdeci">void BackupAndDeleteStaticDirectory()</div><div class="ttdoc">Copies the Static directory to the first available Static_BACKUP path in the Instance then deleted th...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00294">Repository.cs:294</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_afad1d549f9f3bf36a13bcab8f8c0241a"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#afad1d549f9f3bf36a13bcab8f8c0241a">TGS.Server.Instance.SetCurrentPRList</a></div><div class="ttdeci">void SetCurrentPRList(IDictionary&lt; string, IDictionary&lt; string, string &gt;&gt; list)</div><div class="ttdoc">Serializes pull request info into PRJobFile </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00885">Repository.cs:885</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ae3cfb93eda91ea124d29375bae70b37b"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ae3cfb93eda91ea124d29375bae70b37b">TGS.Server.Instance.LocalIsRemote</a></div><div class="ttdeci">bool LocalIsRemote()</div><div class="ttdoc">Check if the current HEAD matches the tracked remote branch HEAD </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01169">Repository.cs:1169</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_interface_1_1_instance_html"><div class="ttname"><a href="class_t_g_s_1_1_interface_1_1_instance.html">TGS.Interface.Instance</a></div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_interface_2_instance_8cs_source.html#l00008">Instance.cs:8</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_abb80352fb834bb68a8eaa19458769dfe"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#abb80352fb834bb68a8eaa19458769dfe">TGS.Server.Instance.GetShaOrBranch</a></div><div class="ttdeci">string GetShaOrBranch(out string error, bool branch, bool tracked)</div><div class="ttdoc">Gets the SHA or branch name of the Repo&amp;#39;s HEAD </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00412">Repository.cs:412</a></div></div>
<div class="ttc" id="namespace_lib_git2_sharp_html"><div class="ttname"><a href="namespace_lib_git2_sharp.html">LibGit2Sharp</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_repo_config_html"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_repo_config.html">TGS.Server.RepoConfig</a></div><div class="ttdoc">Repository specific information for a Instance </div><div class="ttdef"><b>Definition:</b> <a href="_repo_config_8cs_source.html#l00013">RepoConfig.cs:13</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a32f473cc0c8d3f91c6fe8927fe927996"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a32f473cc0c8d3f91c6fe8927fe927996">TGS.Server.Instance.MergeBranch</a></div><div class="ttdeci">string MergeBranch(string committish, string mergeMessage)</div><div class="ttdoc">Merges given committish  into the current branch </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00570">Repository.cs:570</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a7307d215fbff6e1ed02c818cddb1e455"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a7307d215fbff6e1ed02c818cddb1e455">TGS.Server.Instance.SSHAuth</a></div><div class="ttdeci">bool SSHAuth()</div><div class="ttdoc">Check if the Instance is configured for SSH pushing </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01248">Repository.cs:1248</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a7ca212db696b8c01419fd60902b98378"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a7ca212db696b8c01419fd60902b98378">TGS.Server.Instance.DisposeRepo</a></div><div class="ttdeci">void DisposeRepo()</div><div class="ttdoc">Cleans up Repo </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00175">Repository.cs:175</a></div></div>
<div class="ttc" id="namespace_t_g_s_html"><div class="ttname"><a href="namespace_t_g_s.html">TGS</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a46b377aeb88f2ecc682c545aaacf1b33"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a46b377aeb88f2ecc682c545aaacf1b33">TGS.Server.Instance.DeletePRList</a></div><div class="ttdeci">void DeletePRList()</div><div class="ttdoc">Deletes the Instance&amp;#39;s PRJobFile </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00856">Repository.cs:856</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ac3c034d54751b0cc2c76a77232e4a15e"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ac3c034d54751b0cc2c76a77232e4a15e">TGS.Server.Instance.OperationInProgress</a></div><div class="ttdeci">bool OperationInProgress()</div><div class="ttdoc">If the repo is currently undergoing an operation  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00139">Repository.cs:139</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aac0300d04759251f1a83dd9f37c165c9"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aac0300d04759251f1a83dd9f37c165c9">TGS.Server.Instance.UpdateLiveSha</a></div><div class="ttdeci">void UpdateLiveSha(string newSha)</div><div class="ttdoc">Updates LiveTrackingBranch with the staged Compile(bool)&amp;#39;s SHA </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01434">Repository.cs:1434</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a3a38e27cc6f790355d27a26af68b92e6"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a3a38e27cc6f790355d27a26af68b92e6">TGS.Server.Instance.GenerateFetchOptions</a></div><div class="ttdeci">FetchOptions GenerateFetchOptions()</div><div class="ttdoc">Create FetchOptions that Prune and have the appropriate credentials and progress handler ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01135">Repository.cs:1135</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a6107dd2858d2a2c70cb9ac7d5105d373"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a6107dd2858d2a2c70cb9ac7d5105d373">TGS.Server.Instance.ResetNoLock</a></div><div class="ttdeci">string ResetNoLock(Branch targetBranch)</div><div class="ttdoc">Equivalent of running git reset --hard on the repository. Requires RepoLock </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00493">Repository.cs:493</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_repo_config_html_a705cad9d519808587ace7579ec25a5e3"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_repo_config.html#a705cad9d519808587ace7579ec25a5e3">TGS.Server.RepoConfig.PathsToStage</a></div><div class="ttdeci">readonly IList&lt; string &gt; PathsToStage</div><div class="ttdoc">Paths to commit and push to the remote repository </div><div class="ttdef"><b>Definition:</b> <a href="_repo_config_8cs_source.html#l00034">RepoConfig.cs:34</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a2dc1986bc65a5297fa100f84bc2bd3c2"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a2dc1986bc65a5297fa100f84bc2bd3c2">TGS.Server.Instance.MergedPullRequests</a></div><div class="ttdeci">List&lt; PullRequestInfo &gt; MergedPullRequests(out string error)</div><div class="ttdoc">Get the currently merged pull requests. Note that switching branches will delete this list and switch...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01054">Repository.cs:1054</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ae09f4c1eea6852df2b225af315c2d4b1"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ae09f4c1eea6852df2b225af315c2d4b1">TGS.Server.Instance.GenerateChangelogImpl</a></div><div class="ttdeci">string GenerateChangelogImpl(out string error, bool recurse=false)</div><div class="ttdoc">Updates the html changelog </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01289">Repository.cs:1289</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_helpers_html_a5b1d1510ab671f24b98ecafa79f98c00"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_helpers.html#a5b1d1510ab671f24b98ecafa79f98c00">TGS.Server.Helpers.DeleteDirectory</a></div><div class="ttdeci">static void DeleteDirectory(string path, bool ContentsOnly=false, IList&lt; string &gt; excludeRoot=null)</div><div class="ttdoc">Recursive directory deleter </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_helpers_8cs_source.html#l00038">Helpers.cs:38</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_af5b6c24c3b6a500397c482cbe2739790"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#af5b6c24c3b6a500397c482cbe2739790">TGS.Server.Instance.GetHead</a></div><div class="ttdeci">string GetHead(bool useTracked, out string error)</div><div class="ttdoc">Gets the sha of the current HEAD  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00456">Repository.cs:456</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_helpers_html_a5c7123b266b9815f4ef6247a0b21387c"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_helpers.html#a5c7123b266b9815f4ef6247a0b21387c">TGS.Server.Helpers.CopyDirectory</a></div><div class="ttdeci">static void CopyDirectory(string sourceDirName, string destDirName, IList&lt; string &gt; ignore=null, bool ignoreIfNotExists=false)</div><div class="ttdoc">Recusively copy a directory </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_helpers_8cs_source.html#l00128">Helpers.cs:128</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a3888e58764d94b814d9e5493073ac318"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a3888e58764d94b814d9e5493073ac318">TGS.Server.Instance.GenerateChangelog</a></div><div class="ttdeci">string GenerateChangelog(out string error)</div><div class="ttdoc">Updates the html changelog  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01278">Repository.cs:1278</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_afedbb93ad10a91d4c88c2b2d6c1c97c6"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#afedbb93ad10a91d4c88c2b2d6c1c97c6">TGS.Server.Instance.SetCommitterName</a></div><div class="ttdeci">void SetCommitterName(string newName)</div><div class="ttdoc">Sets the name of the configured git committer  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01093">Repository.cs:1093</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ae59778f28034fa3b6dd2abec09536f6e"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ae59778f28034fa3b6dd2abec09536f6e">TGS.Server.Instance.Repo</a></div><div class="ttdeci">Repository Repo</div><div class="ttdoc">The repository object </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00083">Repository.cs:83</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a425b98c157a0fd03f603a1ee19a73ea8"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a425b98c157a0fd03f603a1ee19a73ea8">TGS.Server.Instance.Push</a></div><div class="ttdeci">string Push()</div><div class="ttdoc">Push HEAD to SSHPushRemote. Requires repo be locked, LoadRepo, LocalIsRemote, and SSHAuth ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01225">Repository.cs:1225</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aaddf123cd4c3ceec4b4f8734bf4da456"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aaddf123cd4c3ceec4b4f8734bf4da456">TGS.Server.Instance.Commit</a></div><div class="ttdeci">string Commit(RepoConfig Config)</div><div class="ttdoc">Create a commit based on a Config . Requires RepoLock and LoadRepo </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01195">Repository.cs:1195</a></div></div>
<div class="ttc" id="interface_t_g_s_1_1_interface_1_1_components_1_1_i_t_g_repository_html"><div class="ttname"><a href="interface_t_g_s_1_1_interface_1_1_components_1_1_i_t_g_repository.html">TGS.Interface.Components.ITGRepository</a></div><div class="ttdoc">Interface for managing the code repository </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_interface_2_components_2_repository_8cs_source.html#l00010">Repository.cs:10</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a42e57a4aa98fefe7c844ada8d6f2eb9a"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a42e57a4aa98fefe7c844ada8d6f2eb9a">TGS.Server.Instance.GetCachedRepoConfig</a></div><div class="ttdeci">RepoConfig GetCachedRepoConfig()</div><div class="ttdoc">Gets the RepoConfig for CachedTGS3SettingsPath </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00133">Repository.cs:133</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a20679ec5991fbf42f9fd98e38fc08018"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a20679ec5991fbf42f9fd98e38fc08018">TGS.Server.Instance.GetCurrentPRList</a></div><div class="ttdeci">IDictionary&lt; string, IDictionary&lt; string, string &gt; &gt; GetCurrentPRList()</div><div class="ttdoc">Deserializes the PRJobFile </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00873">Repository.cs:873</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a17149c71ad3f539181c44db6b9d17370"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a17149c71ad3f539181c44db6b9d17370">TGS.Server.Instance.PushTestmergeCommit</a></div><div class="ttdeci">void PushTestmergeCommit()</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00598">Repository.cs:598</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ac49fce1ca9d542dca6992318c1c94855"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ac49fce1ca9d542dca6992318c1c94855">TGS.Server.Instance.Checkout</a></div><div class="ttdeci">string Checkout(string sha)</div><div class="ttdoc">Hard checks out the passed object name  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00510">Repository.cs:510</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_server_html_adc8b0e2ed7eaa12ae89d661912a01e50"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_server.html#adc8b0e2ed7eaa12ae89d661912a01e50">TGS.Server.Server.Config</a></div><div class="ttdeci">static ServerConfig Config</div><div class="ttdoc">The ServerConfig for the Server </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_server_8cs_source.html#l00043">Server.cs:43</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_ae37cbe097d7326ff0432bcd39ffce488"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#ae37cbe097d7326ff0432bcd39ffce488">TGS.Server.Instance.DisableGarbageCollectionNoLock</a></div><div class="ttdeci">void DisableGarbageCollectionNoLock()</div><div class="ttdoc">Turns off the gc.auto git config setting </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00286">Repository.cs:286</a></div></div>
<div class="ttc" id="_t_g_s_8_command_line_2_program_8cs_html_a81a223a02c34d82b47199f08308847f2"><div class="ttname"><a href="_t_g_s_8_command_line_2_program_8cs.html#a81a223a02c34d82b47199f08308847f2">System</a></div><div class="ttdeci">using System</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_command_line_2_program_8cs_source.html#l00001">Program.cs:1</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aa4fa38c2c05e7bd4e3f88fc3dc22254f"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aa4fa38c2c05e7bd4e3f88fc3dc22254f">TGS.Server.Instance.SetAutoUpdateInterval</a></div><div class="ttdeci">void SetAutoUpdateInterval(ulong newInterval)</div><div class="ttdoc">(De)Activate and set the interval for the automatic server updater  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01397">Repository.cs:1397</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a1f4b564db63526863dacc273a6715801"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a1f4b564db63526863dacc273a6715801">TGS.Server.Instance.UpdateTGS3Json</a></div><div class="ttdeci">string UpdateTGS3Json()</div><div class="ttdoc">Updates the CachedTGS3SettingsPath with the RepoTGS3SettingsPath </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00320">Repository.cs:320</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_afa3c2cfeebe2079f6d35ae257d13fbe4"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#afa3c2cfeebe2079f6d35ae257d13fbe4">TGS.Server.Instance.UpdateSubmodules</a></div><div class="ttdeci">void UpdateSubmodules()</div><div class="ttdoc">Properly updates any git submodules in the repository </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00712">Repository.cs:712</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a3443b6d7f6b2481e21e8c7a63c429221"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a3443b6d7f6b2481e21e8c7a63c429221">TGS.Server.Instance.Clone</a></div><div class="ttdeci">void Clone(object twostrings)</div><div class="ttdoc">Backups up the StaticDirs and deletes the current RepoPath if they exist. Clones the given branch of ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00217">Repository.cs:217</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_abf72ba5cdfd2d87d2c9f6030f4cafb20"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#abf72ba5cdfd2d87d2c9f6030f4cafb20">TGS.Server.Instance.MergePullRequests</a></div><div class="ttdeci">IEnumerable&lt; string &gt; MergePullRequests(IEnumerable&lt; PullRequestInfo &gt; pullRequestInfos, bool silent)</div><div class="ttdoc">Merges the target pull requests into the current branch if the remote is a github repository  ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00892">Repository.cs:892</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a1f307cfcce4bfa27ff8d7f16947c7498"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a1f307cfcce4bfa27ff8d7f16947c7498">TGS.Server.Instance.Update</a></div><div class="ttdeci">string Update(bool reset)</div><div class="ttdoc">Fetches the origin and merges it into the current branch  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00646">Repository.cs:646</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_acc0cbef7e2461246199ddb47774b7c4b"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#acc0cbef7e2461246199ddb47774b7c4b">TGS.Server.Instance.GetCommitterEmail</a></div><div class="ttdeci">string GetCommitterEmail()</div><div class="ttdoc">Gets the email of the configured git committer  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01100">Repository.cs:1100</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a8f55a135fbd9335e91378dc08239d139"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a8f55a135fbd9335e91378dc08239d139">TGS.Server.Instance.GetShaOrBranchNoLock</a></div><div class="ttdeci">string GetShaOrBranchNoLock(out string error, bool branch, bool tracked)</div><div class="ttdoc">Gets the SHA or branch name of the Repo&amp;#39;s HEAD. Requires RepoLock </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00432">Repository.cs:432</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_server_config_html_a4e036d3f118d402cd705d9ec7386d3c8"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_server_config.html#a4e036d3f118d402cd705d9ec7386d3c8">TGS.Server.ServerConfig.PythonPath</a></div><div class="ttdeci">string PythonPath</div><div class="ttdoc">Path to the directory containing the Python2.7 installation </div><div class="ttdef"><b>Definition:</b> <a href="_server_config_8cs_source.html#l00041">ServerConfig.cs:41</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_interface_1_1_pull_request_info_html"><div class="ttname"><a href="class_t_g_s_1_1_interface_1_1_pull_request_info.html">TGS.Interface.PullRequestInfo</a></div><div class="ttdoc">Information about a pull request </div><div class="ttdef"><b>Definition:</b> <a href="_pull_request_info_8cs_source.html#l00009">PullRequestInfo.cs:9</a></div></div>
<div class="ttc" id="namespace_t_g_s_1_1_server_html_a4682739b9567dc9e4e5c327c253ce311"><div class="ttname"><a href="namespace_t_g_s_1_1_server.html#a4682739b9567dc9e4e5c327c253ce311">TGS.Server.EventID</a></div><div class="ttdeci">EventID</div><div class="ttdoc">Various events and their IDs in no particular order. Found in the Windows event log. These key incremented by 100 and are guaranteed to never be reused in the future. In the windows event viewer, these IDs will be offset by the Instance.LoggingID to distinguish events between instances. Each event ID may be information, a warning, or error and will be documented accordingly. Warnings will occur due to user, data, or network errors. Errors will occur due to filesystem errors or hard faults </div><div class="ttdef"><b>Definition:</b> <a href="_event_i_d_8cs_source.html#l00008">EventID.cs:8</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a8170aa201e010210c23b5f6bb75b19ba"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a8170aa201e010210c23b5f6bb75b19ba">TGS.Server.Instance.LoadRepo</a></div><div class="ttdeci">string LoadRepo()</div><div class="ttdoc">Initializes Repo </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00155">Repository.cs:155</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_helpers_html"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_helpers.html">TGS.Server.Helpers</a></div><div class="ttdoc">Generic helpers for the Server </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_helpers_8cs_source.html#l00013">Helpers.cs:13</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a2ec78124dea785dbd28b9dec109eb909"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a2ec78124dea785dbd28b9dec109eb909">TGS.Server.Instance.HandleTransferProgress</a></div><div class="ttdeci">bool HandleTransferProgress(TransferProgress progress)</div><div class="ttdoc">Updates currentProgress with the progess of the current Repo transfer operation </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00196">Repository.cs:196</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_abeac01eeeff769611c0191173076f0e0"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#abeac01eeeff769611c0191173076f0e0">TGS.Server.Instance.GetRemote</a></div><div class="ttdeci">string GetRemote(out string error)</div><div class="ttdoc">Gets the url of the current origin  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00468">Repository.cs:468</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a2d148a0b4c82814e214f51401ca0626e"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a2d148a0b4c82814e214f51401ca0626e">TGS.Server.Instance.Fetch</a></div><div class="ttdeci">string Fetch()</div><div class="ttdoc">Fetches origin </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01149">Repository.cs:1149</a></div></div>
<div class="ttc" id="namespace_t_g_s_1_1_server_html_ac244e362b52b9feac67ac6c2ca27f522"><div class="ttname"><a href="namespace_t_g_s_1_1_server.html#ac244e362b52b9feac67ac6c2ca27f522">TGS.Server.MessageType</a></div><div class="ttdeci">MessageType</div><div class="ttdoc">Type of chat message, these may be OR&amp;#39;d together </div><div class="ttdef"><b>Definition:</b> <a href="_message_type_8cs_source.html#l00008">MessageType.cs:8</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aa2e43abfda9bace7682d7d583ad7398a"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aa2e43abfda9bace7682d7d583ad7398a">TGS.Server.Instance.AutoUpdateTimer_Elapsed</a></div><div class="ttdeci">void AutoUpdateTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)</div><div class="ttdoc">Runs on the configured InstanceConfig.AutoUpdateInterval of Config and tries to Update(bool) and Comp...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01422">Repository.cs:1422</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a5d3fc0a44c753811f92e13d02de32c0f"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a5d3fc0a44c753811f92e13d02de32c0f">TGS.Server.Instance.GenerateGitCredentials</a></div><div class="ttdeci">Credentials GenerateGitCredentials(string url, string usernameFromUrl, SupportedCredentialTypes types)</div><div class="ttdoc">SSH credentials callback. Properly sets up SSH keys for an authorization operation ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01260">Repository.cs:1260</a></div></div>
<div class="ttc" id="class_i_disposable_html"><div class="ttname"><a href="class_i_disposable.html">IDisposable</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a8be905dbecf8c22a190e20ab990eded3"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a8be905dbecf8c22a190e20ab990eded3">TGS.Server.Instance.SynchronizePush</a></div><div class="ttdeci">string SynchronizePush()</div><div class="ttdoc">Pushes the paths listed in TGS3.json to the currentl git remote. No other commit differences may exis...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01113">Repository.cs:1113</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a6b332d573bb560960d2c55e047ca378c"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a6b332d573bb560960d2c55e047ca378c">TGS.Server.Instance.CreateBackup</a></div><div class="ttdeci">string CreateBackup()</div><div class="ttdoc">Creates a date and timestamped tag of the current HEAD </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00753">Repository.cs:753</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_a7799e81d92bdec8a357d9b3240a202ef"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#a7799e81d92bdec8a357d9b3240a202ef">TGS.Server.Instance.ListBackups</a></div><div class="ttdeci">IDictionary&lt; string, string &gt; ListBackups(out string error)</div><div class="ttdoc">Lists tags in the repository created by the Instance </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00794">Repository.cs:794</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_server_html"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_server.html">TGS.Server.Server</a></div><div class="ttdoc">The windows service the application runs as </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_server_8cs_source.html#l00018">Server.cs:18</a></div></div>
<div class="ttc" id="namespace_t_g_s_1_1_interface_1_1_components_html"><div class="ttname"><a href="namespace_t_g_s_1_1_interface_1_1_components.html">TGS.Interface.Components</a></div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_interface_2_components_2_administration_8cs_source.html#l00003">Administration.cs:3</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_aefd0e4e22081841d4169b583d29d92f0"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#aefd0e4e22081841d4169b583d29d92f0">TGS.Server.Instance.LiveSha</a></div><div class="ttdeci">string LiveSha()</div><div class="ttdoc">Gets the current staged or live commit SHA </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l01448">Repository.cs:1448</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_helpers_html_a40624df8add53e83b2ebdb7d446b70fe"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_helpers.html#a40624df8add53e83b2ebdb7d446b70fe">TGS.Server.Helpers.CopyFileForceDirectories</a></div><div class="ttdeci">static void CopyFileForceDirectories(string source, string dest, bool overwrite)</div><div class="ttdoc">Copy a file from source  to dest , but first ensure the destination directory exists ...</div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_helpers_8cs_source.html#l00021">Helpers.cs:21</a></div></div>
<div class="ttc" id="class_t_g_s_1_1_server_1_1_instance_html_acbbd8b294a54c3573371c933467f5575"><div class="ttname"><a href="class_t_g_s_1_1_server_1_1_instance.html#acbbd8b294a54c3573371c933467f5575">TGS.Server.Instance.Exists</a></div><div class="ttdeci">bool Exists()</div><div class="ttdoc">Check if the repository is valid, if not Setup(string, string) must be called  </div><div class="ttdef"><b>Definition:</b> <a href="_t_g_s_8_server_2_instance_2_repository_8cs_source.html#l00185">Repository.cs:185</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
